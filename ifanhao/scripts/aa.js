var CURRENT_YR = FISCALYEARS[0]; function ctyBounds(coords) { if (coords.length > 1) { var polyline = L.polyline(_.flatten(_.flatten(coords,true),true)); } else { var polyline = L.polyline(coords[0]); } var bbox = polyline.getBounds(); return [[bbox.getSouthWest().lng, bbox.getSouthWest().lat], [bbox.getNorthEast().lng, bbox.getNorthEast().lat]]; } $(function() { var BASE_URL = 'http://open.undp.org/', widgetOts = [], models = {}, views = {}, routers = {}, templates = _($('script[name]')).reduce(function(memo, el) { memo[el.getAttribute('name')] = _(el.innerHTML).template(); return memo; }, {}), app = {}, facets = [ { id: 'operating_unit', url: 'api/operating-unit-index.json', name: 'Country Office / Operating Unit' }, { id: 'region', url: 'api/region-index.json', name: 'Region' }, { id: 'focus_area', url: 'api/focus-area-index.json', name: 'UNDP Focus Area' }, { id: 'donor_countries', url: 'api/donor-country-index.json', name: 'Funding by Country' }, { id: 'donors', url: 'api/donor-index.json', name: 'Budget Source' } ]; var IE = $.browser.msie; if (IE) {var IE_VERSION = parseInt($.browser.version);} // should
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// 6,
																																																																																																																																																																																																																																																																																								// 7,
																																																																																																																																																																																																																																																																																								// 8, 9
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Models
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Model
																																																																																																																																																																																																																																																																																								// models.Filter
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.Model.extend({
																																																																																																																																																																																																																																																																																								// defaults:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// active:
																																																																																																																																																																																																																																																																																								// false,
																																																																																																																																																																																																																																																																																								// visible:
																																																																																																																																																																																																																																																																																								// true
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// initialize:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (this.collection.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'donors'
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// this.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// '00012')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.set({
																																																																																																																																																																																																																																																																																								// name:
																																																																																																																																																																																																																																																																																								// 'UNDP
																																																																																																																																																																																																																																																																																								// Regular
																																																																																																																																																																																																																																																																																								// Resources'
																																																																																																																																																																																																																																																																																								// }, {
																																																																																																																																																																																																																																																																																								// silent:
																																																																																																																																																																																																																																																																																								// true
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Collections
																																																																																																																																																																																																																																																																																								// models.Filters
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.Collection.extend({
																																																																																																																																																																																																																																																																																								// watch:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.update();
																																																																																																																																																																																																																																																																																								// app.projects.on('update',
																																																																																																																																																																																																																																																																																								// this.update,
																																																																																																																																																																																																																																																																																								// this);
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// update:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// collection
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this,
																																																																																																																																																																																																																																																																																								// active
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(app.app.filters).find(function(filter)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// (collection.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// filter.collection);
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// _(collection.where({active:
																																																																																																																																																																																																																																																																																								// true
																																																																																																																																																																																																																																																																																								// })).each(function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// model.set('active',
																																																																																																																																																																																																																																																																																								// false);
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (active)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// model
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.get(active.id);
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// count
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// app.projects[collection.id][model.id];
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// budget
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// app.projects[collection.id
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// 'Budget'][model.id];
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// expenditure
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// app.projects[collection.id
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// 'Expenditure'][model.id];
																																																																																																																																																																																																																																																																																								// model.set({
																																																																																																																																																																																																																																																																																								// active:
																																																																																																																																																																																																																																																																																								// true,
																																																																																																																																																																																																																																																																																								// count:
																																																																																																																																																																																																																																																																																								// count,
																																																																																																																																																																																																																																																																																								// budget:
																																																																																																																																																																																																																																																																																								// budget,
																																																																																																																																																																																																																																																																																								// expenditure:
																																																																																																																																																																																																																																																																																								// expenditure
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// collection.each(function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// count
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// app.projects[collection.id][model.id];
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// budget
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// app.projects[collection.id
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// 'Budget'][model.id];
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// expenditure
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// app.projects[collection.id
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// 'Expenditure'][model.id];
																																																																																																																																																																																																																																																																																								// model.set({
																																																																																																																																																																																																																																																																																								// count:
																																																																																																																																																																																																																																																																																								// count,
																																																																																																																																																																																																																																																																																								// budget:
																																																																																																																																																																																																																																																																																								// budget,
																																																																																																																																																																																																																																																																																								// expenditure:
																																																																																																																																																																																																																																																																																								// expenditure
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// this.trigger('update');
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// model:
																																																																																																																																																																																																																																																																																								// models.Filter,
																																																																																																																																																																																																																																																																																								// comparator:
																																																																																																																																																																																																																																																																																								// function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// -1 *
																																																																																																																																																																																																																																																																																								// model.get('count')
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// 0; }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Model
																																																																																																																																																																																																																																																																																								// models.Project
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.Model.extend({
																																																																																																																																																																																																																																																																																								// defaults:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// visible:
																																																																																																																																																																																																																																																																																								// true
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// url:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// 'api/projects/'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// this.get('id')
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '.json';
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Collection
																																																																																																																																																																																																																																																																																								// models.Projects
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.Collection.extend({
																																																																																																																																																																																																																																																																																								// initialize:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.sortData
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.sortData
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// 'budget';
																																																																																																																																																																																																																																																																																								// this.sortOrder
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.sortOrder
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// 'desc';
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// watch:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// collection
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// this.update();
																																																																																																																																																																																																																																																																																								// collection.on('reset',
																																																																																																																																																																																																																																																																																								// this.update,
																																																																																																																																																																																																																																																																																								// this);
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// update:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// collection
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this,
																																																																																																																																																																																																																																																																																								// processes
																																																																																																																																																																																																																																																																																								// = 3
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// facets.length,
																																																																																																																																																																																																																																																																																								// status
																																																																																																																																																																																																																																																																																								// = 0;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!this.length)
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// calc(that,facet,category)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// that[facet
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// category.capitalize()]
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _.reduce(that.models,
																																																																																																																																																																																																																																																																																								// function(res,obj)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (_.isArray(obj.attributes[facet]))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _.each(obj.attributes[facet],
																																																																																																																																																																																																																																																																																								// function(o)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (!(o
																																																																																																																																																																																																																																																																																								// in
																																																																																																																																																																																																																																																																																								// res))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// res[o]
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// obj.attributes[category];
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// res[o]
																																																																																																																																																																																																																																																																																								// +=
																																																																																																																																																																																																																																																																																								// obj.attributes[category];
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (!(obj.attributes[facet]
																																																																																																																																																																																																																																																																																								// in
																																																																																																																																																																																																																																																																																								// res))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// res[obj.attributes[facet]]
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// obj.attributes[category];
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// res[obj.attributes[facet]]
																																																																																																																																																																																																																																																																																								// +=
																																																																																																																																																																																																																																																																																								// obj.attributes[category];
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// res;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// {});
																																																																																																																																																																																																																																																																																								// } //
																																																																																																																																																																																																																																																																																								// Count
																																																																																																																																																																																																																																																																																								// projects
																																																																																																																																																																																																																																																																																								// for
																																																																																																																																																																																																																																																																																								// each
																																																																																																																																																																																																																																																																																								// facet
																																																																																																																																																																																																																																																																																								// _(facets).each(function(facet)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// setTimeout(function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// subStatus
																																																																																																																																																																																																																																																																																								// = 0,
																																																																																																																																																																																																																																																																																								// subProcesses
																																																																																																																																																																																																																																																																																								// = 1;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (facet.id
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'donor_countries')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// collection[facet.id]
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(collection.pluck(facet.id))
																																																																																																																																																																																																																																																																																								// .chain()
																																																																																																																																																																																																																																																																																								// .map(function(v)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// _(v.sort()).uniq(true);
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// .flatten()
																																																																																																																																																																																																																																																																																								// .countBy(function(n)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// n;
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// .value();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// collection[facet.id]
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(collection.pluck(facet.id))
																																																																																																																																																																																																																																																																																								// .chain()
																																																																																																																																																																																																																																																																																								// .flatten()
																																																																																																																																																																																																																																																																																								// .countBy(function(n)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// n;
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// .value();
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (facet.id
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'operating_unit')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// collection[facet.id
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// 'Sources']
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(collection.models).chain()
																																																																																																																																																																																																																																																																																								// .groupBy(function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// model.get(facet.id);
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// .reduce(function(memo,
																																																																																																																																																																																																																																																																																								// models,
																																																																																																																																																																																																																																																																																								// unit)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// memo[unit]
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(models).chain().pluck('attributes').pluck('donors').flatten().uniq().size().value();
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// memo;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// {}).value();
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// setTimeout(function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// calc(collection,facet.id,'budget');
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (subStatus
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// subProcesses)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// subCallback();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// subStatus++;
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// setTimeout(function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// calc(collection,facet.id,'expenditure');
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (subStatus
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// subProcesses)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// subCallback();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// subStatus++;
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// subCallback()
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (status
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// processes)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// callback();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// status++;
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// collection);
																																																																																																																																																																																																																																																																																								// setTimeout(function()
																																																																																																																																																																																																																																																																																								// { //
																																																																																																																																																																																																																																																																																								// Total
																																																																																																																																																																																																																																																																																								// budget
																																																																																																																																																																																																																																																																																								// collection.budget
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// collection.reduce(function(memo,
																																																																																																																																																																																																																																																																																								// project)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// memo
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// parseFloat(project.get('budget'));
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (status
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// processes)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// callback();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// status++;
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// setTimeout(function()
																																																																																																																																																																																																																																																																																								// { //
																																																																																																																																																																																																																																																																																								// Donor
																																																																																																																																																																																																																																																																																								// budgets
																																																																																																																																																																																																																																																																																								// collection.donorBudget
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// collection.reduce(function(memo,
																																																																																																																																																																																																																																																																																								// project)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _(project.get('donors')).each(function(donor,
																																																																																																																																																																																																																																																																																								// i) {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// budget
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// project.get('donor_budget')[i]
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// 0;
																																																																																																																																																																																																																																																																																								// memo[donor]
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// memo[donor]
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// budget
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// budget;
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// memo;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// {});
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (status
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// processes)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// callback();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// status++;
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// setTimeout(function()
																																																																																																																																																																																																																																																																																								// { //
																																																																																																																																																																																																																																																																																								// Total
																																																																																																																																																																																																																																																																																								// expenditure
																																																																																																																																																																																																																																																																																								// collection.expenditure
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// collection.reduce(function(memo,
																																																																																																																																																																																																																																																																																								// project)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// memo
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// parseFloat(project.get('expenditure'));
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (status
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// processes)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// callback();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// status++;
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// setTimeout(function()
																																																																																																																																																																																																																																																																																								// { //
																																																																																																																																																																																																																																																																																								// Donor
																																																																																																																																																																																																																																																																																								// expenditure
																																																																																																																																																																																																																																																																																								// collection.donorExpenditure
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// collection.reduce(function(memo,
																																																																																																																																																																																																																																																																																								// project)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _(project.get('donors')).each(function(donor,
																																																																																																																																																																																																																																																																																								// i) {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// budget
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// project.get('donor_expend')[i]
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// 0;
																																																																																																																																																																																																																																																																																								// memo[donor]
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// memo[donor]
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// budget
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// budget;
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// memo;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// {});
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (status
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// processes)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// callback();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// status++;
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// callback()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// collection.trigger('update');
																																																																																																																																																																																																																																																																																								// _(collection.cb).bind(collection)();
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// model:
																																																																																																																																																																																																																																																																																								// models.Project,
																																																																																																																																																																																																																																																																																								// comparator:
																																																																																																																																																																																																																																																																																								// function(model)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (this.sortOrder
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'desc')
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (this.sortData
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'name')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// -model.get(this.sortData).toLowerCase().charCodeAt(0);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// -model.get(this.sortData);
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// model.get(this.sortData);
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Models
																																																																																																																																																																																																																																																																																								// models.TopDonor
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.Model.extend({
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Collections
																																																																																																																																																																																																																																																																																								// models.TopDonors
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.Collection.extend({
																																																																																																																																																																																																																																																																																								// initialize:
																																																																																																																																																																																																																																																																																								// function(options)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.type
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// options.type;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// model:
																																																																																																																																																																																																																																																																																								// models.TopDonor,
																																																																																																																																																																																																																																																																																								// comparator:
																																																																																																																																																																																																																																																																																								// function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// -1 *
																																																																																																																																																																																																																																																																																								// model.get(this.type);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Model
																																																																																																																																																																																																																																																																																								// models.Subnational
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.Model.extend({
																																																																																																																																																																																																																																																																																								// defaults:
																																																																																																																																																																																																																																																																																								// {visible:false},
																																																																																																																																																																																																																																																																																								// initialize:function(){
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// can
																																																																																																																																																																																																																																																																																								// this
																																																																																																																																																																																																																																																																																								// happen
																																																																																																																																																																																																																																																																																								// on a
																																																																																																																																																																																																																																																																																								// collection
																																																																																																																																																																																																																																																																																								// level?
																																																																																																																																																																																																																																																																																								// model
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// sub
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// model.get('subnational');
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (sub.length
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 0 )
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// model.geojson
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// null;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// geojson
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// [];
																																																																																																																																																																																																																																																																																								// _(sub).each(function(data){
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// feature
																																																																																																																																																																																																																																																																																								// = {
																																																																																																																																																																																																																																																																																								// "type":"Feature",
																																																																																																																																																																																																																																																																																								// "properties":{
																																																																																																																																																																																																																																																																																								// project:model.get('id'),
																																																																																																																																																																																																																																																																																								// title:model.get('title'),
																																																																																																																																																																																																																																																																																								// precision:
																																																																																																																																																																																																																																																																																								// data.precision,
																																																																																																																																																																																																																																																																																								// scope:
																																																																																																																																																																																																																																																																																								// data.scope,
																																																																																																																																																																																																																																																																																								// type:
																																																																																																																																																																																																																																																																																								// data.type
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// "geometry":
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// "type":
																																																																																																																																																																																																																																																																																								// "Point",
																																																																																																																																																																																																																																																																																								// "coordinates":
																																																																																																																																																																																																																																																																																								// [parseFloat(data.lon),parseFloat(data.lat)]
																																																																																																																																																																																																																																																																																								// } };
																																																																																																																																																																																																																																																																																								// geojson.push(feature);
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// model.geojson
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// geojson;
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Collection
																																																																																																																																																																																																																																																																																								// models.Subnationals
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.Collection.extend({
																																																																																																																																																																																																																																																																																								// model:
																																																																																																																																																																																																																																																																																								// models.Subnational,
																																																																																																																																																																																																																																																																																								// parse:
																																																																																																																																																																																																																																																																																								// function(response){
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// response.projects
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// filtered:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// visible
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.filter(function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// model.get("visible")
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// true;
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// models.Subnationals(visible);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// models.National
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.Model.extend({
																																																																																																																																																																																																																																																																																								// initialize:function(){
																																																																																																																																																																																																																																																																																								// this.lon
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.get('lon'),
																																																																																																																																																																																																																																																																																								// this.lat
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.get('lat');
																																																																																																																																																																																																																																																																																								// this.centroid
																																																																																																																																																																																																																																																																																								// = {
																																																																																																																																																																																																																																																																																								// "type":"Feature",
																																																																																																																																																																																																																																																																																								// "properties":{
																																																																																																																																																																																																																																																																																								// "id":this.get('id'),
																																																																																																																																																																																																																																																																																								// "title":this.get('name')
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// "geometry":{
																																																																																																																																																																																																																																																																																								// "type":"Point",
																																																																																																																																																																																																																																																																																								// "coordinates":[parseFloat(this.lon),parseFloat(this.lat)]
																																																																																																																																																																																																																																																																																								// } };
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Collection
																																																																																																																																																																																																																																																																																								// models.Nationals
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.Collection.extend({
																																																																																																																																																																																																																																																																																								// model:
																																																																																																																																																																																																																																																																																								// models.National
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Views
																																																																																																																																																																																																																																																																																								// views.App
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.View.extend({
																																																																																																																																																																																																																																																																																								// events:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// a.filter':
																																																																																																																																																																																																																																																																																								// 'setFilter',
																																																																																																																																																																																																																																																																																								// 'keyup
																																																																																																																																																																																																																																																																																								// #filters-search':
																																																																																																																																																																																																																																																																																								// 'searchFilter',
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// #filters
																																																																																																																																																																																																																																																																																								// .label':
																																																																																																																																																																																																																																																																																								// 'toggleFilter',
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// #filters
																																																																																																																																																																																																																																																																																								// .reset':
																																																																																																																																																																																																																																																																																								// 'clearFilter',
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// #projects-tab
																																																																																																																																																																																																																																																																																								// .reset':
																																																																																																																																																																																																																																																																																								// 'clearSearch',
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// .map-btn':
																																																																																																																																																																																																																																																																																								// 'mapLayerswitch',
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// .widget-config':
																																																																																																																																																																																																																																																																																								// 'requestIframe',
																																																																																																																																																																																																																																																																																								// 'submit
																																																																																																																																																																																																																																																																																								// .form-search':
																																																																																																																																																																																																																																																																																								// 'submitForm',
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// #yearselect
																																																																																																																																																																																																																																																																																								// .dropdown-menu
																																																																																																																																																																																																																																																																																								// a':
																																																																																																																																																																																																																																																																																								// 'yearChange',
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// .map-filter':'mapFilter',
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// .nav.nav-tabs
																																																																																																																																																																																																																																																																																								// a':
																																																																																																																																																																																																																																																																																								// 'activeMap'
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// initialize:
																																																																																																																																																																																																																																																																																								// function(options)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// view
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Toggle
																																																																																																																																																																																																																																																																																								// country
																																																																																																																																																																																																																																																																																								// selector
																																																																																																																																																																																																																																																																																								// $(window).on('click',
																																																																																																																																																																																																																																																																																								// '#country-selector',
																																																																																																																																																																																																																																																																																								// _(this.showCountries).bind(this));
																																																																																																																																																																																																																																																																																								// $(window).on('click',
																																																																																																																																																																																																																																																																																								// '#country-list
																																																																																																																																																																																																																																																																																								// .close',
																																																																																																																																																																																																																																																																																								// _(this.hideCountries).bind(this));
																																																																																																																																																																																																																																																																																								// this.render();
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!this.options.embed)
																																																																																																																																																																																																																																																																																								// { //
																																																																																																																																																																																																																																																																																								// Filters
																																																																																																																																																																																																																																																																																								// follow
																																																																																																																																																																																																																																																																																								// scrolling
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// top
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $('#siderail').offset().top
																																																																																																																																																																																																																																																																																								// -
																																																																																																																																																																																																																																																																																								// 12;
																																																																																																																																																																																																																																																																																								// $(window).on('scroll',
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// () {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// y =
																																																																																																																																																																																																																																																																																								// $(this).scrollTop();
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (y
																																																																																																																																																																																																																																																																																								// >=
																																																																																																																																																																																																																																																																																								// top)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#siderail').addClass('fixed');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#siderail').removeClass('fixed');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// render:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (this.options.embed)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.$el.empty().append(templates.embedProjects());
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Depending
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// options
																																																																																																																																																																																																																																																																																								// passed
																																																																																																																																																																																																																																																																																								// into
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// array
																																																																																																																																																																																																																																																																																								// add
																																																																																																																																																																																																																																																																																								// a
																																																																																																																																																																																																																																																																																								// fade
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// in
																																																																																																																																																																																																																																																																																								// class
																																																																																																																																																																																																																																																																																								// to
																																																																																																																																																																																																																																																																																								// all
																																																																																																																																																																																																																																																																																								// elements
																																																																																																																																																																																																																																																																																								// containing
																																																																																																																																																																																																																																																																																								// a
																																																																																																																																																																																																																																																																																								// data-iotion
																																																																																																																																																																																																																																																																																								// attribute
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (this.options.embed)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _(this.options.embed).each(function
																																																																																																																																																																																																																																																																																								// (o)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('[data-option="'
																																																																																																																																																																																																																																																																																								// + o
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '"]').show();
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.$el.empty().append(templates.app({
																																																																																																																																																																																																																																																																																								// base:
																																																																																																																																																																																																																																																																																								// BASE_URL,
																																																																																																																																																																																																																																																																																								// year:
																																																																																																																																																																																																																																																																																								// this.options.year
																																																																																																																																																																																																																																																																																								// }));
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// setFilter:
																																																																																																																																																																																																																																																																																								// function(e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// $target
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $(e.target),
																																																																																																																																																																																																																																																																																								// path
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '',
																																																																																																																																																																																																																																																																																								// parts
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// ($target.attr('id'))
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// $target.attr('id').split('-')
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// '',
																																																																																																																																																																																																																																																																																								// filters
																																																																																																																																																																																																																																																																																								// = [{
																																																																																																																																																																																																																																																																																								// collection:
																																																																																																																																																																																																																																																																																								// parts[0],
																																																																																																																																																																																																																																																																																								// id:
																																																																																																																																																																																																																																																																																								// parts[1]
																																																																																																																																																																																																																																																																																								// }],
																																																																																																																																																																																																																																																																																								// year
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// app.fiscalYear;
																																																																																																																																																																																																																																																																																								// shift
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// this.clearFilter(e);
																																																																																																																																																																																																																																																																																								// _(this.filters).each(function(filter)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (_.isEqual(filter,
																																																																																																																																																																																																																																																																																								// filters[0]))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// shift
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// true;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (filter.collection
																																																																																																																																																																																																																																																																																								// !==
																																																																																																																																																																																																																																																																																								// filters[0].collection)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// filters.push(filter);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (shift)
																																																																																																																																																																																																																																																																																								// filters.shift();
																																																																																																																																																																																																																																																																																								// filters
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(filters).chain()
																																																																																																																																																																																																																																																																																								// .compact()
																																																																																																																																																																																																																																																																																								// .map(function(filter)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// filter.collection
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// filter.id;
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// .value().join('/');
																																																																																																																																																																																																																																																																																								// path
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (filters.length)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// year
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '/filter/'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// filters
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// year;
																																																																																																																																																																																																																																																																																								// e.preventDefault();
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Close
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// state
																																																																																																																																																																																																																																																																																								// of
																																																																																																																																																																																																																																																																																								// menu
																																																																																																																																																																																																																																																																																								// items
																																																																																																																																																																																																																																																																																								// before
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// we
																																																																																																																																																																																																																																																																																								// navigate
																																																																																																																																																																																																																																																																																								// and
																																																																																																																																																																																																																																																																																								// set
																																																																																																																																																																																																																																																																																								// things
																																																																																																																																																																																																																																																																																								// up
																																																																																																																																																																																																																																																																																								// again.
																																																																																																																																																																																																																																																																																								// $('.topics').toggleClass('active',
																																																																																																																																																																																																																																																																																								// false);
																																																																																																																																																																																																																																																																																								// $('.topics
																																																																																																																																																																																																																																																																																								// a').toggleClass('active',
																																																																																																																																																																																																																																																																																								// false);
																																																																																																																																																																																																																																																																																								// $('.topics').toggleClass('filtered',
																																																																																																																																																																																																																																																																																								// false);
																																																																																																																																																																																																																																																																																								// $('#all-projects').attr('href',
																																																																																																																																																																																																																																																																																								// '#'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// path);
																																																																																																																																																																																																																																																																																								// app.navigate(path,
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// trigger:
																																																																																																																																																																																																																																																																																								// true
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// searchFilter:
																																																																																																																																																																																																																																																																																								// function(e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// $target
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $(e.target),
																																																																																																																																																																																																																																																																																								// val
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $target.val().toLowerCase();
																																																																																																																																																																																																																																																																																								// $target.parent().find('.reset').toggleClass('hidden',
																																																																																																																																																																																																																																																																																								// (val
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// ''));
																																																																																																																																																																																																																																																																																								// _(this.views).each(function(view)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.collection.each(function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// name
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// model.get('name').toLowerCase();
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (val
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// ''
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// name.indexOf(val)
																																																																																																																																																																																																																																																																																								// >=
																																																																																																																																																																																																																																																																																								// 0) {
																																																																																																																																																																																																																																																																																								// model.set('visible',
																																																																																																																																																																																																																																																																																								// true);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// model.set('visible',
																																																																																																																																																																																																																																																																																								// false);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// view.render(true);
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Open
																																																																																																																																																																																																																																																																																								// all
																																																																																																																																																																																																																																																																																								// filter
																																																																																																																																																																																																																																																																																								// facets
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// search
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (val
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// '')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.topics').toggleClass('active',
																																																																																																																																																																																																																																																																																								// false);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.topics').toggleClass('active',
																																																																																																																																																																																																																																																																																								// true);
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// clearFilter:
																																																																																																																																																																																																																																																																																								// function(e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// e.preventDefault();
																																																																																																																																																																																																																																																																																								// $(e.target).parent().find('input').val('');
																																																																																																																																																																																																																																																																																								// this.searchFilter(e);
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// toggleFilter:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// $target
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $(e.target),
																																																																																																																																																																																																																																																																																								// cat
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $target.attr('data-category'),
																																																																																																																																																																																																																																																																																								// $parent
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $('#'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// cat);
																																																																																																																																																																																																																																																																																								// e.preventDefault();
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Bail
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// this
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// user
																																																																																																																																																																																																																																																																																								// has
																																																																																																																																																																																																																																																																																								// selected
																																																																																																																																																																																																																																																																																								// // a
																																																																																																																																																																																																																																																																																								// label
																																																																																																																																																																																																																																																																																								// that
																																																																																																																																																																																																																																																																																								// has
																																																																																																																																																																																																																																																																																								// an
																																																																																																																																																																																																																																																																																								// active
																																																																																																																																																																																																																																																																																								// filtered
																																																																																																																																																																																																																																																																																								// selection.
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// ($parent.hasClass('filtered'))
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// ($parent.hasClass('active'))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $parent.toggleClass('active',
																																																																																																																																																																																																																																																																																								// false);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (this.views[cat])
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.views[cat].active
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.topics').each(function
																																																																																																																																																																																																																																																																																								// () {
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Loop
																																																																																																																																																																																																																																																																																								// through
																																																																																																																																																																																																																																																																																								// all
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// filtered
																																																																																																																																																																																																																																																																																								// menus
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// to
																																																																																																																																																																																																																																																																																								// close
																																																																																																																																																																																																																																																																																								// active
																																																																																																																																																																																																																																																																																								// menus
																																																																																																																																																																																																																																																																																								// providing
																																																																																																																																																																																																																																																																																								// they
																																																																																																																																																																																																																																																																																								// don't
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// have
																																																																																																																																																																																																																																																																																								// an
																																																																																																																																																																																																																																																																																								// active
																																																																																																																																																																																																																																																																																								// filtered
																																																																																																																																																																																																																																																																																								// selection.
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!$(this).hasClass('filtered'))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $(this).toggleClass('active',
																																																																																																																																																																																																																																																																																								// false);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// $parent.toggleClass('active',
																																																																																																																																																																																																																																																																																								// true);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (this.views[cat])
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.views[cat].active
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// true;
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// mapLayerswitch:
																																																																																																																																																																																																																																																																																								// function(e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// e.preventDefault();
																																																																																																																																																																																																																																																																																								// $('#chart-hdi').css('display','none');
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// $target
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $(e.currentTarget);
																																																																																																																																																																																																																																																																																								// $('.map-btn').removeClass('active');
																																																																																																																																																																																																																																																																																								// this.layer
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $target.attr('data-value')
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// 'budget';
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// When
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// operating
																																																																																																																																																																																																																																																																																								// unit,
																																																																																																																																																																																																																																																																																								// turn
																																																																																																																																																																																																																																																																																								// on/off
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// HDI
																																																																																																																																																																																																																																																																																								// graph
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// ($('ul.layers
																																																																																																																																																																																																																																																																																								// li').hasClass('no-hover')){
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// ($target.attr('data-value')
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'hdi'
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// app.hdi)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// ($('li.hdi').hasClass('active'))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('li.hdi').removeClass('active')
																																																																																																																																																																																																																																																																																								// $($target).removeClass('active');
																																																																																																																																																																																																																																																																																								// $('#chart-hdi').css('display','none');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#chart-hdi').css('display','block');
																																																																																																																																																																																																																																																																																								// $($target).addClass('active');
																																																																																																																																																																																																																																																																																								// $('li.hdi').addClass('active');
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $target.addClass('active');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// app.projects.map.buildLayer(this.layer);
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// see
																																																																																																																																																																																																																																																																																								// Map.js
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// requestIframe:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// context
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $('#widget');
																																																																																																																																																																																																																																																																																								// widgetOpts
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// ["title",
																																																																																																																																																																																																																																																																																								// "map",
																																																																																																																																																																																																																																																																																								// "projects"];
																																																																																																																																																																																																																																																																																								// //default
																																																																																																																																																																																																																																																																																								// layers
																																																																																																																																																																																																																																																																																								// for
																																																																																																																																																																																																																																																																																								// main
																																																																																																																																																																																																																																																																																								// map
																																																																																																																																																																																																																																																																																								// $('.widget-options
																																																																																																																																																																																																																																																																																								// a',context).removeClass('active');
																																																																																																																																																																																																																																																																																								// _(widgetOpts).each(function(widgetTitle){
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// widgetEl
																																																																																																																																																																																																																																																																																								// =widgetTitle
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '-opt';
																																																																																																																																																																																																																																																																																								// $("."
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// widgetEl).find('a').addClass('active');
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (location.hash.split('/').length
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 1) {
																																																																																																																																																																																																																																																																																								// embedPath
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// location.hash
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '/widget/';
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// embedPath
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// location.hash
																																																																																																																																																																																																																																																																																								// .replace('filter',
																																																																																																																																																																																																																																																																																								// 'widget')
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// defaultIframe
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '<iframe
																																																																																																																																																																																																																																																																																								// src="/undp-projects/embed.html'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// embedPath
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '?'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// widgetOpts.join('&')
																																																																																																																																																																																																																																																																																								// + '"
																																																																																																																																																																																																																																																																																								// width="680"
																																																																																																																																																																																																																																																																																								// height="500"
																																																																																																																																																																																																																																																																																								// frameborder="0">
																																																																																																																																																																																																																																																																																								// </iframe>';
																																																																																																																																																																																																																																																																																								// $('.widget-preview',
																																																																																																																																																																																																																																																																																								// context).html(defaultIframe);
																																																																																																																																																																																																																																																																																								// $('.widget-code',
																																																																																																																																																																																																																																																																																								// context)
																																																																																																																																																																																																																																																																																								// .val(defaultIframe)
																																																																																																																																																																																																																																																																																								// .select();
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// submitForm:
																																																																																																																																																																																																																																																																																								// function(e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// showCountries:
																																																																																																																																																																																																																																																																																								// function(e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// e.preventDefault();
																																																																																																																																																																																																																																																																																								// $('#country-list').css('display',
																																																																																																																																																																																																																																																																																								// 'block');
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// hideCountries:
																																																																																																																																																																																																																																																																																								// function(e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// e.preventDefault();
																																																																																																																																																																																																																																																																																								// $('#country-list').css('display',
																																																																																																																																																																																																																																																																																								// 'none');
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// yearChange:
																																																																																																																																																																																																																																																																																								// function(e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// e.preventDefault();
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// year
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $(e.target).attr('data-value');
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (year
																																																																																																																																																																																																																																																																																								// !=
																																																																																																																																																																																																																																																																																								// app.fiscalYear)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// filters
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(this.filters).chain()
																																																																																																																																																																																																																																																																																								// .compact()
																																																																																																																																																																																																																																																																																								// .map(function(filter)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// filter.collection
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// filter.id;
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// .value().join('/');
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// path
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (filters.length)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// year
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '/filter/'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// filters
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// year;
																																																																																																																																																																																																																																																																																								// app.navigate(path,
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// trigger:
																																																																																																																																																																																																																																																																																								// true
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// updateYear:
																																																																																																																																																																																																																																																																																								// function(year)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#total-budget').next('span').html(year
																																																																																																																																																																																																																																																																																								// + '
																																																																																																																																																																																																																																																																																								// Budget');
																																																																																																																																																																																																																																																																																								// $('#total-expenditure').next('span').html(year
																																																																																																																																																																																																																																																																																								// + '
																																																																																																																																																																																																																																																																																								// Expenditure');
																																																																																																																																																																																																																																																																																								// $('#yearselect
																																																																																																																																																																																																																																																																																								// .dropdown-toggle').html(year
																																																																																																																																																																																																																																																																																								// + '
																																																																																																																																																																																																																																																																																								// <b
																																																																																																																																																																																																																																																																																								// class="caret"></b>');
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// mapFilter:
																																																																																																																																																																																																																																																																																								// function(e){
																																																																																																																																																																																																																																																																																								// e.preventDefault();
																																																																																																																																																																																																																																																																																								// $target
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// e.target;
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// subFilter
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $target.id.split('-'),
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// ['type','1']
																																																																																																																																																																																																																																																																																								// subFilterValue
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// subFilter[subFilter.length-1]
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// "";
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// anchor
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $('#'+$target.id);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// ($('.map-filter').hasClass('active')){
																																																																																																																																																																																																																																																																																								// $('.map-filter').removeClass('active');
																																																																																																																																																																																																																																																																																								// anchor.addClass('active');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// currentCenter
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// app.projects.map.map.getCenter(),
																																																																																																																																																																																																																																																																																								// currentZoom
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// app.projects.map.map.getZoom();
																																																																																																																																																																																																																																																																																								// app.projects.map.buildLayer(this.layer,subFilterValue,currentCenter,currentZoom);
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// see
																																																																																																																																																																																																																																																																																								// Map.js
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// activeMap:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// setTimeout(function(){app.projects.map.map.invalidateSize({pan:true});},
																																																																																																																																																																																																																																																																																								// 200);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// views.Filters
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.View.extend({
																																																																																																																																																																																																																																																																																								// initialize:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// () {
																																																																																																																																																																																																																																																																																								// this.collection.on('update',
																																																																																																																																																																																																																																																																																								// this.render,
																																																																																																																																																																																																																																																																																								// this);
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// render:
																																																																																																																																																																																																																																																																																								// function(keypress)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// view
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// setTimeout(function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// filterModels
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// [],
																																																																																																																																																																																																																																																																																								// chartModels
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// [],
																																																																																																																																																																																																																																																																																								// active
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// view.collection.where({
																																																																																																																																																																																																																																																																																								// active:
																																																																																																																																																																																																																																																																																								// true
																																																																																																																																																																																																																																																																																								// }),
																																																																																																																																																																																																																																																																																								// chartType
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 'budget',
																																																																																																																																																																																																																																																																																								// chartTypeExp
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 'expenditure',
																																																																																																																																																																																																																																																																																								// donor
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '';
																																																																																																																																																																																																																																																																																								// $('#'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// view.collection.id).toggleClass('filtered',
																																																																																																																																																																																																																																																																																								// false);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (active.length)
																																																																																																																																																																																																																																																																																								// { //
																																																																																																																																																																																																																																																																																								// Use
																																																																																																																																																																																																																																																																																								// donor
																																																																																																																																																																																																																																																																																								// level
																																																																																																																																																																																																																																																																																								// financial
																																																																																																																																																																																																																																																																																								// data
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// available
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (active[0].collection.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'donors')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// donor
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// active[0].id;
																																																																																																																																																																																																																																																																																								// app.projects.map.collection.donorID
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// donor;
																																																																																																																																																																																																																																																																																								// } //
																																																																																																																																																																																																																																																																																								// Add
																																																																																																																																																																																																																																																																																								// a
																																																																																																																																																																																																																																																																																								// filtered
																																																																																																																																																																																																																																																																																								// class
																																																																																																																																																																																																																																																																																								// to
																																																																																																																																																																																																																																																																																								// all
																																																																																																																																																																																																																																																																																								// parent
																																																																																																																																																																																																																																																																																								// containers
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// where
																																																																																																																																																																																																																																																																																								// an
																																																																																																																																																																																																																																																																																								// active
																																																																																																																																																																																																																																																																																								// element
																																																																																																																																																																																																																																																																																								// has
																																																																																																																																																																																																																																																																																								// been
																																																																																																																																																																																																																																																																																								// selected.
																																																																																																																																																																																																																																																																																								// _(active).each(function(a)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// a.collection.id).toggleClass('filtered',
																																																																																																																																																																																																																																																																																								// true);
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// filterModels
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// active;
																																																																																																																																																																																																																																																																																								// chartModels
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// active;
																																																																																																																																																																																																																																																																																								// filterCallback();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.collection.sort();
																																																																																																																																																																																																																																																																																								// setTimeout(function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// filterModels
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// view.collection.chain().filter(function(model)
																																																																																																																																																																																																																																																																																								// { //
																																																																																																																																																																																																																																																																																								// Filter
																																																																																																																																																																																																																																																																																								// donors
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// active
																																																																																																																																																																																																																																																																																								// donor
																																																																																																																																																																																																																																																																																								// country
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (view.collection.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'donors')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// donorCountry
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(app.app.filters).where({
																																																																																																																																																																																																																																																																																								// collection:
																																																																																																																																																																																																																																																																																								// 'donor_countries'
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// donorCountry
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (donorCountry.length)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// donorCountry[0].id
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// donorCountryFilter
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (donorCountry)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// (model.get('country')
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// donorCountry)
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// true;
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// (model.get('visible')
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// model.get('count')
																																																																																																																																																																																																																																																																																								// > 0
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// donorCountryFilter);
																																																																																																																																																																																																																																																																																								// }).value();
																																																																																																																																																																																																																																																																																								// filterCallback();
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// chartModels
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// view.collection.chain()
																																																																																																																																																																																																																																																																																								// .sortBy(function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// -1 *
																																																																																																																																																																																																																																																																																								// model.get(chartType)
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// 0;
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// .filter(function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// (model.get(chartType)
																																																																																																																																																																																																																																																																																								// >
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// .first(20).value();
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Top
																																																																																																																																																																																																																																																																																								// 20
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (view.collection.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'operating_unit')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#applied-filters').addClass('no-country');
																																																																																																																																																																																																																																																																																								// } if
																																																																																																																																																																																																																																																																																								// (view.collection.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'region')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#applied-filters').addClass('no-region');
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// filterCallback()
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (filterModels.length)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.$el.html(templates.filters(view));
																																																																																																																																																																																																																																																																																								// app.description
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// app.description
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// [];
																																																																																																																																																																																																																																																																																								// app.donorDescription
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// app.donorDescription
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// [];
																																																																																																																																																																																																																																																																																								// _(filterModels).each(function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.$('.filter-items').append(templates.filter({
																																																																																																																																																																																																																																																																																								// model:
																																																																																																																																																																																																																																																																																								// model
																																																																																																																																																																																																																																																																																								// }));
																																																																																																																																																																																																																																																																																								// $('#'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// view.collection.id
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// model.id).toggleClass('active',
																																																																																																																																																																																																																																																																																								// model.get('active'));
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (model.get('active')
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// !keypress)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#breadcrumbs
																																																																																																																																																																																																																																																																																								// ul').append(
																																																																																																																																																																																																																																																																																								// '<li><a
																																																																																																																																																																																																																																																																																								// href="/undp-projects/'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// document.location.hash.split('/')[0]
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '/filter/'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// view.collection.id
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// model.get('id')
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// model.get('name').toLowerCase().toTitleCase()
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</a></li>'
																																																																																																																																																																																																																																																																																								// );
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (view.collection.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'operating_unit')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// app.description.push('
																																																																																																																																																																																																																																																																																								// for
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// <strong>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// model.get('name').toLowerCase().toTitleCase()
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</strong>
																																																																																																																																																																																																																																																																																								// office');
																																																																																																																																																																																																																																																																																								// } if
																																																																																																																																																																																																																																																																																								// (view.collection.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'region')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// app.description.push('
																																																																																																																																																																																																																																																																																								// in
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// <strong>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// model.get('name').toLowerCase().toTitleCase()
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</strong>
																																																																																																																																																																																																																																																																																								// region');
																																																																																																																																																																																																																																																																																								// } if
																																																																																																																																																																																																																																																																																								// (view.collection.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'donor_countries')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// mId
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// model.id;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (mId
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'MULTI_AGY')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// app.donorDescription
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '<strong>Multi-Lateral
																																																																																																																																																																																																																																																																																								// Agencies</strong>
																																																																																																																																																																																																																																																																																								// fund
																																																																																																																																																																																																																																																																																								// <strong>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// app.projects.length
																																																																																																																																																																																																																																																																																								// +'</strong>
																																																																																																																																																																																																																																																																																								// '; }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (mId
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'OTH')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// app.donorDescription
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '<strong>Uncategorized
																																																																																																																																																																																																																																																																																								// Organizations</strong>
																																																																																																																																																																																																																																																																																								// fund
																																																																																																																																																																																																																																																																																								// <strong>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// app.projects.length
																																																																																																																																																																																																																																																																																								// +'</strong>
																																																																																																																																																																																																																																																																																								// '; }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// app.donorDescription
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '<strong>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// model.get('name').toLowerCase().toTitleCase()
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</strong>
																																																																																																																																																																																																																																																																																								// funds
																																																																																																																																																																																																																																																																																								// <strong>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// app.projects.length
																																																																																																																																																																																																																																																																																								// +'</strong>
																																																																																																																																																																																																																																																																																								// '; }
																																																																																																																																																																																																																																																																																								// } if
																																																																																																																																																																																																																																																																																								// (view.collection.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'donors')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// app.description.push('
																																																																																																																																																																																																																																																																																								// through
																																																																																																																																																																																																																																																																																								// <strong>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// model.get('name').toLowerCase().toTitleCase()
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</strong>');
																																																																																																																																																																																																																																																																																								// } if
																																																																																																																																																																																																																																																																																								// (view.collection.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'focus_area')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// app.description.push('
																																																																																																																																																																																																																																																																																								// with
																																																																																																																																																																																																																																																																																								// a
																																																																																																																																																																																																																																																																																								// focus
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// <strong>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// model.get('name').toLowerCase().toTitleCase()
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</strong>');
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.$el.empty();
																																																																																																																																																																																																																																																																																								// } if
																																																																																																																																																																																																																																																																																								// (app.filtercounter
																																																																																																																																																																																																																																																																																								// !==
																																																																																																																																																																																																																																																																																								// facets.length
																																																																																																																																																																																																																																																																																								// ) {
																																																																																																																																																																																																																																																																																								// app.filtercounter
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (app.filtercounter)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// app.filtercounter
																																																																																																																																																																																																																																																																																								// + 1
																																																																																																																																																																																																																																																																																								// : 2;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// app.filtercounter
																																																																																																																																																																																																																																																																																								// = 0;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!keypress)
																																																																																																																																																																																																																																																																																								// app.projects.map.render();
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// $('#chart-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// view.collection.id
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '.rows').empty();
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// update
																																																																																																																																																																																																																																																																																								// hash
																																																																																																																																																																																																																																																																																								// for
																																																																																																																																																																																																																																																																																								// charts
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (app.app.filters.length
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 0 ){
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// pathTo
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '#filter/';
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// pathTo
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// document.location.hash
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// "/";
																																																																																																																																																																																																																																																																																								// };
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (chartModels.length
																																																																																																																																																																																																																																																																																								// <= 1
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// view.collection.id
																																																																																																																																																																																																																																																																																								// !==
																																																																																																																																																																																																																																																																																								// 'focus_area')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#chart-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// view.collection.id)
																																																																																																																																																																																																																																																																																								// .css('display','none');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// ($('.stat-chart').hasClass('full'))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.stat-chart').removeClass('full');
																																																																																																																																																																																																																																																																																								// $('#chart-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// view.collection.id)
																																																																																																																																																																																																																																																																																								// .css('display','block');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#chart-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// view.collection.id)
																																																																																																																																																																																																																																																																																								// .addClass('full')
																																																																																																																																																																																																																																																																																								// .css('display','block');
																																																																																																																																																																																																																																																																																								// } if
																																																																																																																																																																																																																																																																																								// (view.collection.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'focus_area')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// $el
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $('#chart-focus_area');
																																																																																																																																																																																																																																																																																								// $el.empty();
																																																																																																																																																																																																																																																																																								// chartModels
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// view.collection.models;
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// total
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(chartModels).reduce(function(memo,
																																																																																																																																																																																																																																																																																								// model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// memo
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// (model.get('budget')
																																																																																																																																																																																																																																																																																								// || 0
																																																																																																																																																																																																																																																																																								// );
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0)
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// 0;
																																																																																																																																																																																																																																																																																								// _(chartModels).each(function(model,
																																																																																																																																																																																																																																																																																								// i) {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// focusIconClass
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// model.get('name').replace(/\s+/g,
																																																																																																																																																																																																																																																																																								// '-').toLowerCase().split('-')[0];
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// focusName
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// model.get('name').toLowerCase().toTitleCase();
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// value
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(((model.get('budget')
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// 0) /
																																																																																																																																																																																																																																																																																								// total)).isNaN()
																																																																																																																																																																																																																																																																																								// ? 0
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// ((model.get('budget')
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// 0) /
																																																																																																																																																																																																																																																																																								// total
																																																																																																																																																																																																																																																																																								// *
																																																																																																																																																																																																																																																																																								// 100).toFixed(0);
																																																																																																																																																																																																																																																																																								// $el.append(
																																																																																																																																																																																																																																																																																								// '<li
																																																																																																																																																																																																																																																																																								// class="focus
																																																																																																																																																																																																																																																																																								// fa'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// model.id
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '">'
																																																																																																																																																																																																																																																																																								// + '
																																																																																																																																																																																																																																																																																								// <span
																																																																																																																																																																																																																																																																																								// class="pct
																																																																																																																																																																																																																																																																																								// ' +
																																																																																																																																																																																																																																																																																								// focusIconClass
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '"></span><a
																																																																																																																																																																																																																																																																																								// href="'+
																																																																																																																																																																																																																																																																																								// pathTo
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// view.collection.id
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// model.id
																																																																																																																																																																																																																																																																																								// + '"
																																																																																																																																																																																																																																																																																								// class="focus-title">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// focusName
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</a>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</li>');
																																																																																																																																																																																																																																																																																								// $('.fa'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// (model.id)
																																																																																																																																																																																																																																																																																								// + '
																																																																																																																																																																																																																																																																																								// .pct').text(value
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '%');
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// $el.prepend('<h3
																																																																																																																																																																																																																																																																																								// id="focus">Focus
																																																																																																																																																																																																																																																																																								// Areas
																																																																																																																																																																																																																																																																																								// <span>%
																																																																																																																																																																																																																																																																																								// of
																																																																																																																																																																																																																																																																																								// budget</span></h3>');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (view.collection.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'operating_unit'
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// view.collection.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'donors')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// donor
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (_(app.app.filters).find(function(filter)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// filter.collection
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'donors';
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// {id:
																																																																																																																																																																																																																																																																																								// 0}).id;
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// max
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '',
																																																																																																																																																																																																																																																																																								// rows
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// [],
																																																																																																																																																																																																																																																																																								// newWidth
																																																																																																																																																																																																																																																																																								// = 1;
																																																																																																																																																																																																																																																																																								// $('#chart-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// view.collection.id
																																																																																																																																																																																																																																																																																								// + '
																																																																																																																																																																																																																																																																																								// .rows').html('');
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// status
																																																																																																																																																																																																																																																																																								// = 1,
																																																																																																																																																																																																																																																																																								// processes
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// chartModels.length;
																																																																																																																																																																																																																																																																																								// _(chartModels).each(function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// setTimeout(function()
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (view.collection.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'donors')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// donor
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// model.id;
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// donorProjects
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (donor)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// app.projects.chain()
																																																																																																																																																																																																																																																																																								// .map(function(project)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// donorIndex
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(project.get('donors')).indexOf(donor);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (donorIndex
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// -1)
																																																																																																																																																																																																																																																																																								// return;
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// budget:
																																																																																																																																																																																																																																																																																								// project.get('donor_budget')[donorIndex],
																																																																																																																																																																																																																																																																																								// expenditure:
																																																																																																																																																																																																																																																																																								// project.get('donor_expend')[donorIndex]
																																																																																																																																																																																																																																																																																								// };
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0).compact().value()
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// [];
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// donorBudget
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(donorProjects).chain().pluck('budget')
																																																																																																																																																																																																																																																																																								// .reduce(function(memo,
																																																																																																																																																																																																																																																																																								// num){
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// memo
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// num;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0).value();
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// donorExpenditure
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(donorProjects).chain().pluck('expenditure')
																																																																																																																																																																																																																																																																																								// .reduce(function(memo,
																																																																																																																																																																																																																																																																																								// num){
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// memo
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// num;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0).value();
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (donor)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// app.projects.map.collection.donorID
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// app.projects.map.collection.donorBudget[donor]
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// donorBudget;
																																																																																																																																																																																																																																																																																								// app.projects.map.collection.donorExpenditure[donor]
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// donorExpenditure;
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// donorBudget
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (donor)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// app.projects.chain()
																																																																																																																																																																																																																																																																																								// .filter(function(project)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// project.get('operating_unit')
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// model.id;
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// .reduce(function(memo,
																																																																																																																																																																																																																																																																																								// project)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// donorIndex
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(project.get('donors')).indexOf(donor);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (donorIndex
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// -1)
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// memo;
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// memo
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// project.get('donor_budget')[donorIndex];
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0).value()
																																																																																																																																																																																																																																																																																								// : 0;
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// donorExpenditure
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (donor)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// app.projects.chain()
																																																																																																																																																																																																																																																																																								// .filter(function(project)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// project.get('operating_unit')
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// model.id;
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// .reduce(function(memo,
																																																																																																																																																																																																																																																																																								// project)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// donorIndex
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(project.get('donors')).indexOf(donor);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (donorIndex
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// -1)
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// memo;
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// memo
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// project.get('donor_expend')[donorIndex];
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0).value()
																																																																																																																																																																																																																																																																																								// : 0;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (donor)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// app.projects.map.collection.donorID
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// app.projects.map.collection.operating_unitBudget[model.get('id')]
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// donorBudget;
																																																																																																																																																																																																																																																																																								// app.projects.map.collection.operating_unitExpenditure[model.get('id')]
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// donorExpenditure;
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// budget
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// accounting.formatMoney(
																																																																																																																																																																																																																																																																																								// ((donor)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// donorBudget
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// model.get('budget'))
																																																																																																																																																																																																																																																																																								// /
																																																																																																																																																																																																																																																																																								// 1000000
																																																																																																																																																																																																																																																																																								// ) +
																																																																																																																																																																																																																																																																																								// 'M';
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// budgetWidth
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (donor)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// (donorBudget)
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// (model.get('budget'));
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// expenditureWidth
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (donor)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// (donorExpenditure)
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// (model.get('expenditure'));
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// caption
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '<a
																																																																																																																																																																																																																																																																																								// href="'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// pathTo
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// model.collection.id
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// model.get('id')
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// model.get('name').toLowerCase().toTitleCase()
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</a>';
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// bar
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="budgetdata"
																																																																																																																																																																																																																																																																																								// data-budget="'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// budgetWidth
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '"></div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="subdata"
																																																																																																																																																																																																																																																																																								// data-expenditure="'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// expenditureWidth
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '"></div>';
																																																																																																																																																																																																																																																																																								// rows.push({
																																																																																																																																																																																																																																																																																								// sort:
																																																																																																																																																																																																																																																																																								// -1 *
																																																																																																																																																																																																																																																																																								// ((donor)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// donorBudget
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// model.get('budget')),
																																																																																																																																																																																																																																																																																								// content:
																																																																																																																																																																																																																																																																																								// '<tr>'
																																																																																																																																																																																																																																																																																								// + '
																																																																																																																																																																																																																																																																																								// <td>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// caption
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</td>'
																																																																																																																																																																																																																																																																																								// + '
																																																																																																																																																																																																																																																																																								// <td
																																																																																																																																																																																																																																																																																								// class="right">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// budget
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</td>'
																																																																																																																																																																																																																																																																																								// + '
																																																																																																																																																																																																																																																																																								// <td
																																																																																																																																																																																																																																																																																								// class="data">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// bar
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</td>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</tr>'
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (status
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// processes)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// callback();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// status++;
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// callback()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// rows
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(rows).sortBy('sort');
																																																																																																																																																																																																																																																																																								// max
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// rows[0].sort
																																																																																																																																																																																																																																																																																								// *
																																																																																																																																																																																																																																																																																								// -1;
																																																																																																																																																																																																																																																																																								// _(rows).each(function(row)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#chart-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// view.collection.id
																																																																																																																																																																																																																																																																																								// + '
																																																																																																																																																																																																																																																																																								// .rows').append(row.content);
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// $('#chart-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// view.collection.id
																																																																																																																																																																																																																																																																																								// + '
																																																																																																																																																																																																																																																																																								// .rows
																																																																																																																																																																																																																																																																																								// tr').each(function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.data
																																																																																																																																																																																																																																																																																								// .budgetdata',
																																																																																																																																																																																																																																																																																								// this).width(($('.data
																																																																																																																																																																																																																																																																																								// .budgetdata',
																																																																																																																																																																																																																																																																																								// this).attr('data-budget')
																																																																																																																																																																																																																																																																																								// /
																																																																																																																																																																																																																																																																																								// max
																																																																																																																																																																																																																																																																																								// *
																																																																																																																																																																																																																																																																																								// 100)
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '%');
																																																																																																																																																																																																																																																																																								// $('.data
																																																																																																																																																																																																																																																																																								// .subdata',
																																																																																																																																																																																																																																																																																								// this).width(($('.data
																																																																																																																																																																																																																																																																																								// .subdata',
																																																																																																																																																																																																																																																																																								// this).attr('data-expenditure')
																																																																																																																																																																																																																																																																																								// /
																																																																																																																																																																																																																																																																																								// max
																																																																																																																																																																																																																																																																																								// *
																																																																																																																																																																																																																																																																																								// 100)
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '%');
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// views.Projects
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.View.extend({
																																																																																																																																																																																																																																																																																								// el:
																																																																																																																																																																																																																																																																																								// '#project-items',
																																																																																																																																																																																																																																																																																								// events:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// .load
																																																																																																																																																																																																																																																																																								// a':
																																																																																																																																																																																																																																																																																								// 'loadMore',
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// table
																																																																																																																																																																																																																																																																																								// tr':
																																																																																																																																																																																																																																																																																								// 'routeToProject',
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// #project-table
																																																																																																																																																																																																																																																																																								// th':
																																																																																																																																																																																																																																																																																								// 'sortProjects'
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// initialize:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.$el.html(templates.projects(this));
																																																																																																																																																																																																																																																																																								// this.collection.on('update',
																																																																																																																																																																																																																																																																																								// this.render,
																																																																																																																																																																																																																																																																																								// this);
																																																																																																																																																																																																																																																																																								// $('#projects
																																																																																																																																																																																																																																																																																								// input[type="search"]').on('keyup',
																																																																																																																																																																																																																																																																																								// _.bind(this.search,
																																																																																																																																																																																																																																																																																								// this));
																																																																																																																																																																																																																																																																																								// this.low
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 50,
																																																																																																																																																																																																																																																																																								// this.high
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 100;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// render:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// pageType
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.history.fragment.split('/')[0];
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// donor
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(app.app.filters).find(function(filter)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// filter.collection
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'donors';
																																																																																																																																																																																																																																																																																								// }),
																																																																																																																																																																																																																																																																																								// models
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(this.collection.filter(function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// model.get('visible');
																																																																																																																																																																																																																																																																																								// }));
																																																																																																																																																																																																																																																																																								// models
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (pageType
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'widget')
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// models.first(10)
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// models.first(50);
																																																																																																																																																																																																																																																																																								// $('#total-count').html(accounting.formatNumber(this.collection.length));
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (donor)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#total-donors').parent().hide();
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (app.projects.map.updateMap)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// $target
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $('.layers
																																																																																																																																																																																																																																																																																								// li:first
																																																																																																																																																																																																																																																																																								// a');
																																																																																																																																																																																																																																																																																								// $('.map-btn').removeClass('active');
																																																																																																																																																																																																																																																																																								// $target.addClass('active');
																																																																																																																																																																																																																																																																																								// app.projects.map.updateMap($target.attr('data-value'));
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#total-donors').parent().show();
																																																																																																																																																																																																																																																																																								// $('#total-donors').html(accounting.formatNumber(_(this.collection.donors).size()));
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// $('#total-budget').html(
																																																																																																																																																																																																																																																																																								// (donor)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// accounting.formatMoney(this.collection.donorBudget[donor.id]
																																																																																																																																																																																																																																																																																								// /
																																																																																																																																																																																																																																																																																								// 1000000)
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// 'M'
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// accounting.formatMoney(this.collection.budget
																																																																																																																																																																																																																																																																																								// /
																																																																																																																																																																																																																																																																																								// 1000000)
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// 'M'
																																																																																																																																																																																																																																																																																								// );
																																																																																																																																																																																																																																																																																								// $('#total-expenditure').html(
																																																																																																																																																																																																																																																																																								// (donor)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// accounting.formatMoney(this.collection.donorExpenditure[donor.id]
																																																																																																																																																																																																																																																																																								// /
																																																																																																																																																																																																																																																																																								// 1000000)
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// 'M'
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// accounting.formatMoney(this.collection.expenditure
																																																																																																																																																																																																																																																																																								// /
																																																																																																																																																																																																																																																																																								// 1000000)
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// 'M'
																																																																																																																																																																																																																																																																																								// );
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (models.length)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.$('#project-table
																																																																																																																																																																																																																																																																																								// tbody').empty();
																																																																																																																																																																																																																																																																																								// _(models).each(function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.$('#project-table
																																																																																																																																																																																																																																																																																								// tbody').append(templates.project({
																																																																																																																																																																																																																																																																																								// model:
																																																																																																																																																																																																																																																																																								// model
																																																																																																																																																																																																																																																																																								// }));
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (pageType
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'widget')
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (models.length
																																																																																																																																																																																																																																																																																								// <
																																																																																																																																																																																																																																																																																								// 10)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.load').hide();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.load').show();
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (models.length
																																																																																																																																																																																																																																																																																								// <
																																																																																																																																																																																																																																																																																								// 50)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.load').hide();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.load').show();
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.$('.load').hide();
																																																																																																																																																																																																																																																																																								// this.$('#project-table
																																																																																																																																																																																																																																																																																								// tbody').empty().append('<tr><td><em>No
																																																																																																																																																																																																																																																																																								// projects</em></td><td></td><td></td></tr>');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// loadMore:
																																																																																																																																																																																																																																																																																								// function(e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// self
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// this.low
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.high;
																																																																																																																																																																																																																																																																																								// this.high
																																																																																																																																																																																																																																																																																								// +=
																																																																																																																																																																																																																																																																																								// 50;
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// models
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(this.collection.filter(function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// model.get('visible');
																																																																																																																																																																																																																																																																																								// })).slice(self.low,self.high);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (models.length)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _(models).each(function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.$('#project-table
																																																																																																																																																																																																																																																																																								// tbody').append(templates.project({
																																																																																																																																																																																																																																																																																								// model:
																																																																																																																																																																																																																																																																																								// model
																																																																																																																																																																																																																																																																																								// }));
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $(e.target).text('All
																																																																																																																																																																																																																																																																																								// Projects
																																																																																																																																																																																																																																																																																								// Loaded').addClass('disabled');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// routeToProject:
																																																																																																																																																																																																																																																																																								// function(e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// id =
																																																																																																																																																																																																																																																																																								// $(e.currentTarget).attr('id');
																																																																																																																																																																																																																																																																																								// app.navigate(id,
																																																																																																																																																																																																																																																																																								// {trigger:
																																																																																																																																																																																																																																																																																								// true});
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// search:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// view
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// pasted
																																																																																																																																																																																																																																																																																								// values
																																																																																																																																																																																																																																																																																								// seem
																																																																																																																																																																																																																																																																																								// to
																																																																																																																																																																																																																																																																																								// need
																																																																																																																																																																																																																																																																																								// this
																																																																																																																																																																																																																																																																																								// delay
																																																																																																																																																																																																																																																																																								// window.setTimeout(function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// $target
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $(e.target),
																																																																																																																																																																																																																																																																																								// val
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $target.val().toLowerCase(),
																																																																																																																																																																																																																																																																																								// mode
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (val.substr(0,
																																																																																																																																																																																																																																																																																								// 3)
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// '000')
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// 'id'
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// 'name';
																																																																																																																																																																																																																																																																																								// $target.parent().find('.reset').toggleClass('hidden',
																																																																																																																																																																																																																																																																																								// (val
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// ''));
																																																																																																																																																																																																																																																																																								// view.collection.each(function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// name
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// model.get(mode).toLowerCase();
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (val
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// ''
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// name.indexOf(val)
																																																																																																																																																																																																																																																																																								// >=
																																																																																																																																																																																																																																																																																								// 0) {
																																																																																																																																																																																																																																																																																								// model.set('visible',
																																																																																																																																																																																																																																																																																								// true);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// model.set('visible',
																																																																																																																																																																																																																																																																																								// false);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// view.render();
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 100);
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// sortProjects:
																																																																																																																																																																																																																																																																																								// function(e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// that
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.collection,
																																																																																																																																																																																																																																																																																								// $target
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $(e.target);
																																																																																																																																																																																																																																																																																								// e.preventDefault();
																																																																																																																																																																																																																																																																																								// e.stopPropagation();
																																																																																																																																																																																																																																																																																								// $('.table
																																																																																																																																																																																																																																																																																								// th').removeClass('sort-down
																																																																																																																																																																																																																																																																																								// sort-up');
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Toggle
																																																																																																																																																																																																																																																																																								// sorting
																																																																																																																																																																																																																																																																																								// by
																																																																																																																																																																																																																																																																																								// descending/ascending
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// ($target.attr('data-sort')
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// that.sortData)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (that.sortOrder
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'desc')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// that.sortOrder
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 'asc';
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (that.sortData
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'name')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $target.addClass('sort-up');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $target.addClass('sort-down');
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// that.sortOrder
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 'desc';
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (that.sortData
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'name')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $target.addClass('sort-down');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $target.addClass('sort-up');
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// that.sortData
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $target.attr('data-sort');
																																																																																																																																																																																																																																																																																								// that.sortOrder
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (that.sortData
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'name')
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// 'asc'
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// 'desc';
																																																																																																																																																																																																																																																																																								// $target.addClass('sort-up');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// this.collection.models
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _.sortBy(that.models,
																																																																																																																																																																																																																																																																																								// function(model)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (that.sortOrder
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'desc')
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (that.sortData
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'name')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// -model.get(that.sortData).toLowerCase().charCodeAt(0);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// -model.get(that.sortData);
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// model.get(that.sortData);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// this.render();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// views.ProjectProfile
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.View.extend({
																																																																																																																																																																																																																																																																																								// events:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// .widget-config':
																																																																																																																																																																																																																																																																																								// 'requestIframe',
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// .load
																																																																																																																																																																																																																																																																																								// a':
																																																																																																																																																																																																																																																																																								// 'loadMore'
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// initialize:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.render();
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// outputID
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.options.gotoOutput;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (outputID)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// window.setTimeout(function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// window.scrollTo(0,
																																																																																																																																																																																																																																																																																								// $('#output-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// outputID).offset().top);
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// $('#all-projects').on('click',
																																																																																																																																																																																																																																																																																								// function(e)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (app.app)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// e.preventDefault();
																																																																																																																																																																																																																																																																																								// window.history.back();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// $('#profile
																																																																																																																																																																																																																																																																																								// .summary').removeClass('off');
																																																																																																																																																																																																																																																																																								// this.low
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 10,
																																																																																																																																																																																																																																																																																								// this.high
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 10;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// render:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#breadcrumbs
																																																																																																																																																																																																																																																																																								// ul').html(
																																																																																																																																																																																																																																																																																								// '<li><a
																																																																																																																																																																																																																																																																																								// href="http://www.undp.org/content/undp/en/home.html">Home</a></li>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<li><a
																																																																																																																																																																																																																																																																																								// href="/undp-projects">Our
																																																																																																																																																																																																																																																																																								// Projects</a></li>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<li><a
																																																																																																																																																																																																																																																																																								// href="#'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// CURRENT_YR
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '/filter/operating_unit-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// this.model.get('operating_unit_id')
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// this.model.get("operating_unit")
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</a></li>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<li><a
																																																																																																																																																																																																																																																																																								// href="#project/'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// this.model.get('id')
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// this.model.get('id')
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</a></li>'
																																																																																																																																																																																																																																																																																								// );
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// start
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.model.get('start').split('-');
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// end
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.model.get('end').split('-');
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// startDate
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// Date(start[0],start[1]-1,start[2]),
																																																																																																																																																																																																																																																																																								// endDate
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// Date(end[0],end[1]-1,end[2]),
																																																																																																																																																																																																																																																																																								// curDate
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// Date(),
																																																																																																																																																																																																																																																																																								// progress
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// ((curDate
																																																																																																																																																																																																																																																																																								// -
																																																																																																																																																																																																																																																																																								// startDate)
																																																																																																																																																																																																																																																																																								// /
																																																																																																																																																																																																																																																																																								// (endDate
																																																																																																																																																																																																																																																																																								// -
																																																																																																																																																																																																																																																																																								// startDate))
																																																																																																																																																																																																																																																																																								// *
																																																																																																																																																																																																																																																																																								// 100;
																																																																																																																																																																																																																																																																																								// that
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// this.model.attributes.budget
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _.chain(this.model.attributes.outputs)
																																																																																																																																																																																																																																																																																								// .map(function
																																																																																																																																																																																																																																																																																								// (o)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// o.budget;
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// .flatten()
																																																																																																																																																																																																																																																																																								// .reduce(function(memo,
																																																																																																																																																																																																																																																																																								// num){
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// memo
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// num;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0)
																																																																																																																																																																																																																																																																																								// .value();
																																																																																																																																																																																																																																																																																								// this.model.attributes.expenditure
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _.chain(this.model.attributes.outputs)
																																																																																																																																																																																																																																																																																								// .map(function
																																																																																																																																																																																																																																																																																								// (o)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// o.expenditure;
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// .flatten()
																																																																																																																																																																																																																																																																																								// .reduce(function(memo,
																																																																																																																																																																																																																																																																																								// num){
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// memo
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// num;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0)
																																																																																																																																																																																																																																																																																								// .value();
																																																																																																																																																																																																																																																																																								// this.model.attributes.budgetyears
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _.reduce(this.model.attributes.outputs,
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (res,
																																																																																																																																																																																																																																																																																								// obj)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _.each(obj.fiscal_year,
																																																																																																																																																																																																																																																																																								// function(o,i)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// res[o]
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (res[o]
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// 0) +
																																																																																																																																																																																																																																																																																								// obj.budget[i];
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// res;
																																																																																																																																																																																																																																																																																								// },{});
																																																																																																																																																																																																																																																																																								// this.model.attributes.expendyears
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _.reduce(this.model.attributes.outputs,
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (res,
																																																																																																																																																																																																																																																																																								// obj)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _.each(obj.fiscal_year,
																																																																																																																																																																																																																																																																																								// function(o,i)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// res[o]
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (res[o]
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// 0) +
																																																																																																																																																																																																																																																																																								// obj.expenditure[i];
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// res;
																																																																																																																																																																																																																																																																																								// },{});
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// s =
																																																																																																																																																																																																																																																																																								// this.model.get('start').split('-');
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// e =
																																																																																																																																																																																																																																																																																								// this.model.get('end').split('-');
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// start
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// Date(s[0],s[1]-1,s[2]).format('M
																																																																																																																																																																																																																																																																																								// d,
																																																																																																																																																																																																																																																																																								// Y');
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// end
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// Date(e[0],e[1]-1,e[2]).format('M
																																																																																																																																																																																																																																																																																								// d,
																																																																																																																																																																																																																																																																																								// Y');
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// documents
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// [];
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (this.model.get('document_name'))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// filterDocNames
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(this.model.get('document_name')[0]).filter(function(n)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// !(/\.(gif|jpg|jpeg|tiff|png)$/i).test(n);
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// filterDocUrls
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(this.model.get('document_name')[1]).filter(function(d)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// !(/\.(gif|jpg|jpeg|tiff|png)$/i).test(d);
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (filterDocNames.length
																																																																																																																																																																																																																																																																																								// !==
																																																																																																																																																																																																																																																																																								// 0) {
																																																																																																																																																																																																																																																																																								// _(filterDocNames).each(function(d,
																																																																																																																																																																																																																																																																																								// i) {
																																																																																																																																																																																																																																																																																								// documents[i]
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// {};
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// title
																																																																																																																																																																																																																																																																																								// = d;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (title.length
																																																																																																																																																																																																																																																																																								// >
																																																																																																																																																																																																																																																																																								// 38)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// documents[i].title
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// title.substring(0,
																																																																																																																																																																																																																																																																																								// 38)
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '...';
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// documents[i].title
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// title;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// documents[i].filetype
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// d.split('.').pop();
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// _(filterDocUrls).each(function(d,
																																																																																																																																																																																																																																																																																								// i) {
																																																																																																																																																																																																																																																																																								// documents[i].src
																																																																																																																																																																																																																																																																																								// = d;
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// window.setTimeout(function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('html,
																																																																																																																																																																																																																																																																																								// body').scrollTop(0);
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (this.options.embed)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.$el.empty().append(templates.embedProjectProfile({
																																																																																																																																																																																																																																																																																								// start:
																																																																																																																																																																																																																																																																																								// start,
																																																																																																																																																																																																																																																																																								// end:
																																																																																																																																																																																																																																																																																								// end,
																																																																																																																																																																																																																																																																																								// documents:
																																																																																																																																																																																																																																																																																								// documents,
																																																																																																																																																																																																																																																																																								// model:
																																																																																																																																																																																																																																																																																								// this.model
																																																																																																																																																																																																																																																																																								// }));
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Depending
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// options
																																																																																																																																																																																																																																																																																								// passed
																																																																																																																																																																																																																																																																																								// into
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// array
																																																																																																																																																																																																																																																																																								// add
																																																																																																																																																																																																																																																																																								// a
																																																																																																																																																																																																																																																																																								// fade
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// in
																																																																																																																																																																																																																																																																																								// class
																																																																																																																																																																																																																																																																																								// to
																																																																																																																																																																																																																																																																																								// all
																																																																																																																																																																																																																																																																																								// elements
																																																																																																																																																																																																																																																																																								// containing
																																																																																																																																																																																																																																																																																								// a
																																																																																																																																																																																																																																																																																								// data-option
																																																																																																																																																																																																																																																																																								// attribute
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (this.options.embed)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _(this.options.embed).each(function
																																																																																																																																																																																																																																																																																								// (o)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('[data-option="'
																																																																																																																																																																																																																																																																																								// + o
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '"]').show();
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.$el.empty().append(templates.projectProfile({
																																																																																																																																																																																																																																																																																								// start:
																																																																																																																																																																																																																																																																																								// start,
																																																																																																																																																																																																																																																																																								// end:
																																																																																																																																																																																																																																																																																								// end,
																																																																																																																																																																																																																																																																																								// base:
																																																																																																																																																																																																																																																																																								// BASE_URL,
																																																																																																																																																																																																																																																																																								// documents:
																																																																																																																																																																																																																																																																																								// documents,
																																																																																																																																																																																																																																																																																								// model:
																																																																																																																																																																																																																																																																																								// this.model
																																																																																																																																																																																																																																																																																								// })).show();
																																																																																																																																																																																																																																																																																								// } //
																																																																																																																																																																																																																																																																																								// If
																																																																																																																																																																																																																																																																																								// first
																																																																																																																																																																																																																																																																																								// load
																																																																																																																																																																																																																																																																																								// is a
																																																																																																																																																																																																																																																																																								// project
																																																																																																																																																																																																																																																																																								// page
																																																																																																																																																																																																																																																																																								// or
																																																																																																																																																																																																																																																																																								// output,
																																																																																																																																																																																																																																																																																								// don't
																																																																																																																																																																																																																																																																																								// animate
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (app.app
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// this.options.gotoOutput
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// false)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#profile
																																																																																																																																																																																																																																																																																								// .summary').addClass('off');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// this.map
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// views.ProjectMap({
																																																																																																																																																																																																																																																																																								// el:
																																																																																																																																																																																																																																																																																								// '#profilemap',
																																																																																																																																																																																																																																																																																								// model:
																																																																																																																																																																																																																																																																																								// this.model,
																																																																																																																																																																																																																																																																																								// embed:
																																																																																																																																																																																																																																																																																								// this.options.embed,
																																																																																																																																																																																																																																																																																								// render:
																																																																																																																																																																																																																																																																																								// true
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// $('#progress').find('.bar').css('width',
																																																																																																																																																																																																																																																																																								// progress
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '%');
																																																																																																																																																																																																																																																																																								// this.$('#outputs').empty();
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (this.model.attributes.outputs)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// outputs
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.model.attributes.outputs.slice(0,
																																																																																																																																																																																																																																																																																								// 9);
																																																																																																																																																																																																																																																																																								// _(outputs).each(function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.$('#outputs').append(templates.projectOutputs({
																																																																																																																																																																																																																																																																																								// model:
																																																																																																																																																																																																																																																																																								// model
																																																																																																																																																																																																																																																																																								// }));
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Project
																																																																																																																																																																																																																																																																																								// Outputs
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (this.model.attributes.outputs.length
																																																																																																																																																																																																																																																																																								// <
																																																																																																																																																																																																																																																																																								// 10)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.load').hide();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.load').show();
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Append
																																																																																																																																																																																																																																																																																								// menu
																																																																																																																																																																																																																																																																																								// items
																																																																																																																																																																																																																																																																																								// to
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// breadcrumb
																																																																																																																																																																																																																																																																																								// $('breadcrumbs').find('ul').remove();
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// requestIframe:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// context
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $('#widget');
																																																																																																																																																																																																																																																																																								// widgetOpts
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// ['title','map','outputs'];
																																																																																																																																																																																																																																																																																								// $('.widget-options
																																																																																																																																																																																																																																																																																								// a',context).removeClass('active');
																																																																																																																																																																																																																																																																																								// _(widgetOpts).each(function(widgetTitle){
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// widgetEl
																																																																																																																																																																																																																																																																																								// =widgetTitle
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '-opt';
																																																																																																																																																																																																																																																																																								// $("."
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// widgetEl).find('a').addClass('active');
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// embedPath
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// location.hash.replace('project',
																																																																																																																																																																																																																																																																																								// 'widget/project');
																																																																																																																																																																																																																																																																																								// defaultIframe
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '<iframe
																																																																																																																																																																																																																																																																																								// src="/undp-projects/embed.html'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// embedPath
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '?'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// widgetOpts.join('&')
																																																																																																																																																																																																																																																																																								// + '"
																																																																																																																																																																																																																																																																																								// width="680"
																																																																																																																																																																																																																																																																																								// height="500"
																																																																																																																																																																																																																																																																																								// frameborder="0">
																																																																																																																																																																																																																																																																																								// </iframe>';
																																																																																																																																																																																																																																																																																								// $('.widget-preview',
																																																																																																																																																																																																																																																																																								// context).html(defaultIframe);
																																																																																																																																																																																																																																																																																								// $('.widget-code',
																																																																																																																																																																																																																																																																																								// context)
																																																																																																																																																																																																																																																																																								// .val(defaultIframe)
																																																																																																																																																																																																																																																																																								// .select();
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// loadMore:
																																																																																																																																																																																																																																																																																								// function(e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.low
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.high;
																																																																																																																																																																																																																																																																																								// this.high
																																																																																																																																																																																																																																																																																								// +=
																																																																																																																																																																																																																																																																																								// 10;
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// outputs
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.model.attributes.outputs.slice(this.low,
																																																																																																																																																																																																																																																																																								// this.high);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (outputs.length)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _(outputs).each(function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.$('#outputs').append(templates.projectOutputs({
																																																																																																																																																																																																																																																																																								// model:
																																																																																																																																																																																																																																																																																								// model
																																																																																																																																																																																																																																																																																								// }));
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $(e.target).text('All
																																																																																																																																																																																																																																																																																								// Projects
																																																																																																																																																																																																																																																																																								// Loaded').addClass('disabled');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// views.Map
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.View.extend({
																																																																																																																																																																																																																																																																																								// initialize:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (this.options.render)
																																																																																																																																																																																																																																																																																								// this.render();
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// render:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// view
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this,
																																																																																																																																																																																																																																																																																								// category;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (view.map){view.map.remove();}
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// remove
																																																																																																																																																																																																																																																																																								// previous
																																																																																																																																																																																																																																																																																								// map,
																																																																																																																																																																																																																																																																																								// same
																																																																																																																																																																																																																																																																																								// concept
																																																																																																																																																																																																																																																																																								// as
																																																																																																																																																																																																																																																																																								// view.$el.empty()
																																																																																																																																																																																																																																																																																								// for
																																																																																																																																																																																																																																																																																								// updating,
																																																																																																																																																																																																																																																																																								// http://leafletjs.com/reference.html#map-remove
																																																																																																																																																																																																																																																																																								// view.$el.empty();
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (IE)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.$el.css('border','1px
																																																																																																																																																																																																																																																																																								// solid
																																																																																																																																																																																																																																																																																								// #ddd');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.$el.append('<div
																																																																																																																																																																																																																																																																																								// class="inner-shadow"></div>');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// view.$el.find('.inner-grey').remove();
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// remove
																																																																																																																																																																																																																																																																																								// 'operating
																																																																																																																																																																																																																																																																																								// unit
																																																																																																																																																																																																																																																																																								// has
																																																																																																																																																																																																																																																																																								// no
																																																																																																																																																																																																																																																																																								// geo'
																																																																																																																																																																																																																																																																																								// paragraph
																																																																																																																																																																																																																																																																																								// view.regionFilter
																																																																																																																																																																																																																																																																																								// =_(app.app.filters).findWhere({collection:"region"});
																																																																																																																																																																																																																																																																																								// view.opUnitFilter
																																																																																																																																																																																																																																																																																								// =_(app.app.filters).findWhere({collection:"operating_unit"});
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!view.options.embed)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// category
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $('.map-btn.active').attr('data-value')
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// 'budget';
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// when
																																																																																																																																																																																																																																																																																								// no
																																																																																																																																																																																																																																																																																								// operating
																																																																																																																																																																																																																																																																																								// unit
																																																																																																																																																																																																																																																																																								// is
																																																																																																																																																																																																																																																																																								// selected,
																																																																																																																																																																																																																																																																																								// reset
																																																																																																																																																																																																																																																																																								// to
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// global
																																																																																																																																																																																																																																																																																								// map
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (category
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'budget'
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// _.isUndefined(view.opUnitFilter)){$('.map-btn.budget').addClass('active')};
																																																																																																																																																																																																																																																																																								// wheelZoom
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// true;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// category
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 'budget';
																																																																																																																																																																																																																																																																																								// wheelZoom
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// };
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// create
																																																																																																																																																																																																																																																																																								// circle
																																																																																																																																																																																																																																																																																								// or
																																																																																																																																																																																																																																																																																								// cluster
																																																																																																																																																																																																																																																																																								// based
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// operating
																																																																																																																																																																																																																																																																																								// unit
																																																																																																																																																																																																																																																																																								// filter
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (_.isObject(view.opUnitFilter)){
																																																																																																																																																																																																																																																																																								// view.markers
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// L.MarkerClusterGroup({showCoverageOnHover:false});
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// maxZoom
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 10;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.markers
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// L.LayerGroup();
																																																																																																																																																																																																																																																																																								// };
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// create
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// map
																																																																																																																																																																																																																																																																																								// with
																																																																																																																																																																																																																																																																																								// mapbox.js
																																																																																																																																																																																																																																																																																								// 1.3.1
																																																																																																																																																																																																																																																																																								// view.map
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// L.mapbox.map(this.el,TJ.id,{
																																																																																																																																																																																																																																																																																								// center:
																																																																																																																																																																																																																																																																																								// [0,-15],
																																																																																																																																																																																																																																																																																								// zoom:
																																																																																																																																																																																																																																																																																								// 2,
																																																																																																																																																																																																																																																																																								// minZoom:
																																																																																																																																																																																																																																																																																								// TJ.minzoom,
																																																																																																																																																																																																																																																																																								// maxZoom:
																																																																																																																																																																																																																																																																																								// maxZoom
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// TJ.maxzoom,
																																																																																																																																																																																																																																																																																								// scrollWheelZoom:
																																																																																																																																																																																																																																																																																								// wheelZoom
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //for
																																																																																																																																																																																																																																																																																								// IE 8
																																																																																																																																																																																																																																																																																								// and
																																																																																																																																																																																																																																																																																								// above
																																																																																																																																																																																																																																																																																								// add
																																																																																																																																																																																																																																																																																								// country
																																																																																																																																																																																																																																																																																								// outline
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!IE
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// IE_VERSION
																																																																																																																																																																																																																																																																																								// >
																																																																																																																																																																																																																																																																																								// 8){view.outline
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// L.GeoJSON()};
																																																																																																																																																																																																																																																																																								// view.buildLayer(category);
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// define
																																																																																																																																																																																																																																																																																								// map
																																																																																																																																																																																																																																																																																								// center
																																																																																																																																																																																																																																																																																								// based
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// region
																																																																																																																																																																																																																																																																																								// filter
																																																																																																																																																																																																																																																																																								// zoomToRegion:
																																																																																																																																																																																																																																																																																								// function(region){
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (region
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// "RBA"){
																																																																																																																																																																																																																																																																																								// this.map.setView([0,20],3,{reset:true});
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (region
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// "RBAP"){
																																																																																																																																																																																																																																																																																								// this.map.setView([37,80],2,{reset:true});
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (region
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// "RBAS"
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// region
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// "PAPP"){
																																																																																																																																																																																																																																																																																								// this.map.setView([32,32],3,{reset:true});
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (region
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// "RBEC"){
																																																																																																																																																																																																																																																																																								// this.map.setView([50,55],3,{reset:true});
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (region
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// "RBLAC"){
																																																																																																																																																																																																																																																																																								// this.map.setView([-2,-67],2,{reset:true});
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (region
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// "global"){
																																																																																																																																																																																																																																																																																								// this.map.setView([0,0],2,{reset:true});
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// CIRCLE
																																																																																																																																																																																																																																																																																								// scale:
																																																																																																																																																																																																																																																																																								// function(cat,feature)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (cat
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'budget'
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// cat
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'expenditure')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// size
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Math.round(feature.properties[cat]
																																																																																																																																																																																																																																																																																								// /
																																																																																																																																																																																																																																																																																								// 100000);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (size
																																																																																																																																																																																																																																																																																								// <
																																																																																																																																																																																																																																																																																								// 10)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// 10;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// size;
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (cat
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'hdi')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// Math.round(Math.pow(feature.properties[cat],2)
																																																																																																																																																																																																																																																																																								// /
																																																																																																																																																																																																																																																																																								// 0.0008);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// Math.round(feature.properties[cat]
																																																																																																																																																																																																																																																																																								// /
																																																																																																																																																																																																																																																																																								// 0.05);
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// radius:
																																																																																																																																																																																																																																																																																								// function(scaleResult){
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// r =
																																																																																																																																																																																																																																																																																								// Math.round(Math.sqrt(scaleResult/
																																																																																																																																																																																																																																																																																								// Math.PI));
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// r },
																																																																																																																																																																																																																																																																																								// circleHighlight:
																																																																																																																																																																																																																																																																																								// function(e,options){
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!options){options
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// {}}
																																																																																																																																																																																																																																																																																								// $target
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// e.target;
																																																																																																																																																																																																																																																																																								// $target.setStyle({
																																																																																																																																																																																																																																																																																								// color:
																																																																																																																																																																																																																																																																																								// options.color
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// '#fff',
																																																																																																																																																																																																																																																																																								// weight:
																																																																																																																																																																																																																																																																																								// options.weight
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// 1,
																																																																																																																																																																																																																																																																																								// opacity:
																																																																																																																																																																																																																																																																																								// options.opacity
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// 1,
																																																																																																																																																																																																																																																																																								// fillColor:
																																																																																																																																																																																																																																																																																								// options.fillColor
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// '#0055aa',
																																																																																																																																																																																																																																																																																								// fillOpacity:
																																																																																																																																																																																																																																																																																								// options.fillOpacity
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// 0.6
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// circlePopup:
																																																																																																																																																																																																																																																																																								// function(cat,feature)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// description
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="title"><b>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// feature.properties.title
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</b></div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="stat'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// ((cat
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'count')
																																																																																																																																																																																																																																																																																								// ? '
																																																																																																																																																																																																																																																																																								// active'
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// '')
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '">Projects:
																																																																																																																																																																																																																																																																																								// <span
																																																																																																																																																																																																																																																																																								// class="value">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// feature.properties.count
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</span></div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// ((feature.sources
																																																																																																																																																																																																																																																																																								// > 1)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// ('<div
																																																																																																																																																																																																																																																																																								// class="stat'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// ((cat
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'sources')
																																																																																																																																																																																																																																																																																								// ? '
																																																																																																																																																																																																																																																																																								// active'
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// '')
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '">Budget
																																																																																																																																																																																																																																																																																								// Sources:
																																																																																																																																																																																																																																																																																								// <span
																																																																																																																																																																																																																																																																																								// class="value">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// feature.properties.sources
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</span></div>')
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// '')
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="stat'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// ((cat
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'budget')
																																																																																																																																																																																																																																																																																								// ? '
																																																																																																																																																																																																																																																																																								// active'
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// '')
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '">Budget:
																																																																																																																																																																																																																																																																																								// <span
																																																																																																																																																																																																																																																																																								// class="value">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// accounting.formatMoney(feature.properties.budget)
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</span></div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="stat'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// ((cat
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'expenditure')
																																																																																																																																																																																																																																																																																								// ? '
																																																																																																																																																																																																																																																																																								// active'
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// '')
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '">Expenditure:
																																																																																																																																																																																																																																																																																								// <span
																																																																																																																																																																																																																																																																																								// class="value">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// accounting.formatMoney(feature.properties.expenditure)
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</span></div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="stat'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// ((cat
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'hdi')
																																																																																																																																																																																																																																																																																								// ? '
																																																																																																																																																																																																																																																																																								// active'
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// '')
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '">HDI:
																																																																																																																																																																																																																																																																																								// <span
																																																																																																																																																																																																																																																																																								// class="value">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// feature.properties.hdi
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</span></div>';
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// description;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// CLUSTER
																																																																																																																																																																																																																																																																																								// clusterPopup:
																																																																																																																																																																																																																																																																																								// function(feature,
																																																																																																																																																																																																																																																																																								// g) {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// project
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// feature.properties.project,
																																																																																																																																																																																																																																																																																								// title
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// feature.properties.title,
																																																																																																																																																																																																																																																																																								// type
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// g.type[feature.properties.type],
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// scope
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (g.scope[feature.properties.scope])
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// g.scope[feature.properties.scope].split(':')[0]
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// 'unknown',
																																																																																																																																																																																																																																																																																								// precision
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// g.precision[feature.properties.precision];
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// description
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '<div><b>Project:
																																																																																																																																																																																																																																																																																								// </b>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// project
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div><b>Name:
																																																																																																																																																																																																																																																																																								// </b>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// title
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div><b>Location
																																																																																																																																																																																																																																																																																								// type:
																																																																																																																																																																																																																																																																																								// </b>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// type
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</div>'
																																																																																																																																																																																																																																																																																								// // +
																																																																																																																																																																																																																																																																																								// '<div><b>Scope:
																																																																																																																																																																																																																																																																																								// </b>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// scope
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div><b>Precision:
																																																																																																																																																																																																																																																																																								// </b>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// precision
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</div>';
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// description;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// goToLink:
																																																																																																																																																																																																																																																																																								// function(path){
																																																																																																																																																																																																																																																																																								// app.navigate(path,
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// trigger:
																																																																																																																																																																																																																																																																																								// true
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// $('#browser
																																																																																																																																																																																																																																																																																								// .summary').removeClass('off');
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// buildLayer:
																																																																																																																																																																																																																																																																																								// function(layer,mapFilter,mapCenter,mapZoom){
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// view
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// view.map.removeLayer(view.markers);
																																																																																																																																																																																																																																																																																								// //remove
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// marker
																																																																																																																																																																																																																																																																																								// featureGroup
																																																																																																																																																																																																																																																																																								// from
																																																																																																																																																																																																																																																																																								// view.map
																																																																																																																																																																																																																																																																																								// view.markers.clearLayers();
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// inside
																																																																																																																																																																																																																																																																																								// of
																																																																																																																																																																																																																																																																																								// marker
																																																																																																																																																																																																																																																																																								// group,
																																																																																																																																																																																																																																																																																								// clear
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// layers
																																																																																																																																																																																																																																																																																								// from
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// previous
																																																																																																																																																																																																																																																																																								// build
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// count,
																																																																																																																																																																																																																																																																																								// sources,
																																																																																																																																																																																																																																																																																								// budget,
																																																																																																																																																																																																																																																																																								// title,
																																																																																																																																																																																																																																																																																								// hdi,
																																																																																																																																																																																																																																																																																								// hdi_health,
																																																																																																																																																																																																																																																																																								// hdi_education,
																																																																																																																																																																																																																																																																																								// hdi_income,
																																																																																																																																																																																																																																																																																								// unit
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// view.collection;
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// country
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// models.Nationals();
																																																																																																																																																																																																																																																																																								// country.fetch({
																																																																																																																																																																																																																																																																																								// url:
																																																																																																																																																																																																																																																																																								// 'api/operating-unit-index.json',
																																																																																																																																																																																																																																																																																								// success:function(){
																																																																																																																																																																																																																																																																																								// if(_.isObject(view.opUnitFilter)){
																																																																																																																																																																																																																																																																																								// subs
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// models.Subnationals();
																																																																																																																																																																																																																																																																																								// subs.fetch({
																																																																																																																																																																																																																																																																																								// url:
																																																																																																																																																																																																																																																																																								// 'api/units/'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// view.opUnitFilter.id
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '.json',
																																																																																																																																																																																																																																																																																								// success:function(){
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// projects
																																																																																																																																																																																																																																																																																								// in
																																																																																																																																																																																																																																																																																								// subs
																																																																																																																																																																																																																																																																																								// need
																																																																																																																																																																																																																																																																																								// to
																																																																																																																																																																																																																																																																																								// be
																																																																																																																																																																																																																																																																																								// matched
																																																																																																																																																																																																																																																																																								// to
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// unit
																																																																																																																																																																																																																																																																																								// models
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// matching
																																																																																																																																																																																																																																																																																								// subs.models
																																																																																																																																																																																																																																																																																								// and
																																																																																																																																																																																																																																																																																								// unit.models
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// id
																																																																																																																																																																																																																																																																																								// and
																																																																																																																																																																																																																																																																																								// set
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// visible
																																																																																																																																																																																																																																																																																								// ones
																																																																																																																																																																																																																																																																																								// _(unit.models).each(function(model){
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (subs.get(model.id)
																																																																																																																																																																																																																																																																																								// !=
																																																																																																																																																																																																																																																																																								// undefined){
																																																																																																																																																																																																																																																																																								// subs.get(model.id).set({visible:true})
																																																																																																																																																																																																																																																																																								// } })
																																																																																																																																																																																																																																																																																								// filteredSubs
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// subs.filtered();
																																																																																																																																																																																																																																																																																								// //filtered()
																																																																																																																																																																																																																																																																																								// is a
																																																																																																																																																																																																																																																																																								// method
																																																																																																																																																																																																																																																																																								// in
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// collection
																																																																																																																																																																																																																																																																																								// renderClusters(filteredSubs);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// find
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// iso
																																																																																																																																																																																																																																																																																								// number
																																																																																																																																																																																																																																																																																								// from
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// national
																																																																																																																																																																																																																																																																																								// models
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// parent
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(country.models).findWhere({id:view.opUnitFilter.id}),
																																																																																																																																																																																																																																																																																								// iso
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// parseInt(parent.get('iso_num'));
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (_.isNaN(iso)){
																																																																																																																																																																																																																																																																																								// view.$el.prepend('<div
																																																																																																																																																																																																																																																																																								// class="inner-grey">'+
																																																																																																																																																																																																																																																																																								// '<p>The
																																																																																																																																																																																																																																																																																								// seleted
																																																																																																																																																																																																																																																																																								// operating
																																																																																																																																																																																																																																																																																								// unit
																																																																																																																																																																																																																																																																																								// and
																																																																																																																																																																																																																																																																																								// its
																																																																																																																																																																																																																																																																																								// project(s)
																																																																																																																																																																																																																																																																																								// do
																																																																																																																																																																																																																																																																																								// not
																																																																																																																																																																																																																																																																																								// have
																																																																																																																																																																																																																																																																																								// geographic
																																																																																																																																																																																																																																																																																								// information.</p>'+
																																																																																																																																																																																																																																																																																								// '</div>');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// //view.map.setView([parent.lat,parent.lon],zoomToCountry(parent.id,5));
																																																																																																																																																																																																																																																																																								// //draw
																																																																																																																																																																																																																																																																																								// country
																																																																																																																																																																																																																																																																																								// outline
																																																																																																																																																																																																																																																																																								// with
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// topojson
																																																																																																																																																																																																																																																																																								// file
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!IE
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// IE_VERSION
																																																																																																																																																																																																																																																																																								// >
																																																																																																																																																																																																																																																																																								// 8){
																																																																																																																																																																																																																																																																																								// view.outline.clearLayers();
																																																																																																																																																																																																																																																																																								// $.getJSON('api/world-50m-s.json',function(world){
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// topoFeatures
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// topojson.feature(world,
																																																																																																																																																																																																																																																																																								// world.objects.countries).features,
																																																																																																																																																																																																																																																																																								// selectedFeature
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(topoFeatures).findWhere({id:iso}),
																																																																																																																																																																																																																																																																																								// coords
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// selectedFeature.geometry.coordinates;
																																																																																																																																																																																																																																																																																								// view.outline.addData(selectedFeature)
																																																																																																																																																																																																																																																																																								// .setStyle({
																																																																																																																																																																																																																																																																																								// "color":
																																																																																																																																																																																																																																																																																								// "#b5b5b5",
																																																																																																																																																																																																																																																																																								// "weight":
																																																																																																																																																																																																																																																																																								// 3,
																																																																																																																																																																																																																																																																																								// clickable:
																																																																																																																																																																																																																																																																																								// false
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (parent.get('id')
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'RUS')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.map.setView([parent.lat,parent.lon],2);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.map.fitBounds(ctyBounds(coords));
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// view.outline.addTo(view.map);
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.map.setView([parent.lat,parent.lon],4);
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// renderCircles(country);
																																																																																																																																																																																																																																																																																								// if(_.isObject(view.regionFilter)){
																																																																																																																																																																																																																																																																																								// view.zoomToRegion(view.regionFilter.id);
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// renderClusters
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// function(collection){
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// filteredMarkers
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// [],
																																																																																																																																																																																																																																																																																								// projectWithNoGeo
																																																																																																																																																																																																																																																																																								// = 0;
																																																																																																																																																																																																																																																																																								// hasGeo
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// _(collection.models).each(function(model){
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (model.geojson){
																																																																																																																																																																																																																																																																																								// hasGeo
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// true;
																																																																																																																																																																																																																																																																																								// filteredMarkers.push(model.geojson);
																																																																																																																																																																																																																																																																																								// filteredMarkers
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(filteredMarkers).flatten(false);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// projectWithNoGeo
																																																																																																																																																																																																																																																																																								// +=
																																																																																																																																																																																																																																																																																								// 1; }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// verbDo
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (projectWithNoGeo
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 1) ?
																																																																																																																																																																																																																																																																																								// "does"
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// "do";
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// verbHave
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (projectWithNoGeo
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 1) ?
																																																																																																																																																																																																																																																																																								// "has"
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// "have";
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// append
																																																																																																																																																																																																																																																																																								// sub-national
																																																																																																																																																																																																																																																																																								// location
																																																																																																																																																																																																																																																																																								// paragraph
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (projectWithNoGeo
																																																																																																																																																																																																																																																																																								// != 0
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// !hasGeo){
																																																																																																																																																																																																																																																																																								// $('#map-filters').addClass('disabled');
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// no
																																																																																																																																																																																																																																																																																								// sub
																																																																																																																																																																																																																																																																																								// filter
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// page
																																																																																																																																																																																																																																																																																								// $('#description
																																																																																																																																																																																																																																																																																								// p.geography').html("None
																																																																																																																																																																																																																																																																																								// of
																																																																																																																																																																																																																																																																																								// these
																																																																																																																																																																																																																																																																																								// projects
																																																																																																																																																																																																																																																																																								// have
																																																																																																																																																																																																																																																																																								// geographic
																																																																																																																																																																																																																																																																																								// information.");
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (projectWithNoGeo
																																																																																																																																																																																																																																																																																								// != 0
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// hasGeo){
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// projectWithNoGeoParagraph
																																																																																																																																																																																																																																																																																								// = "
																																																																																																																																																																																																																																																																																								// <b>"
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// projectWithNoGeo
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// "</b>
																																																																																																																																																																																																																																																																																								// of
																																																																																																																																																																																																																																																																																								// them
																																																																																																																																																																																																																																																																																								// " +
																																																																																																																																																																																																																																																																																								// verbDo
																																																																																																																																																																																																																																																																																								// + "
																																																																																																																																																																																																																																																																																								// not
																																																																																																																																																																																																																																																																																								// " +
																																																																																																																																																																																																																																																																																								// verbHave
																																																																																																																																																																																																																																																																																								// + "
																																																																																																																																																																																																																																																																																								// geographic
																																																																																																																																																																																																																																																																																								// information;
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// remaining
																																																																																																																																																																																																																																																																																								// <b>"
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// (filteredSubs.length
																																																																																																																																																																																																																																																																																								// -
																																																																																																																																																																																																																																																																																								// projectWithNoGeo)
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// "</b>
																																																																																																																																																																																																																																																																																								// have
																																																																																																																																																																																																																																																																																								// <b>"
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// filteredMarkers.length
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// "</b>
																																																																																																																																																																																																																																																																																								// subnational
																																																																																																																																																																																																																																																																																								// locations
																																																																																																																																																																																																																																																																																								// in
																																																																																																																																																																																																																																																																																								// total."
																																																																																																																																																																																																																																																																																								// $('#description
																																																																																																																																																																																																																																																																																								// p.geography').html(projectWithNoGeoParagraph);
																																																																																																																																																																																																																																																																																								// } //
																																																																																																																																																																																																																																																																																								// create
																																																																																																																																																																																																																																																																																								// clustered
																																																																																																																																																																																																																																																																																								// markers
																																																																																																																																																																																																																																																																																								// $.getJSON('api/subnational-locs-index.json',
																																																																																																																																																																																																																																																																																								// function(subLocIndex){
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// markerOptions
																																																																																																																																																																																																																																																																																								// = {
																																																																																																																																																																																																																																																																																								// 'marker-color':
																																																																																																																																																																																																																																																																																								// '0055aa',
																																																																																																																																																																																																																																																																																								// 'marker-size':
																																																																																																																																																																																																																																																																																								// 'small'
																																																																																																																																																																																																																																																																																								// };
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// filteredMarkersLayer
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// L.geoJson({
																																																																																																																																																																																																																																																																																								// "type":"FeatureCollection",
																																																																																																																																																																																																																																																																																								// "features":filteredMarkers
																																																																																																																																																																																																																																																																																								// }, {
																																																																																																																																																																																																																																																																																								// filter:
																																																																																																																																																																																																																																																																																								// function(feature,
																																																																																																																																																																																																																																																																																								// layer,
																																																																																																																																																																																																																																																																																								// filter)
																																																																																																																																																																																																																																																																																								// { //
																																																																																																																																																																																																																																																																																								// only
																																																																																																																																																																																																																																																																																								// two
																																																																																																																																																																																																																																																																																								// cases
																																																																																																																																																																																																																																																																																								// for
																																																																																																																																																																																																																																																																																								// type,
																																																																																																																																																																																																																																																																																								// hard
																																																																																																																																																																																																																																																																																								// code
																																																																																																																																																																																																																																																																																								// is
																																																																																																																																																																																																																																																																																								// fine
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// subFilter
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// mapFilter
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// "10";
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (subFilter
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// "10"){
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// feature.properties
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// feature.properties['precision']
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// subFilter
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// pointToLayer:
																																																																																																																																																																																																																																																																																								// function(feature,latlng){
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// L.marker(latlng,{
																																																																																																																																																																																																																																																																																								// icon:
																																																																																																																																																																																																																																																																																								// L.mapbox.marker.icon(markerOptions)
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// use
																																																																																																																																																																																																																																																																																								// MapBox
																																																																																																																																																																																																																																																																																								// style
																																																																																																																																																																																																																																																																																								// markers
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// onEachFeature:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (feature,
																																																																																																																																																																																																																																																																																								// layer)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// clusterBrief
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// L.popup({
																																																																																																																																																																																																																																																																																								// closeButton:false,
																																																																																																																																																																																																																																																																																								// offset:
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// L.Point(0,-20)
																																																																																																																																																																																																																																																																																								// }).setContent(view.clusterPopup(feature,
																																																																																																																																																																																																																																																																																								// subLocIndex));
																																																																																																																																																																																																																																																																																								// layer.on('mouseover',function(){
																																																																																																																																																																																																																																																																																								// clusterBrief.setLatLng(this.getLatLng());
																																																																																																																																																																																																																																																																																								// view.map.openPopup(clusterBrief);
																																																																																																																																																																																																																																																																																								// }).on('mouseout',function(){
																																																																																																																																																																																																																																																																																								// view.map.closePopup(clusterBrief);
																																																																																																																																																																																																																																																																																								// }).on('click',function(){
																																																																																																																																																																																																																																																																																								// path
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '#project/'+
																																																																																																																																																																																																																																																																																								// feature.properties.project;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!view.options.embed){view.goToLink(path)};
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// view.markers.addLayer(filteredMarkersLayer);
																																																																																																																																																																																																																																																																																								// view.map.addLayer(view.markers);
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// };
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// renderCircles
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// function(){
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// circles
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// [];
																																																																																																																																																																																																																																																																																								// _(country.models).each(function(model){
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (unit.operating_unit[model.id]
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// model.lon){
																																																																																																																																																																																																																																																																																								// count
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// unit.operating_unit[model.id];
																																																																																																																																																																																																																																																																																								// sources
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (unit.donorID)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// false
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// unit.operating_unitSources[model.id];
																																																																																																																																																																																																																																																																																								// budget
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (unit.donorID
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// _.size(unit.operating_unit))
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// unit.donorBudget[unit.donorID]
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// unit.operating_unitBudget[model.id];
																																																																																																																																																																																																																																																																																								// expenditure
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (unit.donorID
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// _.size(unit.operating_unit))
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// unit.donorExpenditure[unit.donorID]
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// unit.operating_unitExpenditure[model.id];
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Collect
																																																																																																																																																																																																																																																																																								// HDI
																																																																																																																																																																																																																																																																																								// data,
																																																																																																																																																																																																																																																																																								// create
																																																																																																																																																																																																																																																																																								// HDI
																																																																																																																																																																																																																																																																																								// graph
																																																																																																																																																																																																																																																																																								// view
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// filtered
																																																																																																																																																																																																																																																																																								// on a
																																																																																																																																																																																																																																																																																								// single
																																																																																																																																																																																																																																																																																								// operating_unit
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// ((HDI[model.id])
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// HDI[model.id].hdi
																																																																																																																																																																																																																																																																																								// !=
																																																																																																																																																																																																																																																																																								// '' :
																																																																																																																																																																																																																																																																																								// HDI[model.id])
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// hdi
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _.last(HDI[model.id].hdi)[1];
																																																																																																																																																																																																																																																																																								// hdi_health
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _.last(HDI[model.id].health)[1];
																																																																																																																																																																																																																																																																																								// hdi_education
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _.last(HDI[model.id].education)[1];
																																																																																																																																																																																																																																																																																								// hdi_income
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _.last(HDI[model.id].income)[1];
																																																																																																																																																																																																																																																																																								// hdi_rank
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// HDI[model.id].rank;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// hdi
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// hdi_health
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// hdi_education
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// hdi_income
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// hdi_rank
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 'no
																																																																																																																																																																																																																																																																																								// data';
																																																																																																																																																																																																																																																																																								// } //
																																																																																																																																																																																																																																																																																								// populate
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// centroid
																																																																																																																																																																																																																																																																																								// geojson
																																																																																																																																																																																																																																																																																								// model.centroid.properties.count
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// count;
																																																																																																																																																																																																																																																																																								// model.centroid.properties.sources
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// sources;
																																																																																																																																																																																																																																																																																								// model.centroid.properties.budget
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// budget;
																																																																																																																																																																																																																																																																																								// model.centroid.properties.expenditure
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// expenditure;
																																																																																																																																																																																																																																																																																								// model.centroid.properties.hdi
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// hdi;
																																																																																																																																																																																																																																																																																								// model.centroid.properties.popup
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// view.circlePopup(layer,model.centroid);
																																																																																																																																																																																																																																																																																								// model.centroid.properties.radius
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// view.radius(view.scale(layer,model.centroid));
																																																																																																																																																																																																																																																																																								// circles.push(model.centroid);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// defaultCircle
																																																																																																																																																																																																																																																																																								// = {
																																																																																																																																																																																																																																																																																								// color:"#fff",
																																																																																																																																																																																																																																																																																								// weight:1,
																																																																																																																																																																																																																																																																																								// opacity:1,
																																																																																																																																																																																																																																																																																								// fillColor:
																																																																																																																																																																																																																																																																																								// "#0055aa",
																																																																																																																																																																																																																																																																																								// fillOpacity:
																																																																																																																																																																																																																																																																																								// 0.6
																																																																																																																																																																																																																																																																																								// };
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// circleLayer
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// L.geoJson({
																																																																																																																																																																																																																																																																																								// "type":"FeatureCollection",
																																																																																																																																																																																																																																																																																								// "features":_(circles).sortBy(function(f)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// -f.properties[layer];
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// },{
																																																																																																																																																																																																																																																																																								// pointToLayer:function(feature,latlng){
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// L.circleMarker(latlng,defaultCircle).setRadius(feature.properties.radius);
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// onEachFeature:function(feature,
																																																																																																																																																																																																																																																																																								// layer){
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// brief
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// L.popup({
																																																																																																																																																																																																																																																																																								// closeButton:false,
																																																																																																																																																																																																																																																																																								// offset:[0,
																																																																																																																																																																																																																																																																																								// -feature.properties.radius+5]
																																																																																																																																																																																																																																																																																								// }).setContent(feature.properties.popup);
																																																																																																																																																																																																																																																																																								// layer.on('mouseover',function(e){
																																																																																																																																																																																																																																																																																								// brief.setLatLng(this.getLatLng());
																																																																																																																																																																																																																																																																																								// view.map.openPopup(brief);
																																																																																																																																																																																																																																																																																								// view.circleHighlight(e,{color:'#0055aa',weight:2});
																																																																																																																																																																																																																																																																																								// }).on('mouseout',function(e){
																																																																																																																																																																																																																																																																																								// view.map.closePopup(brief);
																																																																																																																																																																																																																																																																																								// view.circleHighlight(e);
																																																																																																																																																																																																																																																																																								// }).on('click',function(e){
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (app.app.filters.length
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 0 ){
																																																																																																																																																																																																																																																																																								// path
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// document.location.hash
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '/filter/operating_unit-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// e.target.feature.properties.id;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// path
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// document.location.hash
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '/operating_unit-'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// e.target.feature.properties.id;
																																																																																																																																																																																																																																																																																								// } if
																																																																																																																																																																																																																																																																																								// (!view.options.embed){view.goToLink(path)};
																																																																																																																																																																																																																																																																																								// }) }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// view.markers.addLayer(circleLayer);
																																																																																																																																																																																																																																																																																								// view.map.addLayer(view.markers);
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// views.ProjectMap
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.View.extend({
																																																																																																																																																																																																																																																																																								// events:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// .map-fullscreen':
																																																																																																																																																																																																																																																																																								// 'fullscreen',
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// initialize:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (this.options.render)
																																																																																																																																																																																																																																																																																								// this.render();
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// tooltip:
																																																																																																																																																																																																																																																																																								// function(data,
																																																																																																																																																																																																																																																																																								// g) {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// //scope
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// g.scope[data.scope',
																																																																																																																																																																																																																																																																																								// type
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// g.type[data.type],
																																																																																																																																																																																																																																																																																								// precision
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// g.precision[data.precision];
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// description
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '<div><b>Location
																																																																																																																																																																																																																																																																																								// type:</b>
																																																																																																																																																																																																																																																																																								// <span
																																																																																																																																																																																																																																																																																								// class="value">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// type
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</span></div>'
																																																																																																																																																																																																																																																																																								// //+
																																																																																																																																																																																																																																																																																								// '<div><b>Scope:</b>
																																																																																																																																																																																																																																																																																								// <span
																																																																																																																																																																																																																																																																																								// class="value">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// scope
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</span></div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div><b>Precision:</b>
																																																																																																																																																																																																																																																																																								// <span
																																																																																																																																																																																																																																																																																								// class="value">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// precision
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</span></div>';
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// description;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// render:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// view
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this,
																																																																																																																																																																																																																																																																																								// locations
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// [],
																																																																																																																																																																																																																																																																																								// unit
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.model.get('operating_unit_id'),
																																																																																																																																																																																																																																																																																								// subLocations
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.model.get('subnational');
																																																																																																																																																																																																																																																																																								// view.map
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// L.mapbox.map(this.el,TJ.id,{
																																																																																																																																																																																																																																																																																								// minZoom:
																																																																																																																																																																																																																																																																																								// 1,
																																																																																																																																																																																																																																																																																								// maxZoom:
																																																																																																																																																																																																																																																																																								// 15
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// adding
																																																																																																																																																																																																																																																																																								// faux
																																																																																																																																																																																																																																																																																								// fullscreen
																																																																																																																																																																																																																																																																																								// control
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!view.options.embed){$('#profilemap').append('<div
																																																																																																																																																																																																																																																																																								// class="full-control"><a
																																																																																																																																																																																																																																																																																								// href="#"
																																																																																																																																																																																																																																																																																								// class="icon
																																																																																																																																																																																																																																																																																								// map-fullscreen"></a></div>');}
																																																																																																																																																																																																																																																																																								// $.getJSON('api/operating-unit-index.json',
																																																																																																																																																																																																																																																																																								// function(data)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// for
																																																																																																																																																																																																																																																																																								// (var
																																																																																																																																																																																																																																																																																								// i =
																																																																																																																																																																																																																																																																																								// 0; i
																																																																																																																																																																																																																																																																																								// <
																																																																																																																																																																																																																																																																																								// data.length;
																																																																																																																																																																																																																																																																																								// i++)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// o =
																																																																																																																																																																																																																																																																																								// data[i];
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (o.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// unit)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.getwebData(o);
																																																																																																																																																																																																																																																																																								// $('#country-summary').html(templates.ctrySummary(o));
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!o.lon)
																																																																																																																																																																																																																																																																																								// {//
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// unit
																																																																																																																																																																																																																																																																																								// has
																																																																																																																																																																																																																																																																																								// no
																																																																																																																																																																																																																																																																																								// geography
																																																																																																																																																																																																																																																																																								// view.$el.prev().hide();
																																																																																																																																																																																																																																																																																								// view.$el.next().addClass('nogeo');
																																																																																																																																																																																																																																																																																								// view.$el.hide();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// iso
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// parseInt(o.iso_num);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!IE
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// IE_VERSION
																																																																																																																																																																																																																																																																																								// >
																																																																																																																																																																																																																																																																																								// 8){
																																																																																																																																																																																																																																																																																								// $.getJSON('api/world-50m-s.json',function(world){
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// topoFeatures
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// topojson.feature(world,
																																																																																																																																																																																																																																																																																								// world.objects.countries).features,
																																																																																																																																																																																																																																																																																								// selectedFeature
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(topoFeatures).findWhere({id:iso}),
																																																																																																																																																																																																																																																																																								// coords
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// selectedFeature.geometry.coordinates;
																																																																																																																																																																																																																																																																																								// outline
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// L.geoJson(selectedFeature,
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// style:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// "color":
																																																																																																																																																																																																																																																																																								// "#b5b5b5",
																																																																																																																																																																																																																																																																																								// "weight":
																																																																																																																																																																																																																																																																																								// 3,
																																																																																																																																																																																																																																																																																								// clickable:
																																																																																																																																																																																																																																																																																								// false
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// }).addTo(view.map);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (o.id
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'RUS')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.map.setView([o.lat,o.lon],1);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.map.fitBounds(ctyBounds(coords));
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.map.setView([o.lat,o.lon],3);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// $.getJSON('api/subnational-locs-index.json',
																																																																																																																																																																																																																																																																																								// function(g)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _.each(subLocations,
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (o)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// locations.push({
																																																																																																																																																																																																																																																																																								// type:
																																																																																																																																																																																																																																																																																								// "Feature",
																																																																																																																																																																																																																																																																																								// geometry:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// type:
																																																																																																																																																																																																																																																																																								// "Point",
																																																																																																																																																																																																																																																																																								// coordinates:
																																																																																																																																																																																																																																																																																								// [
																																																																																																																																																																																																																																																																																								// o.lon,
																																																																																																																																																																																																																																																																																								// o.lat
																																																																																																																																																																																																																																																																																								// ] },
																																																																																																																																																																																																																																																																																								// properties:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// id:
																																																																																																																																																																																																																																																																																								// o.awardID,
																																																																																																																																																																																																																																																																																								// precision:
																																																																																																																																																																																																																																																																																								// o.precision,
																																																																																																																																																																																																																																																																																								// type:
																																																																																																																																																																																																																																																																																								// o.type,
																																																																																																																																																																																																																																																																																								// scope:
																																																																																																																																																																																																																																																																																								// o.scope,
																																																																																																																																																																																																																																																																																								// project:
																																																																																																																																																																																																																																																																																								// view.model.get('project_title'),
																																																																																																																																																																																																																																																																																								// name:
																																																																																																																																																																																																																																																																																								// o.name,
																																																																																																																																																																																																																																																																																								// description:
																																																																																																																																																																																																																																																																																								// view.tooltip(o,
																																																																																																																																																																																																																																																																																								// g),
																																																																																																																																																																																																																																																																																								// 'marker-size':
																																																																																																																																																																																																																																																																																								// 'small',
																																																																																																																																																																																																																																																																																								// 'marker-color':
																																																																																																																																																																																																																																																																																								// '0055aa'
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// onEachFeature(feature,
																																																																																																																																																																																																																																																																																								// layer)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// clusterBrief
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// L.popup({
																																																																																																																																																																																																																																																																																								// closeButton:false,
																																																																																																																																																																																																																																																																																								// offset:
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// L.Point(0,-20)
																																																																																																																																																																																																																																																																																								// }).setContent(feature.properties.description);
																																																																																																																																																																																																																																																																																								// layer.on('mouseover',function(){
																																																																																																																																																																																																																																																																																								// clusterBrief.setLatLng(this.getLatLng());
																																																																																																																																																																																																																																																																																								// view.map.openPopup(clusterBrief);
																																																																																																																																																																																																																																																																																								// }).on('mouseout',function(){
																																																																																																																																																																																																																																																																																								// view.map.closePopup(clusterBrief);
																																																																																																																																																																																																																																																																																								// }) }
																																																																																																																																																																																																																																																																																								// L.geoJson(locations,
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// pointToLayer:
																																																																																																																																																																																																																																																																																								// L.mapbox.marker.style,
																																																																																																																																																																																																																																																																																								// onEachFeature:
																																																																																																																																																																																																																																																																																								// onEachFeature
																																																																																																																																																																																																																																																																																								// }).addTo(view.map);
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// fullscreen:
																																																																																																																																																																																																																																																																																								// function(e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// e.preventDefault();
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// view
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// view.$el.toggleClass('full');
																																																																																																																																																																																																																																																																																								// setTimeout(function(){
																																																																																																																																																																																																																																																																																								// view.map.invalidateSize();
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (view.$el.hasClass('full'))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.map.zoomIn(1,{animate:false});
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.map.zoomOut(1,{animate:false});
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// 250);
																																																																																																																																																																																																																																																																																								// $('a.map-fullscreen').toggleClass('full');
																																																																																																																																																																																																																																																																																								// $('.country-profile').toggleClass('full');
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// getwebData:
																																																																																																																																																																																																																																																																																								// function(data)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// view
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this,
																																																																																																																																																																																																																																																																																								// photos
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// [],
																																																																																																																																																																																																																																																																																								// baseUrl
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '',
																																																																																																																																																																																																																																																																																								// coContact
																																																																																																																																																																																																																																																																																								// = {
																																																																																																																																																																																																																																																																																								// twitter:
																																																																																																																																																																																																																																																																																								// [],
																																																																																																																																																																																																																																																																																								// flickr:
																																																																																																																																																																																																																																																																																								// [],
																																																																																																																																																																																																																																																																																								// facebook:
																																																																																																																																																																																																																																																																																								// []
																																																																																																																																																																																																																																																																																								// };
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Get
																																																																																																																																																																																																																																																																																								// social
																																																																																																																																																																																																																																																																																								// media
																																																																																																																																																																																																																																																																																								// accounts
																																																																																																																																																																																																																																																																																								// from
																																																																																																																																																																																																																																																																																								// UNDP-maintained
																																																																																																																																																																																																																																																																																								// spreadsheet
																																																																																																																																																																																																																																																																																								// $.getJSON('//spreadsheets.google.com/feeds/list/0Airl6dsmcbKodHB4SlVfeVRHeWoyWTdKcDY5UW1xaEE/1/public/values?alt=json-in-script&callback=?',
																																																																																																																																																																																																																																																																																								// function(g)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// flickrAccts
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// [],
																																																																																																																																																																																																																																																																																								// twitterAcct,
																																																																																																																																																																																																																																																																																								// fbAccts
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// [],
																																																																																																																																																																																																																																																																																								// q =
																																																																																																																																																																																																																																																																																								// queue(1);
																																																																																																																																																																																																																																																																																								// q.defer(function(cb)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _.each(g.feed.entry,
																																																																																																																																																																																																																																																																																								// function(row)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (row.gsx$type.$t
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'Global'
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// (row.gsx$type.$t
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'HQ'
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// row.gsx$id.$t
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// view.model.get('region_id'))
																																																																																																																																																																																																																																																																																								// ) {
																																																																																																																																																																																																																																																																																								// //if
																																																																																																																																																																																																																																																																																								// (row.gsx$twitter.$t)
																																																																																																																																																																																																																																																																																								// twitterAccts.push(row.gsx$twitter.$t.replace('@',''));
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (row.gsx$flickr.$t)
																																																																																																																																																																																																																																																																																								// flickrAccts.push(row.gsx$flickr.$t);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (row.gsx$facebook.$t)
																																																																																																																																																																																																																																																																																								// fbAccts.push(row.gsx$facebook.$t);
																																																																																																																																																																																																																																																																																								// } if
																																																																																																																																																																																																																																																																																								// (row.gsx$type.$t
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'CO'
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// row.gsx$id.$t
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// data.id)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (row.gsx$twitter.$t)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// twitterAcct
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// row.gsx$twitter.$t.replace('@','');
																																																																																																																																																																																																																																																																																								// coContact.twitter.push(row.gsx$twitter.$t.replace('@',''));
																																																																																																																																																																																																																																																																																								// } if
																																																																																																																																																																																																																																																																																								// (row.gsx$flickr.$t)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// flickrAccts.unshift(row.gsx$flickr.$t);
																																																																																																																																																																																																																																																																																								// coContact.flickr.push(row.gsx$flickr.$t);
																																																																																																																																																																																																																																																																																								// } if
																																																																																																																																																																																																																																																																																								// (row.gsx$facebook.$t)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// fbAccts.unshift(row.gsx$facebook.$t);
																																																																																																																																																																																																																																																																																								// coContact.facebook.push(row.gsx$facebook.$t);
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// contacts(coContact);
																																																																																																																																																																																																																																																																																								// cb();
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Gather
																																																																																																																																																																																																																																																																																								// photos
																																																																																																																																																																																																																																																																																								// from
																																																																																																																																																																																																																																																																																								// documents,
																																																																																																																																																																																																																																																																																								// twitter,
																																																																																																																																																																																																																																																																																								// and
																																																																																																																																																																																																																																																																																								// flickr,
																																																																																																																																																																																																																																																																																								// in
																																																																																																																																																																																																																																																																																								// that
																																																																																																																																																																																																																																																																																								// order
																																																																																																																																																																																																																																																																																								// q.defer(function(cb)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (that.model.get('document_name'))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _.each(that.model.get('document_name')[0],
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (photo,
																																																																																																																																																																																																																																																																																								// i) {
																																																																																																																																																																																																																																																																																								// try
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// filetype
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// photo.split('.')[1].toLowerCase();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// catch(err)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// filetype
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '';
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// source
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// that.model.get('document_name')[1][i];
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (filetype
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'jpg'
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// filetype
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'jpeg'
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// filetype
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'png'
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// filetype
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'gif')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// img
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// Image();
																																																																																																																																																																																																																																																																																								// photos.push({
																																																																																																																																																																																																																																																																																								// 'title':
																																																																																																																																																																																																																																																																																								// photo.split('.')[0],
																																																																																																																																																																																																																																																																																								// 'source':
																																																																																																																																																																																																																																																																																								// source,
																																																																																																																																																																																																																																																																																								// 'image':
																																																																																																																																																																																																																																																																																								// img
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// img.src
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// source;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// cb();
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// q.await(function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// //view.twitter(twitterAcct,
																																																																																																																																																																																																																																																																																								// function(tweets,
																																																																																																																																																																																																																																																																																								// twPhotos)
																																																																																																																																																																																																																																																																																								// { //
																																																																																																																																																																																																																																																																																								// view.showTweets(tweets);
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// view.flickr(flickrAccts,photos.concat(twPhotos));
																																																																																																																																																																																																																																																																																								// //});
																																																																																																																																																																																																																																																																																								// view.flickr(flickrAccts,photos);
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// contacts(social)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _.each(['web','email','facebook','twitter','flickr'],
																																																																																																																																																																																																																																																																																								// function(v)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// link
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '',
																																																																																																																																																																																																																																																																																								// i =
																																																																																																																																																																																																																																																																																								// 0;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (data[v]
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// (social[v]
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// social[v].length))
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (v
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'twitter')
																																																																																																																																																																																																																																																																																								// baseUrl
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 'http://twitter.com/';
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (v
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'email')
																																																																																																																																																																																																																																																																																								// baseUrl
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 'mailto:';
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (v
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'flickr')
																																																																																																																																																																																																																																																																																								// baseUrl
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 'http://flickr.com/photos/';
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (social[v])
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _.each(social[v],
																																																																																																																																																																																																																																																																																								// function(x)
																																																																																																																																																																																																																																																																																								// { i
																																																																																																																																																																																																																																																																																								// +=
																																																																																																																																																																																																																																																																																								// 1;
																																																																																																																																																																																																																																																																																								// link
																																																																																																																																																																																																																																																																																								// +=
																																																																																																																																																																																																																																																																																								// '<a
																																																																																																																																																																																																																																																																																								// href="'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// baseUrl
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// social[v]
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// ((v
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'twitter')
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// '@'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// social[v]
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// social[v])
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</a>';
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (i <
																																																																																																																																																																																																																																																																																								// social[v].length)
																																																																																																																																																																																																																																																																																								// link
																																																																																																																																																																																																																																																																																								// +=
																																																																																																																																																																																																																																																																																								// ',
																																																																																																																																																																																																																																																																																								// ';
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// link
																																																																																																																																																																																																																																																																																								// +=
																																																																																																																																																																																																																																																																																								// '<a
																																																																																																																																																																																																																																																																																								// href="'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// baseUrl
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// data[v]
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// data[v]
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</a>';
																																																																																																																																																																																																																																																																																								// } //
																																																																																																																																																																																																																																																																																								// Fill
																																																																																																																																																																																																																																																																																								// contact
																																																																																																																																																																																																																																																																																								// modal
																																																																																																																																																																																																																																																																																								// $('#unit-contact
																																																																																																																																																																																																																																																																																								// .modal-body').append(
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="row-fluid">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="contacts
																																																																																																																																																																																																																																																																																								// span2">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<p>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// ((v
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'web')
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// 'Homepage'
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// v.capitalize())
																																																																																																																																																																																																																																																																																								// +'</p>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="span10">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<p>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// link
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</p>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</div>'
																																																																																																																																																																																																																																																																																								// ); }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// twitter:
																																																																																																																																																																																																																																																																																								// function(username,
																																																																																																																																																																																																																																																																																								// callback)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// id =
																																																																																																																																																																																																																																																																																								// this.model.get('project_id'),
																																																																																																																																																																																																																																																																																								// goodTweets
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// [],
																																																																																																																																																																																																																																																																																								// twPhotos
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// [],
																																																																																																																																																																																																																																																																																								// twPage
																																																																																																																																																																																																																																																																																								// = 1;
																																																																																																																																																																																																																																																																																								// getTweets(twPage);
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// filterTweets(t)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (t.length)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// i =
																																																																																																																																																																																																																																																																																								// 0;
																																																																																																																																																																																																																																																																																								// _.each(t,
																																																																																																																																																																																																																																																																																								// function(x)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// i++;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (x.entities.urls.length)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _(x.entities.urls).each(function(url)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (url.expanded_url.indexOf(id)
																																																																																																																																																																																																																																																																																								// !==
																																																																																																																																																																																																																																																																																								// -1)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// ((x.entities.media)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// x.entities.media[0].type
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'photo'
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// x.entities.media)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// twPhotos.push({
																																																																																																																																																																																																																																																																																								// 'source':
																																																																																																																																																																																																																																																																																								// x.entities.media[0].media_url,
																																																																																																																																																																																																																																																																																								// 'date':
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// Date(x.created_at),
																																																																																																																																																																																																																																																																																								// 'description':
																																																																																																																																																																																																																																																																																								// x.text,
																																																																																																																																																																																																																																																																																								// 'link':
																																																																																																																																																																																																																																																																																								// x.entities.media[0].expanded_url,
																																																																																																																																																																																																																																																																																								// 'height':
																																																																																																																																																																																																																																																																																								// x.entities.media[0].sizes.medium.h,
																																																																																																																																																																																																																																																																																								// 'width':
																																																																																																																																																																																																																																																																																								// x.entities.media[0].sizes.medium.w
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// goodTweets.push(x);
																																																																																																																																																																																																																																																																																								// return;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// } if
																																																																																																																																																																																																																																																																																								// (goodTweets.length
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 3) {
																																																																																																																																																																																																																																																																																								// callback(goodTweets,
																																																																																																																																																																																																																																																																																								// twPhotos);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (i
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// t.length)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (twPage
																																																																																																																																																																																																																																																																																								// < 4)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// twPage++;
																																																																																																																																																																																																																																																																																								// getTweets(twPage);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// callback(goodTweets,
																																																																																																																																																																																																																																																																																								// twPhotos);
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// callback(goodTweets,
																																																																																																																																																																																																																																																																																								// twPhotos);
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// getTweets(page)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// success
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// $.getJSON('https://api.twitter.com/1.1/lists/statuses.json?slug=undp-tweets&owner_screen_name=openundp&include_rts=0&since_id=274016103305461762&count=200&page='
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// page
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '&callback=?',
																																																																																																																																																																																																																																																																																								// function(globalTweets)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// success
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// true;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (username)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $.getJSON('https://api.twitter.com/1.1/statuses/user_timeline.json?screen_name='
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// username
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '&include_rts=0&since_id=274016103305461762&count=200&page='
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// page
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '&callback=?',
																																																																																																																																																																																																																																																																																								// function(coTweets)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// filterTweets(coTweets.concat(globalTweets));
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// filterTweets(globalTweets);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// setTimeout(function()
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (!success)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// callback([],
																																																																																																																																																																																																																																																																																								// []);
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// 3000);
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// showTweets:
																																																																																																																																																																																																																																																																																								// function(tweets)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (tweets.length)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#twitter-block').show();
																																																																																																																																																																																																																																																																																								// $('.tweet').tweet({
																																																																																																																																																																																																																																																																																								// tweets:
																																																																																																																																																																																																																																																																																								// tweets,
																																																																																																																																																																																																																																																																																								// avatar_size:
																																																																																																																																																																																																																																																																																								// 40,
																																																																																																																																																																																																																																																																																								// count:
																																																																																																																																																																																																																																																																																								// 3,
																																																																																																																																																																																																																																																																																								// template:
																																																																																																																																																																																																																																																																																								// "{avatar}<div
																																																																																																																																																																																																																																																																																								// class='actions'>{time}</div><div>{text}</div>",
																																																																																																																																																																																																																																																																																								// loading_text:
																																																																																																																																																																																																																																																																																								// "Loading
																																																																																																																																																																																																																																																																																								// Tweets"
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// $('#twitter-block').find('.fade').addClass('in');
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// flickr:
																																																																																																																																																																																																																																																																																								// function(account,
																																																																																																																																																																																																																																																																																								// photos)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// apiBase
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 'http://api.flickr.com/services/rest/?format=json&jsoncallback=?&method=',
																																																																																																																																																																																																																																																																																								// apiKey
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '1da8476bfea197f692c2334997c10c87',
																																																																																																																																																																																																																																																																																								// //from
																																																																																																																																																																																																																																																																																								// UNDP's
																																																																																																																																																																																																																																																																																								// main
																																																																																																																																																																																																																																																																																								// account
																																																																																																																																																																																																																																																																																								// (unitednationsdevelopmentprogramme)
																																																																																																																																																																																																																																																																																								// search
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.model.get('project_id'),
																																																																																																																																																																																																																																																																																								// //search
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 'africa'
																																																																																																																																																																																																																																																																																								// //for
																																																																																																																																																																																																																																																																																								// testing
																																																																																																																																																																																																																																																																																								// attempt
																																																																																																																																																																																																																																																																																								// = 0,
																																																																																																																																																																																																																																																																																								// i =
																																																																																																																																																																																																																																																																																								// 0,
																																																																																																																																																																																																																																																																																								// $el
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $('#flickr');
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!account.length
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// photos.length)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $el.show();
																																																																																																																																																																																																																																																																																								// loadPhoto(i);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _.each(account,
																																																																																																																																																																																																																																																																																								// function(acct)
																																																																																																																																																																																																																																																																																								// { //
																																																																																																																																																																																																																																																																																								// Get
																																																																																																																																																																																																																																																																																								// user
																																																																																																																																																																																																																																																																																								// info
																																																																																																																																																																																																																																																																																								// based
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// flickr
																																																																																																																																																																																																																																																																																								// link
																																																																																																																																																																																																																																																																																								// $.getJSON(apiBase
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// 'flickr.urls.lookupUser&api_key='
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// apiKey
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '&url=http://www.flickr.com/photos/'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// acct,
																																																																																																																																																																																																																																																																																								// function(f)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// searchPhotos(f.user.id,
																																																																																																																																																																																																																																																																																								// search);
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// } //
																																																																																																																																																																																																																																																																																								// Search
																																																																																																																																																																																																																																																																																								// Flickr
																																																																																																																																																																																																																																																																																								// based
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// project
																																																																																																																																																																																																																																																																																								// ID.
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// searchPhotos(id,
																																																																																																																																																																																																																																																																																								// tags)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// attempt
																																																																																																																																																																																																																																																																																								// +=
																																																																																																																																																																																																																																																																																								// 1;
																																																																																																																																																																																																																																																																																								// $.getJSON(apiBase
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// 'flickr.photos.search&api_key='
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// apiKey
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '&user_id='
																																																																																																																																																																																																																																																																																								// + id
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '&tags='
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// tags,
																																																																																																																																																																																																																																																																																								// function(f)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (f.photos.total
																																																																																																																																																																																																																																																																																								// !=
																																																																																																																																																																																																																																																																																								// '0')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// photos
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// photos.concat(f.photos.photo);
																																																																																																																																																																																																																																																																																								// } if
																																																																																																																																																																																																																																																																																								// (attempt
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// account.length)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (photos.length)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $el.show();
																																																																																																																																																																																																																																																																																								// loadPhoto(i);
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// } );
																																																																																																																																																																																																																																																																																								// } //
																																																																																																																																																																																																																																																																																								// Load
																																																																																																																																																																																																																																																																																								// single
																																																																																																																																																																																																																																																																																								// photo
																																																																																																																																																																																																																																																																																								// from
																																																																																																																																																																																																																																																																																								// array
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// loadPhoto(x)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $el.find('.spin').spin({
																																																																																																																																																																																																																																																																																								// color:'#fff'
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (x
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 0)
																																																																																																																																																																																																																																																																																								// $('.prev',
																																																																																																																																																																																																																																																																																								// $el).addClass('inactive');
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (x
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// photos.length
																																																																																																																																																																																																																																																																																								// - 1)
																																																																																																																																																																																																																																																																																								// $('.next',
																																																																																																																																																																																																																																																																																								// $el).addClass('inactive');
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (photos[x].id)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// photoid
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// photos[x].id,
																																																																																																																																																																																																																																																																																								// source,
																																																																																																																																																																																																																																																																																								// pHeight,
																																																																																																																																																																																																																																																																																								// pWidth,
																																																																																																																																																																																																																																																																																								// attempt
																																																																																																																																																																																																																																																																																								// = 0;
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Get
																																																																																																																																																																																																																																																																																								// photo
																																																																																																																																																																																																																																																																																								// info
																																																																																																																																																																																																																																																																																								// based
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// id
																																																																																																																																																																																																																																																																																								// $.getJSON(apiBase
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// 'flickr.photos.getInfo&api_key='
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// apiKey
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '&photo_id='
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// photoid,
																																																																																																																																																																																																																																																																																								// function(info)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// description
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// info.photo.description._content,
																																																																																																																																																																																																																																																																																								// date
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (new
																																																																																																																																																																																																																																																																																								// Date(info.photo.dates.taken)).toLocaleDateString(),
																																																																																																																																																																																																																																																																																								// url
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// info.photo.urls.url[0]._content;
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Get
																																																																																																																																																																																																																																																																																								// available
																																																																																																																																																																																																																																																																																								// sizes
																																																																																																																																																																																																																																																																																								// $.getJSON(apiBase
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// 'flickr.photos.getSizes&api_key='
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// apiKey
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '&photo_id='
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// photoid,
																																																																																																																																																																																																																																																																																								// function(s)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// getSize('Medium
																																																																																																																																																																																																																																																																																								// 800');
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// getSize(sizeName)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _.each(s.sizes.size,
																																																																																																																																																																																																																																																																																								// function(z)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (z.label
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// sizeName)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// source
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// z.source;
																																																																																																																																																																																																																																																																																								// pHeight
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// z.height;
																																																																																																																																																																																																																																																																																								// pWidth
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// z.width;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!source)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// attempt
																																																																																																																																																																																																																																																																																								// +=
																																																																																																																																																																																																																																																																																								// 1;
																																																																																																																																																																																																																																																																																								// switch
																																																																																																																																																																																																																																																																																								// (attempt)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// case
																																																																																																																																																																																																																																																																																								// 1:
																																																																																																																																																																																																																																																																																								// getSize('Medium
																																																																																																																																																																																																																																																																																								// 640');
																																																																																																																																																																																																																																																																																								// break;
																																																																																																																																																																																																																																																																																								// case
																																																																																																																																																																																																																																																																																								// 2:
																																																																																																																																																																																																																																																																																								// getSize('Large');
																																																																																																																																																																																																																																																																																								// break;
																																																																																																																																																																																																																																																																																								// case
																																																																																																																																																																																																																																																																																								// 3:
																																																																																																																																																																																																																																																																																								// getSize('Original');
																																																																																																																																																																																																																																																																																								// break;
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// } //
																																																																																																																																																																																																																																																																																								// Fill
																																																																																																																																																																																																																																																																																								// in
																																																																																																																																																																																																																																																																																								// date
																																																																																																																																																																																																																																																																																								// &
																																																																																																																																																																																																																																																																																								// description
																																																																																																																																																																																																																																																																																								// $('.meta',
																																																																																																																																																																																																																																																																																								// $el).html('<div
																																																																																																																																																																																																																																																																																								// class="meta-inner"><span
																																																																																																																																																																																																																																																																																								// class="date">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// date
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</span>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<p>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// description
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<a
																																																																																																																																																																																																																																																																																								// href="'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// url
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// 'in/photostream/"
																																																																																																																																																																																																																																																																																								// title="See
																																																																																																																																																																																																																																																																																								// our
																																																																																																																																																																																																																																																																																								// photos
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// Flickr">
																																																																																																																																																																																																																																																																																								// Source</a></p></div>');
																																																																																																																																																																																																																																																																																								// insertPhoto(pHeight,
																																																																																																																																																																																																																																																																																								// pWidth,
																																																																																																																																																																																																																																																																																								// source);
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (photos[x].date)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.meta',
																																																																																																																																																																																																																																																																																								// $el).html('<div
																																																																																																																																																																																																																																																																																								// class="meta-inner"><span
																																																																																																																																																																																																																																																																																								// class="date">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// photos[x].date.toLocaleDateString()
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</span>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<p>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// photos[x].description
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<a
																																																																																																																																																																																																																																																																																								// href="'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// photos[x].link
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '/in/photostream/"
																																																																																																																																																																																																																																																																																								// title="See
																																																																																																																																																																																																																																																																																								// our
																																																																																																																																																																																																																																																																																								// photos
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// Flickr">
																																																																																																																																																																																																																																																																																								// Source</a></p></div>');
																																																																																																																																																																																																																																																																																								// insertPhoto(photos[x].height,
																																																																																																																																																																																																																																																																																								// photos[x].width,
																																																																																																																																																																																																																																																																																								// photos[x].source);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// insertPhoto(photos[x].image.height,
																																																																																																																																																																																																																																																																																								// photos[x].image.width,
																																																																																																																																																																																																																																																																																								// photos[x].source);
																																																																																																																																																																																																																																																																																								// $('.meta-inner',
																																																																																																																																																																																																																																																																																								// $el).empty();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// insertPhoto(height,
																																																																																																																																																																																																																																																																																								// width,
																																																																																																																																																																																																																																																																																								// src)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $el.find('img').attr('src',
																																																																																																																																																																																																																																																																																								// src).addClass('in');
																																																																																																																																																																																																																																																																																								// $el.find('.spin').spin(false);
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Cycle
																																																																																																																																																																																																																																																																																								// through
																																																																																																																																																																																																																																																																																								// photo
																																																																																																																																																																																																																																																																																								// array
																																																																																																																																																																																																																																																																																								// $('.next',
																																																																																																																																																																																																																																																																																								// $el).click(function()
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (!$('.next',
																																																																																																																																																																																																																																																																																								// $el).hasClass('inactive'))
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (i
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 0) {
																																																																																																																																																																																																																																																																																								// $('.prev',
																																																																																																																																																																																																																																																																																								// $el).removeClass('inactive');
																																																																																																																																																																																																																																																																																								// } i
																																																																																																																																																																																																																																																																																								// +=
																																																																																																																																																																																																																																																																																								// 1;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (i
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// photos.length
																																																																																																																																																																																																																																																																																								// - 1)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.next',
																																																																																																																																																																																																																																																																																								// $el).addClass('inactive');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// loadPhoto(i);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// $('.prev',
																																																																																																																																																																																																																																																																																								// $el).click(function()
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (!$('.prev',
																																																																																																																																																																																																																																																																																								// $el).hasClass('inactive'))
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (i
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// photos.length
																																																																																																																																																																																																																																																																																								// - 1)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.next',
																																																																																																																																																																																																																																																																																								// $el).removeClass('inactive');
																																																																																																																																																																																																																																																																																								// } i
																																																																																																																																																																																																																																																																																								// -=
																																																																																																																																																																																																																																																																																								// 1;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (i
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 0) {
																																																																																																																																																																																																																																																																																								// $('.prev',
																																																																																																																																																																																																																																																																																								// $el).addClass('inactive');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// loadPhoto(i);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Toggle
																																																																																																																																																																																																																																																																																								// resizing
																																																																																																																																																																																																																																																																																								// of
																																																																																																																																																																																																																																																																																								// photo
																																																																																																																																																																																																																																																																																								// to
																																																																																																																																																																																																																																																																																								// fit
																																																																																																																																																																																																																																																																																								// container
																																																																																																																																																																																																																																																																																								// $('.resize',
																																																																																																																																																																																																																																																																																								// $el).click(function()
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// ($('body').hasClass('fullscreen'))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('body').removeClass('fullscreen');
																																																																																																																																																																																																																																																																																								// $(this).find('.text').text('Details');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('body').addClass('fullscreen');
																																																																																																																																																																																																																																																																																								// $(this).find('.text').text('Hide
																																																																																																																																																																																																																																																																																								// Details');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// views.HDI
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.View.extend({
																																																																																																																																																																																																																																																																																								// initialize:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.render();
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// render:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// view
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this,
																																																																																																																																																																																																																																																																																								// unit
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// view.options.unit,
																																																																																																																																																																																																																																																																																								// hdiWorld
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// HDI['A-000'];
																																																																																																																																																																																																																																																																																								// app.hdi
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// true;
																																																																																																																																																																																																																																																																																								// view.hdiChart(HDI[unit],hdiWorld);
																																																																																																																																																																																																																																																																																								// view.hdiDetails(HDI[unit]);
																																																																																																																																																																																																																																																																																								// $('#hdi').html(_.last(HDI[unit].hdi)[1]);
																																																																																																																																																																																																																																																																																								// $('.map-btn[data-value="hdi"]
																																																																																																																																																																																																																																																																																								// .total-caption').html('HDI');
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Builds
																																																																																																																																																																																																																																																																																								// HDI
																																																																																																																																																																																																																																																																																								// bar
																																																																																																																																																																																																																																																																																								// chart
																																																																																																																																																																																																																																																																																								// hdiChart:
																																																																																																																																																																																																																																																																																								// function(country,world)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#chart-hdi
																																																																																																																																																																																																																																																																																								// h3').html('Human
																																																																																																																																																																																																																																																																																								// Development
																																																																																																																																																																																																																																																																																								// Index');
																																																																																																																																																																																																																																																																																								// $('.data',
																																																																																																																																																																																																																																																																																								// '#chart-hdi').empty().append(
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="total"
																																																																																																																																																																																																																																																																																								// style="width:'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// _.last(country.hdi)[1]*100
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '%">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// _.last(country.hdi)[1]
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="subdata
																																																																																																																																																																																																																																																																																								// total"
																																																																																																																																																																																																																																																																																								// style="width:'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// _.last(world.hdi)[1]*100
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '%;"></div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="health"
																																																																																																																																																																																																																																																																																								// style="width:'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// _.last(country.health)[1]*100
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '%">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// _.last(country.health)[1]
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="subdata
																																																																																																																																																																																																																																																																																								// health"
																																																																																																																																																																																																																																																																																								// style="width:'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// _.last(world.health)[1]*100
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '%;"></div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="education"
																																																																																																																																																																																																																																																																																								// style="width:'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// _.last(country.education)[1]*100
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '%">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// _.last(country.education)[1]
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="subdata
																																																																																																																																																																																																																																																																																								// education"
																																																																																																																																																																																																																																																																																								// style="width:'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// _.last(world.education)[1]*100
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '%;"></div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="income"
																																																																																																																																																																																																																																																																																								// style="width:'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// _.last(country.income)[1]*100
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '%">'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// _.last(country.income)[1]
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<div
																																																																																																																																																																																																																																																																																								// class="subdata
																																																																																																																																																																																																																																																																																								// income"
																																																																																																																																																																																																																																																																																								// style="width:'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// _.last(world.income)[1]*100
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '%;"></div>'
																																																																																																																																																																																																																																																																																								// );
																																																																																																																																																																																																																																																																																								// $('#chart-hdi
																																																																																																																																																																																																																																																																																								// .ranking').html(country.rank
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<span
																																																																																																																																																																																																																																																																																								// class="outof">/'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// HDI.total
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</span>');
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Builds
																																																																																																																																																																																																																																																																																								// HDI
																																																																																																																																																																																																																																																																																								// historical
																																																																																																																																																																																																																																																																																								// graph,
																																																																																																																																																																																																																																																																																								// uses
																																																																																																																																																																																																																																																																																								// flot.js
																																																																																																																																																																																																																																																																																								// hdiDetails:
																																																																																																																																																																																																																																																																																								// function(data)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// beginYr
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _.first(data.hdi)[0],
																																																																																																																																																																																																																																																																																								// endYr
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _.last(data.hdi)[0],
																																																																																																																																																																																																																																																																																								// ctry
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// data.hdi,
																																																																																																																																																																																																																																																																																								// health
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// data.health,
																																																																																																																																																																																																																																																																																								// ed =
																																																																																																																																																																																																																																																																																								// data.education,
																																																																																																																																																																																																																																																																																								// inc
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// data.income;
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// sparklineOptions
																																																																																																																																																																																																																																																																																								// = {
																																																																																																																																																																																																																																																																																								// xaxis:
																																																																																																																																																																																																																																																																																								// {show:
																																																																																																																																																																																																																																																																																								// false,
																																																																																																																																																																																																																																																																																								// min:
																																																																																																																																																																																																																																																																																								// beginYr,
																																																																																																																																																																																																																																																																																								// max:
																																																																																																																																																																																																																																																																																								// endYr},
																																																																																																																																																																																																																																																																																								// yaxis:
																																																																																																																																																																																																																																																																																								// {show:
																																																																																																																																																																																																																																																																																								// false,
																																																																																																																																																																																																																																																																																								// min:
																																																																																																																																																																																																																																																																																								// 0,
																																																																																																																																																																																																																																																																																								// max:
																																																																																																																																																																																																																																																																																								// 1},
																																																																																																																																																																																																																																																																																								// grid:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// show:
																																																																																																																																																																																																																																																																																								// true,
																																																																																																																																																																																																																																																																																								// borderWidth:
																																																																																																																																																																																																																																																																																								// 0,
																																																																																																																																																																																																																																																																																								// color:
																																																																																																																																																																																																																																																																																								// '#CEDEDD',
																																																																																																																																																																																																																																																																																								// minBorderMargin:
																																																																																																																																																																																																																																																																																								// 0,
																																																																																																																																																																																																																																																																																								// markings:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (axes)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// markings
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// [];
																																																																																																																																																																																																																																																																																								// for
																																																																																																																																																																																																																																																																																								// (var
																																																																																																																																																																																																																																																																																								// x =
																																																																																																																																																																																																																																																																																								// 5; x
																																																																																																																																																																																																																																																																																								// <
																																																																																																																																																																																																																																																																																								// axes.xaxis.max;
																																																																																																																																																																																																																																																																																								// x +=
																																																																																																																																																																																																																																																																																								// 5)
																																																																																																																																																																																																																																																																																								// markings.push({
																																																																																																																																																																																																																																																																																								// xaxis:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// from:
																																																																																																																																																																																																																																																																																								// x,
																																																																																																																																																																																																																																																																																								// to:
																																																																																																																																																																																																																																																																																								// x },
																																																																																																																																																																																																																																																																																								// lineWidth:
																																																																																																																																																																																																																																																																																								// 1,
																																																																																																																																																																																																																																																																																								// color:
																																																																																																																																																																																																																																																																																								// '#CEDEDD'
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// for
																																																																																																																																																																																																																																																																																								// (var
																																																																																																																																																																																																																																																																																								// y =
																																																																																																																																																																																																																																																																																								// 0.2;
																																																																																																																																																																																																																																																																																								// y <
																																																																																																																																																																																																																																																																																								// axes.yaxis.max;
																																																																																																																																																																																																																																																																																								// y +=
																																																																																																																																																																																																																																																																																								// 0.2)
																																																																																																																																																																																																																																																																																								// markings.push({
																																																																																																																																																																																																																																																																																								// yaxis:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// from:
																																																																																																																																																																																																																																																																																								// y,
																																																																																																																																																																																																																																																																																								// to:
																																																																																																																																																																																																																																																																																								// y },
																																																																																																																																																																																																																																																																																								// lineWidth:
																																																																																																																																																																																																																																																																																								// 1,
																																																																																																																																																																																																																																																																																								// color:
																																																																																																																																																																																																																																																																																								// '#CEDEDD'
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// markings;
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// series:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// lines:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// lineWidth:
																																																																																																																																																																																																																																																																																								// 1 },
																																																																																																																																																																																																																																																																																								// shadowSize:
																																																																																																																																																																																																																																																																																								// 0 },
																																																																																																																																																																																																																																																																																								// colors:
																																																																																																																																																																																																																																																																																								// ['#96CCE6',
																																																																																																																																																																																																																																																																																								// '#70B678',
																																																																																																																																																																																																																																																																																								// '#DC9B75',
																																																																																																																																																																																																																																																																																								// '#036']
																																																																																																																																																																																																																																																																																								// };
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// points
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// {points:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// show:true,
																																																																																																																																																																																																																																																																																								// radius:
																																																																																																																																																																																																																																																																																								// 1
																																																																																																																																																																																																																																																																																								// }};
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (beginYr
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// endYr)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// _.extend(sparklineOptions.series,
																																																																																																																																																																																																																																																																																								// points);
																																																																																																																																																																																																																																																																																								// endYr
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '';
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// $('#xlabel
																																																																																																																																																																																																																																																																																								// .beginyear').html(beginYr);
																																																																																																																																																																																																																																																																																								// $('#xlabel
																																																																																																																																																																																																																																																																																								// .endyear').html(endYr);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (data.change
																																																																																																																																																																																																																																																																																								// > 0)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#chart-hdi
																																																																																																																																																																																																																																																																																								// .change').html('<div
																																																																																																																																																																																																																																																																																								// class="trend
																																																																																																																																																																																																																																																																																								// hdi-up"></div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// Math.round(data.change*1000)/1000);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (data.change
																																																																																																																																																																																																																																																																																								// < 0)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#chart-hdi
																																																																																																																																																																																																																																																																																								// .change').html('<div
																																																																																																																																																																																																																																																																																								// class="trend
																																																																																																																																																																																																																																																																																								// hdi-down"></div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// Math.round(data.change*1000)/1000);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#chart-hdi
																																																																																																																																																																																																																																																																																								// .change').html('<div
																																																																																																																																																																																																																																																																																								// class="trend
																																																																																																																																																																																																																																																																																								// hdi-nochange">--</div>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// Math.round(data.change*1000)/1000);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// $.plot($("#sparkline"),
																																																																																																																																																																																																																																																																																								// [health,ed,inc,{data:
																																																																																																																																																																																																																																																																																								// ctry,
																																																																																																																																																																																																																																																																																								// lines:
																																																																																																																																																																																																																																																																																								// {lineWidth:
																																																																																																																																																																																																																																																																																								// 1.5}}],
																																																																																																																																																																																																																																																																																								// sparklineOptions);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// views.TopDonors
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.View.extend({
																																																																																																																																																																																																																																																																																								// initialize:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// () {
																																																																																																																																																																																																																																																																																								// this.$el.html(templates.topDonors(this));
																																																																																																																																																																																																																																																																																								// this.render();
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// render:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// () {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// that
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this,
																																																																																																																																																																																																																																																																																								// cat
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// that.collection.type,
																																																																																																																																																																																																																																																																																								// chartModels
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// that.collection.models,
																																																																																																																																																																																																																																																																																								// max
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// chartModels[0].get(cat);
																																																																																																																																																																																																																																																																																								// _(chartModels).each(function(model)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (model.get(cat)
																																																																																																																																																																																																																																																																																								// !=
																																																																																																																																																																																																																																																																																								// '')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('tbody',
																																																																																																																																																																																																																																																																																								// that.el).append(templates.topDonor({
																																																																																																																																																																																																																																																																																								// name:
																																																																																																																																																																																																																																																																																								// model.get('name'),
																																																																																																																																																																																																																																																																																								// id:
																																																																																																																																																																																																																																																																																								// model.get('donor_id'),
																																																																																																																																																																																																																																																																																								// country:
																																																																																																																																																																																																																																																																																								// model.get('country'),
																																																																																																																																																																																																																																																																																								// number:
																																																																																																																																																																																																																																																																																								// model.get(cat),
																																																																																																																																																																																																																																																																																								// barWidth:
																																																																																																																																																																																																																																																																																								// model.get(cat)/max*100
																																																																																																																																																																																																																																																																																								// }));
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// update:
																																																																																																																																																																																																																																																																																								// function(cat)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// that
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// that.collection.comparator
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// function(model)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// -1 *
																																																																																																																																																																																																																																																																																								// model.get(cat);
																																																																																																																																																																																																																																																																																								// };
																																																																																																																																																																																																																																																																																								// that.collection.sort();
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// max
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// that.collection.models[0].get(cat);
																																																																																																																																																																																																																																																																																								// $('tbody',
																																																																																																																																																																																																																																																																																								// that.el).empty();
																																																																																																																																																																																																																																																																																								// _(that.collection.models).each(function(model)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (model.get(cat)
																																																																																																																																																																																																																																																																																								// !=
																																																																																																																																																																																																																																																																																								// '')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('tbody',
																																																																																																																																																																																																																																																																																								// that.el).append(templates.topDonor({
																																																																																																																																																																																																																																																																																								// name:
																																																																																																																																																																																																																																																																																								// model.get('name'),
																																																																																																																																																																																																																																																																																								// id:
																																																																																																																																																																																																																																																																																								// model.get('donor_id'),
																																																																																																																																																																																																																																																																																								// country:
																																																																																																																																																																																																																																																																																								// model.get('country'),
																																																																																																																																																																																																																																																																																								// number:
																																																																																																																																																																																																																																																																																								// model.get(cat),
																																																																																																																																																																																																																																																																																								// barWidth:
																																																																																																																																																																																																																																																																																								// model.get(cat)/max*100
																																																																																																																																																																																																																																																																																								// }));
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// views.Widget
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.View.extend({
																																																																																																																																																																																																																																																																																								// el:
																																																																																																																																																																																																																																																																																								// '#widget',
																																																																																																																																																																																																																																																																																								// events:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// .widget-options
																																																																																																																																																																																																																																																																																								// a':
																																																																																																																																																																																																																																																																																								// 'widgetOptions',
																																																																																																																																																																																																																																																																																								// 'click
																																																																																																																																																																																																																																																																																								// .widget-code':
																																																																																																																																																																																																																																																																																								// 'inputSelect'
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// initialize:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// () {
																																																																																																																																																																																																																																																																																								// this.destroy();
																																																																																																																																																																																																																																																																																								// this.render();
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// render:
																																																																																																																																																																																																																																																																																								// function(keypress)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// view
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// $(this.el).empty().append(templates.widget());
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (view.options.context
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'projects')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.proj-opt',
																																																																																																																																																																																																																																																																																								// view.$el).hide();
																																																																																																																																																																																																																																																																																								// $('.main-opt',
																																																																																																																																																																																																																																																																																								// view.$el).show();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.main-opt',
																																																																																																																																																																																																																																																																																								// view.$el).hide();
																																																																																																																																																																																																																																																																																								// $('.proj-opt',
																																																																																																																																																																																																																																																																																								// view.$el).show();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// destroy:
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.undelegateEvents();
																																																																																																																																																																																																																																																																																								// $(this.el).removeData().unbind();
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// widgetOptions:
																																																																																																																																																																																																																																																																																								// function(e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// view
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// view.path
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '#widget/';
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (location.hash.split('/').length
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 1) {
																																																																																																																																																																																																																																																																																								// view.path
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// location.hash
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '/widget/';
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// view.path
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// location.hash
																																																																																																																																																																																																																																																																																								// .replace('filter',
																																																																																																																																																																																																																																																																																								// 'widget')
																																																																																																																																																																																																																																																																																								// .replace('project',
																																																																																																																																																																																																																																																																																								// 'widget/project');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// $el
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $(e.target);
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// opt
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $el.attr('data-value');
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// ($el.hasClass('active'))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $el.removeClass('active');
																																																																																																																																																																																																																																																																																								// widgetOpts.splice(widgetOpts.indexOf(opt),
																																																																																																																																																																																																																																																																																								// 1);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $el.addClass('active');
																																																																																																																																																																																																																																																																																								// widgetOpts.push(opt);
																																																																																																																																																																																																																																																																																								// } if
																																																																																																																																																																																																																																																																																								// (widgetOpts.length
																																																																																																																																																																																																																																																																																								// !==
																																																																																																																																																																																																																																																																																								// 0) {
																																																																																																																																																																																																																																																																																								// view.widgetCode
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// '<iframe
																																																																																																																																																																																																																																																																																								// src="/undp-projects'+
																																																																																																																																																																																																																																																																																								// '/embed.html'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// view.path
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '?'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// widgetOpts.join('&')
																																																																																																																																																																																																																																																																																								// + '"
																																																																																																																																																																																																																																																																																								// width="640"
																																																																																																																																																																																																																																																																																								// height="500"
																																																																																																																																																																																																																																																																																								// frameborder="0">
																																																																																																																																																																																																																																																																																								// </iframe>';
																																																																																																																																																																																																																																																																																								// $('.widget-preview',
																																																																																																																																																																																																																																																																																								// view.$el).html(view.widgetCode);
																																																																																																																																																																																																																																																																																								// $('.widget-code',
																																																																																																																																																																																																																																																																																								// view.$el)
																																																																																																																																																																																																																																																																																								// .val(view.widgetCode)
																																																																																																																																																																																																																																																																																								// .select();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('.widget-preview',
																																																																																																																																																																																																																																																																																								// view.$el).html('<h3
																																																																																																																																																																																																																																																																																								// class="empty">To
																																																																																																																																																																																																																																																																																								// use
																																																																																																																																																																																																																																																																																								// this
																																																																																																																																																																																																																																																																																								// widget
																																																																																																																																																																																																																																																																																								// choose
																																																																																																																																																																																																																																																																																								// some
																																																																																																																																																																																																																																																																																								// options
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// left.</h3>');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// inputSelect:
																																																																																																																																																																																																																																																																																								// function(e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $(e.target).select();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Router
																																																																																																																																																																																																																																																																																								// routers.App
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Backbone.Router.extend({
																																																																																																																																																																																																																																																																																								// routes:
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// '':
																																																																																																																																																																																																																																																																																								// 'redirect',
																																																																																																																																																																																																																																																																																								// 'filter/*filters':
																																																																																																																																																																																																																																																																																								// 'redirect',
																																																																																																																																																																																																																																																																																								// ':fiscalyear':
																																																																																																																																																																																																																																																																																								// 'fiscalyear',
																																																																																																																																																																																																																																																																																								// ':fiscalyear/filter/*filters':
																																																																																																																																																																																																																																																																																								// 'fiscalyear',
																																																																																																																																																																																																																																																																																								// 'project/:id':
																																																																																																																																																																																																																																																																																								// 'project',
																																																																																																																																																																																																																																																																																								// 'project/:id/output-:output':
																																																																																																																																																																																																																																																																																								// 'project',
																																																																																																																																																																																																																																																																																								// 'widget/*options':
																																																																																																																																																																																																																																																																																								// 'widgetRedirect',
																																																																																																																																																																																																																																																																																								// ':fiscalyear/widget/*options':
																																																																																																																																																																																																																																																																																								// 'widget',
																																																																																																																																																																																																																																																																																								// 'about/*subnav':
																																																																																																																																																																																																																																																																																								// 'about',
																																																																																																																																																																																																																																																																																								// 'top-donors/*cat':
																																																																																																																																																																																																																																																																																								// 'topDonors'
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// redirect:
																																																																																																																																																																																																																																																																																								// function(route)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// //if
																																																																																																																																																																																																																																																																																								// url
																																																																																																																																																																																																																																																																																								// lacks
																																																																																																																																																																																																																																																																																								// a
																																																																																																																																																																																																																																																																																								// year,
																																																																																																																																																																																																																																																																																								// default
																																																																																																																																																																																																																																																																																								// to
																																																																																																																																																																																																																																																																																								// most
																																																																																																																																																																																																																																																																																								// recent
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (route)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.navigate(CURRENT_YR
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '/filter/'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// route,
																																																																																																																																																																																																																																																																																								// {trigger:
																																																																																																																																																																																																																																																																																								// true});
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.navigate(CURRENT_YR,
																																																																																																																																																																																																																																																																																								// {trigger:
																																																																																																																																																																																																																																																																																								// true});
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// widgetRedirect:
																																																																																																																																																																																																																																																																																								// function(route)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.navigate(CURRENT_YR
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '/widget/'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// route,
																																																																																																																																																																																																																																																																																								// {trigger:
																																																																																																																																																																																																																																																																																								// true});
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// mainApp:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// () {
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Handle
																																																																																																																																																																																																																																																																																								// feedback
																																																																																																																																																																																																																																																																																								// form
																																																																																																																																																																																																																																																																																								// submission
																																																																																																																																																																																																																																																																																								// $('#feedback-form').submit(function
																																																																																																																																																																																																																																																																																								// (e)
																																																																																																																																																																																																																																																																																								// { //
																																																																																																																																																																																																																																																																																								// Require
																																																																																																																																																																																																																																																																																								// 'Feedback'
																																																																																																																																																																																																																																																																																								// field
																																																																																																																																																																																																																																																																																								// to
																																																																																																																																																																																																																																																																																								// have
																																																																																																																																																																																																																																																																																								// content
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// ($('#entry_2').val()
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// '')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// alert('Please
																																																																																																																																																																																																																																																																																								// fill
																																																																																																																																																																																																																																																																																								// in
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// required
																																																																																																																																																																																																																																																																																								// fields
																																																																																																																																																																																																																																																																																								// before
																																																																																																																																																																																																																																																																																								// submitting.');
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// } //
																																																																																																																																																																																																																																																																																								// Set
																																																																																																																																																																																																																																																																																								// URL
																																																																																																																																																																																																																																																																																								// for
																																																																																																																																																																																																																																																																																								// feedback
																																																																																																																																																																																																																																																																																								// form
																																																																																																																																																																																																																																																																																								// $('#entry_3').val(window.location);
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// button
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $('input[type=submit]',
																																																																																																																																																																																																																																																																																								// this),
																																																																																																																																																																																																																																																																																								// data
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $(this).serialize(),
																																																																																																																																																																																																																																																																																								// form
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// $.ajax({
																																																																																																																																																																																																																																																																																								// type:
																																																																																																																																																																																																																																																																																								// 'POST',
																																																																																																																																																																																																																																																																																								// url:
																																																																																																																																																																																																																																																																																								// 'https://docs.google.com/spreadsheet/formResponse?formkey=dFRTYXNUMWIzbXRhVF94YW9rVmlZNVE6MQ&amp;ifq',
																																																																																																																																																																																																																																																																																								// data:
																																																																																																																																																																																																																																																																																								// data,
																																																																																																																																																																																																																																																																																								// complete:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// () {
																																																																																																																																																																																																																																																																																								// $('#feedback').modal('hide');
																																																																																																																																																																																																																																																																																								// $('input[type=text],
																																																																																																																																																																																																																																																																																								// textarea',
																																																																																																																																																																																																																																																																																								// form).val('');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// fiscalyear:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (year,
																																																																																																																																																																																																																																																																																								// route,
																																																																																																																																																																																																																																																																																								// embed)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// that
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!$('#y'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// year).length)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// //passing
																																																																																																																																																																																																																																																																																								// in
																																																																																																																																																																																																																																																																																								// year
																																																																																																																																																																																																																																																																																								// index
																																																																																																																																																																																																																																																																																								// js
																																																																																																																																																																																																																																																																																								// (json)
																																																																																																																																																																																																																																																																																								// loadjsFile('api/project_summary_'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// year
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '.js',
																																																																																																																																																																																																																																																																																								// year,
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// that.browser(year,
																																																																																																																																																																																																																																																																																								// route,
																																																																																																																																																																																																																																																																																								// embed);
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// that.browser(year,
																																																																																																																																																																																																																																																																																								// route,
																																																																																																																																																																																																																																																																																								// embed);
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// browser:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (year,
																																																																																																																																																																																																																																																																																								// route,
																																																																																																																																																																																																																																																																																								// embed)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// that
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this,
																																																																																																																																																																																																																																																																																								// unit
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!embed)
																																																																																																																																																																																																																																																																																								// { //
																																																																																																																																																																																																																																																																																								// Load
																																																																																																																																																																																																																																																																																								// in
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// top
																																																																																																																																																																																																																																																																																								// donors
																																																																																																																																																																																																																																																																																								// info
																																																																																																																																																																																																																																																																																								// and
																																																																																																																																																																																																																																																																																								// feedbackform
																																																																																																																																																																																																																																																																																								// dets.
																																																																																																																																																																																																																																																																																								// this.mainApp();
																																																																																																																																																																																																																																																																																								// window.setTimeout(function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('html,
																																																																																																																																																																																																																																																																																								// body').scrollTop(0);
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Set
																																																																																																																																																																																																																																																																																								// up
																																																																																																																																																																																																																																																																																								// menu
																																																																																																																																																																																																																																																																																								// $('#app
																																																																																																																																																																																																																																																																																								// .view,
																																																																																																																																																																																																																																																																																								// #mainnav
																																																																																																																																																																																																																																																																																								// .profile').hide();
																																																																																																																																																																																																																																																																																								// $('#mainnav
																																																																																																																																																																																																																																																																																								// li').removeClass('active');
																																																																																																																																																																																																																																																																																								// $('#profile
																																																																																																																																																																																																																																																																																								// .summary').addClass('off');
																																																																																																																																																																																																																																																																																								// $('#browser,
																																																																																																																																																																																																																																																																																								// #mainnav
																																																																																																																																																																																																																																																																																								// .browser').show();
																																																																																																																																																																																																																																																																																								// $('#mainnav
																																																																																																																																																																																																																																																																																								// li
																																																																																																																																																																																																																																																																																								// a[href="/undp-projects/"]').parent().addClass('active');
																																																																																																																																																																																																																																																																																								// $('#mainnav
																																																																																																																																																																																																																																																																																								// li.parent').removeClass('parent-active');
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Set
																																																																																																																																																																																																																																																																																								// up
																																																																																																																																																																																																																																																																																								// breadcrumbs
																																																																																																																																																																																																																																																																																								// $('#breadcrumbs
																																																																																																																																																																																																																																																																																								// ul').html('<li><a
																																																																																																																																																																																																																																																																																								// href="http://www.undp.org/content/undp/en/home.html">Home</a></li><li><a
																																																																																																																																																																																																																																																																																								// href="/undp-projects/">Our
																																																																																																																																																																																																																																																																																								// Projects</a></li>');
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Load
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// main
																																																																																																																																																																																																																																																																																								// app
																																																																																																																																																																																																																																																																																								// view
																																																																																																																																																																																																																																																																																								// this.app
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.app
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// views.App({
																																																																																																																																																																																																																																																																																								// el:
																																																																																																																																																																																																																																																																																								// '#browser',
																																																																																																																																																																																																																																																																																								// year:
																																																																																																																																																																																																																																																																																								// year
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// this.app
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this.app
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// views.App({
																																																																																																																																																																																																																																																																																								// el:
																																																																																																																																																																																																																																																																																								// '#embed',
																																																																																																																																																																																																																																																																																								// embed:
																																																																																																																																																																																																																																																																																								// embed,
																																																																																																																																																																																																																																																																																								// year:
																																																																																																																																																																																																																																																																																								// year
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// } //
																																																																																																																																																																																																																																																																																								// Save
																																																																																																																																																																																																																																																																																								// default
																																																																																																																																																																																																																																																																																								// description
																																																																																																																																																																																																																																																																																								// app.defaultDescription
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// app.defaultDescription
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// $('#description
																																																																																																																																																																																																																																																																																								// p.intro').html();
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Parse
																																																																																																																																																																																																																																																																																								// hash
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// parts
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (route)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// route.split('/')
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// [];
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// filters
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(parts).map(function
																																																																																																																																																																																																																																																																																								// (part)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// filter
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// part.split('-');
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (filter[0]
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'operating_unit')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// unit
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// filter[1];
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// collection:
																																																																																																																																																																																																																																																																																								// filter[0],
																																																																																																																																																																																																																																																																																								// id:
																																																																																																																																																																																																																																																																																								// filter[1]
																																																																																																																																																																																																																																																																																								// };
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (_.isEqual(this.app.filters,
																																																																																																																																																																																																																																																																																								// filters)
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// app.fiscalYear
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// year)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('html,
																																																																																																																																																																																																																																																																																								// body').scrollTop(0);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// { //
																																																																																																																																																																																																																																																																																								// slicing
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// selected
																																																																																																																																																																																																																																																																																								// facets
																																																																																																																																																																																																																																																																																								// and
																																																																																																																																																																																																																																																																																								// getting
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// json
																																																																																																																																																																																																																																																																																								// items
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// filter
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (model)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (!filters.length)
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// true;
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// _(filters).reduce(function
																																																																																																																																																																																																																																																																																								// (memo,
																																																																																																																																																																																																																																																																																								// filter)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (filter.collection
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'region')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// memo
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// model.get(filter.collection)
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// filter.id;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// memo
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// (model.get(filter.collection)
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// model.get(filter.collection).indexOf(filter.id)
																																																																																																																																																																																																																																																																																								// >=
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// true);
																																																																																																																																																																																																																																																																																								// };
																																																																																																																																																																																																																																																																																								// this.app.filters
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// filters;
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// loadFilters
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// counter
																																																																																																																																																																																																																																																																																								// = 0;
																																																																																																																																																																																																																																																																																								// that.app.views
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// {};
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Load
																																																																																																																																																																																																																																																																																								// filters
																																																																																																																																																																																																																																																																																								// _(facets).each(function
																																																																																																																																																																																																																																																																																								// (facet)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// collection
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// models.Filters();
																																																																																																																																																																																																																																																																																								// $('#filter-items').append('<div
																																																																																																																																																																																																																																																																																								// id="'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// facet.id
																																																																																																																																																																																																																																																																																								// + '"
																																																																																																																																																																																																																																																																																								// class="topics"></div>');
																																																																																																																																																																																																																																																																																								// _(facet).each(function
																																																																																																																																																																																																																																																																																								// (v,
																																																																																																																																																																																																																																																																																								// k) {
																																																																																																																																																																																																																																																																																								// collection[k]
																																																																																																																																																																																																																																																																																								// = v;
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// collection.fetch({
																																																																																																																																																																																																																																																																																								// success:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// () {
																																																																																																																																																																																																																																																																																								// that.app.views[facet.id]
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// views.Filters({
																																																																																																																																																																																																																																																																																								// el:
																																																																																																																																																																																																																																																																																								// '#'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// facet.id,
																																																																																																																																																																																																																																																																																								// collection:
																																																																																																																																																																																																																																																																																								// collection
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// _.each(filters,
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (obj)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (obj.collection
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// facet.id)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// that.app.views[facet.id].active
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// true;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// collection.watch();
																																																																																																																																																																																																																																																																																								// counter++;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (counter
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// facets.length)
																																																																																																																																																																																																																																																																																								// updateDescription();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Create
																																																																																																																																																																																																																																																																																								// summary
																																																																																																																																																																																																																																																																																								// map
																																																																																																																																																																																																																																																																																								// view
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!embed){
																																																																																																																																																																																																																																																																																								// that.projects.map
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// views.Map({
																																																																																																																																																																																																																																																																																								// el:
																																																																																																																																																																																																																																																																																								// '#homemap',
																																																																																																																																																																																																																																																																																								// collection:
																																																																																																																																																																																																																																																																																								// that.projects
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// that.projects.widget
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// views.Widget({
																																																																																																																																																																																																																																																																																								// context:
																																																																																																																																																																																																																																																																																								// 'projects'
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// that.projects.map
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// views.Map({
																																																																																																																																																																																																																																																																																								// el:
																																																																																																																																																																																																																																																																																								// '#homemap',
																																																																																																																																																																																																																																																																																								// collection:
																																																																																																																																																																																																																																																																																								// that.projects,
																																																																																																																																																																																																																																																																																								// embed:
																																																																																																																																																																																																																																																																																								// embed
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// } };
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Load
																																																																																																																																																																																																																																																																																								// projects
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!this.allProjects
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// app.fiscalYear
																																																																																																																																																																																																																																																																																								// !=
																																																																																																																																																																																																																																																																																								// year)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (app.fiscalYear
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// app.fiscalYear
																																																																																																																																																																																																																																																																																								// !=
																																																																																																																																																																																																																																																																																								// year){app.projects.map.map.remove();}
																																																																																																																																																																																																																																																																																								// app.fiscalYear
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// year;
																																																																																																																																																																																																																																																																																								// this.allProjects
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// models.Projects(SUMMARY);
																																																																																																																																																																																																																																																																																								// that.projects
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// models.Projects(that.allProjects.filter(filter));
																																																																																																																																																																																																																																																																																								// that.projects.view
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// views.Projects({
																																																																																																																																																																																																																																																																																								// collection:
																																																																																																																																																																																																																																																																																								// that.projects
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// that.projects.cb
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// _(loadFilters).bind(that);
																																																																																																																																																																																																																																																																																								// that.projects.watch();
																																																																																																																																																																																																																																																																																								// that.app.updateYear(year);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// { //
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// projects
																																																																																																																																																																																																																																																																																								// are
																																																																																																																																																																																																																																																																																								// already
																																																																																																																																																																																																																																																																																								// present
																																																																																																																																																																																																																																																																																								// this.projects.cb
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// updateDescription;
																																																																																																																																																																																																																																																																																								// this.projects.reset(this.allProjects.filter(filter));
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// updateWhenOpUnit();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// updateWhenOpUnit(){
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// opUnitFilter
																																																																																																																																																																																																																																																																																								// =_(app.app.filters).findWhere({collection:"operating_unit"});
																																																																																																																																																																																																																																																																																								// $('.map-filter').removeClass('active')
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// reset
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// subfilter
																																																																																																																																																																																																																																																																																								// look
																																																																																																																																																																																																																																																																																								// $('#map-filters').find('#type-10').addClass('active');
																																																																																																																																																																																																																																																																																								// if(_.isObject(opUnitFilter)){
																																																																																																																																																																																																																																																																																								// $('#map-filters').removeClass('disabled');//shows
																																																																																																																																																																																																																																																																																								// type
																																																																																																																																																																																																																																																																																								// sub-filter
																																																																																																																																																																																																																																																																																								// $('.map-btn').removeClass('active');
																																																																																																																																																																																																																																																																																								// $('ul.layers
																																																																																																																																																																																																																																																																																								// li').addClass('no-hover');
																																																																																																																																																																																																																																																																																								// $('ul.layers
																																																																																																																																																																																																																																																																																								// li.hdi
																																																																																																																																																																																																																																																																																								// .graph').addClass('active');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#map-filters').addClass('disabled');
																																																																																																																																																																																																																																																																																								// //hides
																																																																																																																																																																																																																																																																																								// type
																																																																																																																																																																																																																																																																																								// sub-filter
																																																																																																																																																																																																																																																																																								// $('ul.layers
																																																																																																																																																																																																																																																																																								// li').removeClass('no-hover');
																																																																																																																																																																																																																																																																																								// $('ul.layers
																																																																																																																																																																																																																																																																																								// li.hdi
																																																																																																																																																																																																																																																																																								// .graph').removeClass('active');
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// updateDescription()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// setTimeout(function()
																																																																																																																																																																																																																																																																																								// { //
																																																																																																																																																																																																																																																																																								// Clear
																																																																																																																																																																																																																																																																																								// search
																																																																																																																																																																																																																																																																																								// values
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// refresh
																																																																																																																																																																																																																																																																																								// $('#filters-search,
																																																																																																																																																																																																																																																																																								// #projects-search').val('');
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (_(filters).find(function(f)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// f.collection
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'focus_area';
																																																																																																																																																																																																																																																																																								// }))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#chart-focus_area').hide();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#chart-focus_area').show();
																																																																																																																																																																																																																																																																																								// } //
																																																																																																																																																																																																																																																																																								// three
																																																																																																																																																																																																																																																																																								// kinds
																																																																																																																																																																																																																																																																																								// of
																																																																																																																																																																																																																																																																																								// descriptions
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// 1.
																																																																																																																																																																																																																																																																																								// no
																																																																																																																																																																																																																																																																																								// filter
																																																																																																																																																																																																																																																																																								// -->
																																																																																																																																																																																																																																																																																								// defaultDescription
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// 2.
																																																																																																																																																																																																																																																																																								// filter
																																																																																																																																																																																																																																																																																								// (no
																																																																																																																																																																																																																																																																																								// donor)
																																																																																																																																																																																																																																																																																								// -->
																																																																																																																																																																																																																																																																																								// start
																																																																																																																																																																																																																																																																																								// with
																																																																																																																																																																																																																																																																																								// "The
																																																																																																																																																																																																																																																																																								// above
																																																																																																																																																																																																																																																																																								// includes"
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// 3.
																																																																																																																																																																																																																																																																																								// filter
																																																																																																																																																																																																																																																																																								// (with
																																																																																																																																																																																																																																																																																								// donor)
																																																																																																																																																																																																																																																																																								// -->
																																																																																																																																																																																																																																																																																								// start
																																																																																																																																																																																																																																																																																								// with
																																																																																																																																																																																																																																																																																								// "DONOR
																																																																																																																																																																																																																																																																																								// funds
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// above"
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// counts
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (app.projects.length
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 1) ?
																																																																																																																																																																																																																																																																																								// 'project'
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// 'projects';
																																																																																																																																																																																																																																																																																								// projectCounts
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 'There
																																																																																																																																																																																																																																																																																								// are
																																																																																																																																																																																																																																																																																								// <strong>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// app.projects.length
																																																																																																																																																																																																																																																																																								// +'</strong>
																																																																																																																																																																																																																																																																																								// ' +
																																																																																																																																																																																																																																																																																								// counts;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (app.description
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// app.description.length
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 0){
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (app.donorDescription.length
																																																																																																																																																																																																																																																																																								// > 0)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#description
																																																																																																																																																																																																																																																																																								// p.desc').html(app.donorDescription
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// counts
																																																																																																																																																																																																																																																																																								// +'
																																																																																																																																																																																																																																																																																								// accoss
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// world.');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#description
																																																																																																																																																																																																																																																																																								// p.desc').html(app.defaultDescription);
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (app.description
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// app.description.length
																																																																																																																																																																																																																																																																																								// >
																																																																																																																																																																																																																																																																																								// 0){
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (app.donorDescription.length
																																																																																																																																																																																																																																																																																								// > 0)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#description
																																																																																																																																																																																																																																																																																								// p.desc').html(app.donorDescription
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// counts
																																																																																																																																																																																																																																																																																								// + '
																																																																																																																																																																																																																																																																																								// ' +
																																																																																																																																																																																																																																																																																								// app.description.join(',')
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '.');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#description
																																																																																																																																																																																																																																																																																								// p.desc').html(projectCounts
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// app.description.join(',')
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '.');
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!app.description)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#description
																																																																																																																																																																																																																																																																																								// p.desc').html(app.defaultDescription);
																																																																																																																																																																																																																																																																																								// } //
																																																																																																																																																																																																																																																																																								// reset
																																																																																																																																																																																																																																																																																								// description
																																																																																																																																																																																																																																																																																								// app.description
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// app.donorDescription
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// "";
																																																																																																																																																																																																																																																																																								// $('#browser
																																																																																																																																																																																																																																																																																								// .summary').removeClass('off');
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// defaultDescription
																																																																																																																																																																																																																																																																																								// is
																																																																																																																																																																																																																																																																																								// already
																																																																																																																																																																																																																																																																																								// populated
																																																																																																																																																																																																																																																																																								// $('#description
																																																																																																																																																																																																																																																																																								// p.intro').empty();
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// empty
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// sub
																																																																																																																																																																																																																																																																																								// loc
																																																																																																																																																																																																																																																																																								// content
																																																																																																																																																																																																																																																																																								// since
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// on a
																																																																																																																																																																																																																																																																																								// DOM
																																																																																																																																																																																																																																																																																								// level
																																																																																																																																																																																																																																																																																								// since
																																																																																																																																																																																																																																																																																								// it
																																																																																																																																																																																																																																																																																								// is
																																																																																																																																																																																																																																																																																								// generated
																																																																																																																																																																																																																																																																																								// with
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// page/map
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// instead
																																																																																																																																																																																																																																																																																								// of
																																																																																																																																																																																																																																																																																								// beforehdand
																																																																																																																																																																																																																																																																																								// $('#description
																																																																																																																																																																																																																																																																																								// p.geography').empty();
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// } //
																																																																																																																																																																																																																																																																																								// Show
																																																																																																																																																																																																																																																																																								// proper
																																																																																																																																																																																																																																																																																								// HDI
																																																																																																																																																																																																																																																																																								// data
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (unit
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// ((HDI[unit])
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// HDI[unit].hdi
																																																																																																																																																																																																																																																																																								// !=
																																																																																																																																																																																																																																																																																								// '' :
																																																																																																																																																																																																																																																																																								// HDI[unit]))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// app.hdi
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// views.HDI({
																																																																																																																																																																																																																																																																																								// unit:
																																																																																																																																																																																																																																																																																								// unit
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// ($('.map-btn[data-value="hdi"]').hasClass('active'))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#chart-hdi').css('display','block');
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// app.hdi
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// false;
																																																																																																																																																																																																																																																																																								// $('#chart-hdi').css('display','none');
																																																																																																																																																																																																																																																																																								// $('ul.layers
																																																																																																																																																																																																																																																																																								// li.no-hover.hdi
																																																																																																																																																																																																																																																																																								// a').css('cursor','default');
																																																																																																																																																																																																																																																																																								// $('ul.layers
																																																																																																																																																																																																																																																																																								// li.hdi
																																																																																																																																																																																																																																																																																								// .graph').removeClass('active');
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (unit)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#hdi').html('no
																																																																																																																																																																																																																																																																																								// data');
																																																																																																																																																																																																																																																																																								// $('.map-btn[data-value="hdi"]
																																																																																																																																																																																																																																																																																								// .total-caption').html('HDI');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#hdi').html(_.last(HDI['A-000'].hdi)[1]);
																																																																																																																																																																																																																																																																																								// $('.map-btn[data-value="hdi"]
																																																																																																																																																																																																																																																																																								// .total-caption').html('HDI
																																																																																																																																																																																																																																																																																								// Global');
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// project:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (id,
																																																																																																																																																																																																																																																																																								// output,
																																																																																																																																																																																																																																																																																								// embed)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// that
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!embed)
																																																																																																																																																																																																																																																																																								// { //
																																																																																																																																																																																																																																																																																								// Load
																																																																																																																																																																																																																																																																																								// in
																																																																																																																																																																																																																																																																																								// feedbackform
																																																																																																																																																																																																																																																																																								// dets.
																																																																																																																																																																																																																																																																																								// this.mainApp();
																																																																																																																																																																																																																																																																																								// window.setTimeout(function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('html,
																																																																																																																																																																																																																																																																																								// body').scrollTop(0);
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Set
																																																																																																																																																																																																																																																																																								// up
																																																																																																																																																																																																																																																																																								// menu
																																																																																																																																																																																																																																																																																								// $('#app
																																																																																																																																																																																																																																																																																								// .view,
																																																																																																																																																																																																																																																																																								// #mainnav
																																																																																																																																																																																																																																																																																								// .browser').hide();
																																																																																																																																																																																																																																																																																								// $('#mainnav
																																																																																																																																																																																																																																																																																								// li').removeClass('active');
																																																																																																																																																																																																																																																																																								// $('#mainnav
																																																																																																																																																																																																																																																																																								// .profile').show();
																																																																																																																																																																																																																																																																																								// $('#mainnav
																																																																																																																																																																																																																																																																																								// li
																																																																																																																																																																																																																																																																																								// a[href="/"]').parent().addClass('active');
																																																																																																																																																																																																																																																																																								// $('#mainnav
																																																																																																																																																																																																																																																																																								// li.parent').removeClass('parent-active');
																																																																																																																																																																																																																																																																																								// } //
																																																																																																																																																																																																																																																																																								// Set
																																																																																																																																																																																																																																																																																								// up
																																																																																																																																																																																																																																																																																								// this
																																																																																																																																																																																																																																																																																								// route
																																																																																																																																																																																																																																																																																								// this.project.model
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// models.Project({
																																																																																																																																																																																																																																																																																								// id:
																																																																																																																																																																																																																																																																																								// id
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// this.project.model.fetch({
																																																																																																																																																																																																																																																																																								// success:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// () {
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (that.project.view)
																																																																																																																																																																																																																																																																																								// that.project.view.undelegateEvents();
																																																																																																																																																																																																																																																																																								// that.project.view
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// views.ProjectProfile({
																																																																																																																																																																																																																																																																																								// el:
																																																																																																																																																																																																																																																																																								// (embed)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// '#embed'
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// '#profile',
																																																																																																																																																																																																																																																																																								// model:
																																																																																																																																																																																																																																																																																								// that.project.model,
																																																																																																																																																																																																																																																																																								// embed:
																																																																																																																																																																																																																																																																																								// embed
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// false,
																																																																																																																																																																																																																																																																																								// gotoOutput:
																																																																																																																																																																																																																																																																																								// (output)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// output
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// false
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!embed)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// that.project.widget
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// views.Widget({
																																																																																																																																																																																																																																																																																								// context:
																																																																																																																																																																																																																																																																																								// 'project'
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// widget:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (year,
																																																																																																																																																																																																																																																																																								// route)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// that
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this,
																																																																																																																																																																																																																																																																																								// parts
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// route.split('?'),
																																																																																																																																																																																																																																																																																								// options
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// parts[1],
																																																																																																																																																																																																																																																																																								// path
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// parts[0];
																																																																																																																																																																																																																																																																																								// path
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (path)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// path.split('/')
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// [];
																																																																																																																																																																																																																																																																																								// options
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// (options)
																																																																																																																																																																																																																																																																																								// ?
																																																																																																																																																																																																																																																																																								// options.split('&')
																																																																																																																																																																																																																																																																																								// :
																																																																																																																																																																																																																																																																																								// [];
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (path[0]
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 'project')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// that.project(parts[0].split('/')[1],
																																																																																																																																																																																																																																																																																								// false,
																																																																																																																																																																																																																																																																																								// options);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// route
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// parts[0];
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (route
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// '')
																																																																																																																																																																																																																																																																																								// route
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// undefined;
																																																																																																																																																																																																																																																																																								// that.fiscalyear(year,
																																																																																																																																																																																																																																																																																								// route,
																																																																																																																																																																																																																																																																																								// options);
																																																																																																																																																																																																																																																																																								// } },
																																																																																																																																																																																																																																																																																								// about:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (route)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// window.setTimeout(function
																																																																																																																																																																																																																																																																																								// () {
																																																																																																																																																																																																																																																																																								// $('html,
																																																																																																																																																																																																																																																																																								// body').scrollTop(0);
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// $('#breadcrumbs
																																																																																																																																																																																																																																																																																								// ul').html('<li><a
																																																																																																																																																																																																																																																																																								// href="http://www.undp.org/content/undp/en/home.html">Home</a></li>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<li><a
																																																																																																																																																																																																																																																																																								// href="/undp-projects">Our
																																																																																																																																																																																																																																																																																								// Projects</a></li>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<li><a
																																																																																																																																																																																																																																																																																								// href="#about/'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// route
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '">About:
																																																																																																																																																																																																																																																																																								// ' +
																																																																																																																																																																																																																																																																																								// route.capitalize().replace('info','')
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '</a></li>');
																																																																																																																																																																																																																																																																																								// $('#app
																																																																																																																																																																																																																																																																																								// .view,
																																																																																																																																																																																																																																																																																								// #about
																																																																																																																																																																																																																																																																																								// .section,
																																																																																																																																																																																																																																																																																								// #mainnav
																																																																																																																																																																																																																																																																																								// .profile').hide();
																																																																																																																																																																																																																																																																																								// $('#aboutnav
																																																																																																																																																																																																																																																																																								// li,
																																																																																																																																																																																																																																																																																								// #mainnav
																																																																																																																																																																																																																																																																																								// li').removeClass('active');
																																																																																																																																																																																																																																																																																								// $('#about,
																																																																																																																																																																																																																																																																																								// #mainnav
																																																																																																																																																																																																																																																																																								// .browser').show();
																																																																																																																																																																																																																																																																																								// $('#aboutnav
																																																																																																																																																																																																																																																																																								// li
																																																																																																																																																																																																																																																																																								// a[href="#about/'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// route
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '"]').parent().addClass('active');
																																																																																																																																																																																																																																																																																								// $('#about
																																																																																																																																																																																																																																																																																								// #' +
																																																																																																																																																																																																																																																																																								// route).show();
																																																																																																																																																																																																																																																																																								// $('#mainnav
																																																																																																																																																																																																																																																																																								// li.parent').addClass('parent-active');
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// topDonors:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (route)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// that
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// this;
																																																																																																																																																																																																																																																																																								// $('#breadcrumbs
																																																																																																																																																																																																																																																																																								// ul').html('<li><a
																																																																																																																																																																																																																																																																																								// href="http://www.undp.org/content/undp/en/home.html">Home</a></li>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<li><a
																																																																																																																																																																																																																																																																																								// href="site.baseurl">Our
																																																																																																																																																																																																																																																																																								// Projects</a></li>'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '<li><a
																																																																																																																																																																																																																																																																																								// href="#top-donors/regular">Top
																																																																																																																																																																																																																																																																																								// Donors</a></li>');
																																																																																																																																																																																																																																																																																								// $('#app
																																																																																																																																																																																																																																																																																								// .view').hide();
																																																																																																																																																																																																																																																																																								// $('#mainnav
																																																																																																																																																																																																																																																																																								// li').removeClass('active');
																																																																																																																																																																																																																																																																																								// $('#mainnav
																																																																																																																																																																																																																																																																																								// li.parent').removeClass('parent-active');
																																																																																																																																																																																																																																																																																								// $('#top-donors').show();
																																																																																																																																																																																																																																																																																								// $('#mainnav
																																																																																																																																																																																																																																																																																								// li
																																																																																																																																																																																																																																																																																								// a[href="#top-donors/regular"]').parent().addClass('active');
																																																																																																																																																																																																																																																																																								// $('#donor-nav
																																																																																																																																																																																																																																																																																								// li
																																																																																																																																																																																																																																																																																								// a').removeClass('active');
																																																																																																																																																																																																																																																																																								// $('#donor-nav
																																																																																																																																																																																																																																																																																								// li
																																																																																																																																																																																																																																																																																								// a[href="#top-donors/'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// route
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// '"]').addClass('active');
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!that.donorsGross)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// that.donorsGross
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// models.TopDonors({type:
																																																																																																																																																																																																																																																																																								// route});
																																																																																																																																																																																																																																																																																								// that.donorsGross.url
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 'api/top-donor-gross-index.json';
																																																																																																																																																																																																																																																																																								// that.donorsLocal
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// models.TopDonors({type:
																																																																																																																																																																																																																																																																																								// 'amount'});
																																																																																																																																																																																																																																																																																								// that.donorsLocal.url
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// 'api/top-donor-local-index.json';
																																																																																																																																																																																																																																																																																								// that.donorsGross.fetch({
																																																																																																																																																																																																																																																																																								// success:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// () {
																																																																																																																																																																																																																																																																																								// that.topDonorsGross
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// views.TopDonors({
																																																																																																																																																																																																																																																																																								// el:
																																																																																																																																																																																																																																																																																								// '.donor-gross-table',
																																																																																																																																																																																																																																																																																								// collection:
																																																																																																																																																																																																																																																																																								// that.donorsGross
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// this.donorsLocal.fetch({
																																																																																																																																																																																																																																																																																								// success:
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// () {
																																																																																																																																																																																																																																																																																								// that.topDonorsLocal
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// views.TopDonors({
																																																																																																																																																																																																																																																																																								// el:
																																																																																																																																																																																																																																																																																								// '.donor-local-table',
																																																																																																																																																																																																																																																																																								// collection:
																																																																																																																																																																																																																																																																																								// that.donorsLocal
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// window.setTimeout(function
																																																																																																																																																																																																																																																																																								// () {
																																																																																																																																																																																																																																																																																								// $('html,
																																																																																																																																																																																																																																																																																								// body').scrollTop(0);
																																																																																																																																																																																																																																																																																								// },
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// that.topDonorsGross.update(route);
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// String
																																																																																																																																																																																																																																																																																								// helper
																																																																																																																																																																																																																																																																																								// String.prototype.capitalize
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// this.charAt(0).toUpperCase()
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// this.slice(1);
																																																																																																																																																																																																																																																																																								// };
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Script
																																																																																																																																																																																																																																																																																								// loader
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// loadjsFile(filename,
																																																																																																																																																																																																																																																																																								// year,
																																																																																																																																																																																																																																																																																								// callback)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $('#fiscalData').empty();
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// fileref
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// document.createElement('script');
																																																																																																																																																																																																																																																																																								// fileref.setAttribute('type',
																																																																																																																																																																																																																																																																																								// 'text/javascript');
																																																																																																																																																																																																																																																																																								// fileref.setAttribute('id',
																																																																																																																																																																																																																																																																																								// 'y'
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// year);
																																																																																																																																																																																																																																																																																								// fileref.setAttribute('src',
																																																																																																																																																																																																																																																																																								// filename);
																																																																																																																																																																																																																																																																																								// //calling
																																																																																																																																																																																																																																																																																								// a
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// after
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// js
																																																																																																																																																																																																																																																																																								// is
																																																																																																																																																																																																																																																																																								// loaded
																																																																																																																																																																																																																																																																																								// (IE)
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// loadFunction
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// function()
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (this.readyState
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'complete'
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// this.readyState
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// 'loaded')
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// callback();
																																																																																																																																																																																																																																																																																								// } };
																																																																																																																																																																																																																																																																																								// fileref.onreadystatechange
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// loadFunction;
																																																																																																																																																																																																																																																																																								// //calling
																																																																																																																																																																																																																																																																																								// a
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// after
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// js
																																																																																																																																																																																																																																																																																								// is
																																																																																																																																																																																																																																																																																								// loaded
																																																																																																																																																																																																																																																																																								// (Chrome/Firefox)
																																																																																																																																																																																																																																																																																								// fileref.onload
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// callback;
																																																																																																																																																																																																																																																																																								// document.getElementById('fiscalData').appendChild(fileref);
																																																																																																																																																																																																																																																																																								// } //
																																																																																																																																																																																																																																																																																								// Via
																																																																																																																																																																																																																																																																																								// https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (!Array.prototype.indexOf)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// Array.prototype.indexOf
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (searchElement
																																																																																																																																																																																																																																																																																								// /*,
																																																																																																																																																																																																																																																																																								// fromIndex
																																																																																																																																																																																																																																																																																								// */ )
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// 'use
																																																																																																																																																																																																																																																																																								// strict';
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (this
																																																																																																																																																																																																																																																																																								// ==
																																																																																																																																																																																																																																																																																								// null)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// throw
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// TypeError();
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// t =
																																																																																																																																																																																																																																																																																								// Object(this);
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// len
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// t.length
																																																																																																																																																																																																																																																																																								// >>>
																																																																																																																																																																																																																																																																																								// 0;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (len
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// 0) {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// -1;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// n =
																																																																																																																																																																																																																																																																																								// 0;
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (arguments.length
																																																																																																																																																																																																																																																																																								// > 1)
																																																																																																																																																																																																																																																																																								// { n
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// Number(arguments[1]);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (n
																																																																																																																																																																																																																																																																																								// !=
																																																																																																																																																																																																																																																																																								// n) {
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// shortcut
																																																																																																																																																																																																																																																																																								// for
																																																																																																																																																																																																																																																																																								// verifying
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// it's
																																																																																																																																																																																																																																																																																								// NaN
																																																																																																																																																																																																																																																																																								// n =
																																																																																																																																																																																																																																																																																								// 0; }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (n
																																																																																																																																																																																																																																																																																								// != 0
																																																																																																																																																																																																																																																																																								// && n
																																																																																																																																																																																																																																																																																								// !=
																																																																																																																																																																																																																																																																																								// Infinity
																																																																																																																																																																																																																																																																																								// && n
																																																																																																																																																																																																																																																																																								// !=
																																																																																																																																																																																																																																																																																								// -Infinity)
																																																																																																																																																																																																																																																																																								// { n
																																																																																																																																																																																																																																																																																								// = (n
																																																																																																																																																																																																																																																																																								// > 0
																																																																																																																																																																																																																																																																																								// ||
																																																																																																																																																																																																																																																																																								// -1)
																																																																																																																																																																																																																																																																																								// *
																																																																																																																																																																																																																																																																																								// Math.floor(Math.abs(n));
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// (n
																																																																																																																																																																																																																																																																																								// >=
																																																																																																																																																																																																																																																																																								// len)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// -1;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// k =
																																																																																																																																																																																																																																																																																								// n >=
																																																																																																																																																																																																																																																																																								// 0 ?
																																																																																																																																																																																																																																																																																								// n :
																																																																																																																																																																																																																																																																																								// Math.max(len
																																																																																																																																																																																																																																																																																								// -
																																																																																																																																																																																																																																																																																								// Math.abs(n),
																																																																																																																																																																																																																																																																																								// 0);
																																																																																																																																																																																																																																																																																								// for
																																																																																																																																																																																																																																																																																								// (; k
																																																																																																																																																																																																																																																																																								// <
																																																																																																																																																																																																																																																																																								// len;
																																																																																																																																																																																																																																																																																								// k++)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (k
																																																																																																																																																																																																																																																																																								// in t
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// t[k]
																																																																																																																																																																																																																																																																																								// ===
																																																																																																																																																																																																																																																																																								// searchElement)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// k; }
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// -1;
																																																																																																																																																																																																																																																																																								// } }
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// To
																																																																																																																																																																																																																																																																																								// Title
																																																																																																																																																																																																																																																																																								// Case
																																																																																																																																																																																																																																																																																								// 2.0.1
																																																																																																																																																																																																																																																																																								// –
																																																																																																																																																																																																																																																																																								// http://individed.com/code/to-title-case/
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Copyright
																																																																																																																																																																																																																																																																																								// ©
																																																																																																																																																																																																																																																																																								// 2008–2012
																																																																																																																																																																																																																																																																																								// David
																																																																																																																																																																																																																																																																																								// Gouch.
																																																																																																																																																																																																																																																																																								// Licensed
																																																																																																																																																																																																																																																																																								// under
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// MIT
																																																																																																																																																																																																																																																																																								// License.
																																																																																																																																																																																																																																																																																								// String.prototype.toTitleCase
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// () {
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// smallWords
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// /^(a|an|and|as|at|but|by|en|for|if|in|of|on|or|the|to|vs?\.?|via)$/i;
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// this.replace(/([^\W_]+[^\s\-]*)
																																																																																																																																																																																																																																																																																								// */g,
																																																																																																																																																																																																																																																																																								// function
																																																																																																																																																																																																																																																																																								// (match,
																																																																																																																																																																																																																																																																																								// p1,
																																																																																																																																																																																																																																																																																								// index,
																																																																																																																																																																																																																																																																																								// title)
																																																																																																																																																																																																																																																																																								// { if
																																																																																																																																																																																																																																																																																								// (index
																																																																																																																																																																																																																																																																																								// > 0
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// index
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// p1.length
																																																																																																																																																																																																																																																																																								// !==
																																																																																																																																																																																																																																																																																								// title.length
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// p1.search(smallWords)
																																																																																																																																																																																																																																																																																								// > -1
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// title.charAt(index
																																																																																																																																																																																																																																																																																								// - 2)
																																																																																																																																																																																																																																																																																								// !==
																																																																																																																																																																																																																																																																																								// ":"
																																																																																																																																																																																																																																																																																								// &&
																																																																																																																																																																																																																																																																																								// title.charAt(index
																																																																																																																																																																																																																																																																																								// -
																																																																																																																																																																																																																																																																																								// 1).search(/[^\s\-]/)
																																																																																																																																																																																																																																																																																								// < 0)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// match.toLowerCase();
																																																																																																																																																																																																																																																																																								// } if
																																																																																																																																																																																																																																																																																								// (p1.substr(1).search(/[A-Z]|\../)
																																																																																																																																																																																																																																																																																								// >
																																																																																																																																																																																																																																																																																								// -1)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// match;
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// return
																																																																																																																																																																																																																																																																																								// match.charAt(0).toUpperCase()
																																																																																																																																																																																																																																																																																								// +
																																																																																																																																																																																																																																																																																								// match.substr(1);
																																																																																																																																																																																																																																																																																								// })
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Words
																																																																																																																																																																																																																																																																																								// that
																																																																																																																																																																																																																																																																																								// should
																																																																																																																																																																																																																																																																																								// be
																																																																																																																																																																																																																																																																																								// all
																																																																																																																																																																																																																																																																																								// caps
																																																																																																																																																																																																																																																																																								// .replace(/Un\b/g,
																																																																																																																																																																																																																																																																																								// 'UN
																																																																																																																																																																																																																																																																																								// ')
																																																																																																																																																																																																																																																																																								// .replace(/Undp/g,
																																																																																																																																																																																																																																																																																								// 'UNDP')
																																																																																																																																																																																																																																																																																								// .replace(/Unesco/g,
																																																																																																																																																																																																																																																																																								// 'UNESCO')
																																																																																																																																																																																																																																																																																								// .replace(/Unfip/g,
																																																																																																																																																																																																																																																																																								// 'UNFIP')
																																																																																																																																																																																																																																																																																								// .replace(/Unocha\/central_emg_resp_fund/g,
																																																																																																																																																																																																																																																																																								// 'UNOCHA
																																																																																																																																																																																																																																																																																								// Central
																																																																																																																																																																																																																																																																																								// Emg
																																																																																																																																																																																																																																																																																								// Resp
																																																																																																																																																																																																																																																																																								// Fund')
																																																																																																																																																																																																																																																																																								// .replace(/Unocha/g,
																																																																																																																																																																																																																																																																																								// 'UNOCHA')
																																																																																																																																																																																																																																																																																								// .replace(/Mdtfo\\jp_mdg-F_conflict_\&_pb/g,
																																																																																																																																																																																																																																																																																								// 'MDTFO
																																																																																																																																																																																																																																																																																								// / JP
																																																																																																																																																																																																																																																																																								// MDG-F
																																																																																																																																																																																																																																																																																								// Conflict
																																																																																																																																																																																																																																																																																								// &
																																																																																																																																																																																																																																																																																								// PB')
																																																																																																																																																																																																																																																																																								// .replace(/Bcpr/g,
																																																																																																																																																																																																																																																																																								// 'BCPR')
																																																																																																																																																																																																																																																																																								// .replace(/Dfid/g,
																																																																																																																																																																																																																																																																																								// 'DFID')
																																																																																																																																																																																																																																																																																								// .replace(/Usaid/g,
																																																																																																																																																																																																																																																																																								// 'USAID')
																																																																																																																																																																																																																																																																																								// .replace(/Unaids/g,
																																																																																																																																																																																																																																																																																								// 'UNAIDS')
																																																																																																																																																																																																																																																																																								// .replace(/Mdtfo\\jp_peace_building_fund/g,
																																																																																																																																																																																																																																																																																								// 'MDTFO
																																																																																																																																																																																																																																																																																								// / JP
																																																																																																																																																																																																																																																																																								// Peace
																																																																																																																																																																																																																																																																																								// Building
																																																																																																																																																																																																																																																																																								// Fund')
																																																																																																																																																																																																																																																																																								// .replace(/Aa
																																																																																																																																																																																																																																																																																								// for
																																																																																																																																																																																																																																																																																								// Jp/g,
																																																																																																																																																																																																																																																																																								// 'AA
																																																																																																																																																																																																																																																																																								// for
																																																																																																																																																																																																																																																																																								// JP')
																																																																																																																																																																																																																																																																																								// .replace(/Gtz\b/g,
																																																																																																																																																																																																																																																																																								// 'GTZ')
																																																																																																																																																																																																																																																																																								// .replace(/Mdg\b/g,
																																																																																																																																																																																																																																																																																								// 'MDG')
																																																																																																																																																																																																																																																																																								// .replace(/Hiv\b/g,
																																																																																																																																																																																																																																																																																								// 'HIV')
																																																																																																																																																																																																																																																																																								// .replace(/Bra\b/g,
																																																																																																																																																																																																																																																																																								// 'BRA')
																																																																																																																																																																																																																																																																																								// .replace(/Ii\b/g,
																																																																																																																																																																																																																																																																																								// 'II')
																																																																																																																																																																																																																																																																																								// .replace(/Iii\b/g,
																																																																																																																																																																																																																																																																																								// 'III')
																																																																																																																																																																																																																																																																																								// .replace(/Iv\b/g,
																																																																																																																																																																																																																																																																																								// 'IV')
																																																																																																																																																																																																																																																																																								// .replace(/Vi\b/g,
																																																																																																																																																																																																																																																																																								// 'VI')
																																																																																																																																																																																																																																																																																								// .replace(/Vii\b/g,
																																																																																																																																																																																																																																																																																								// 'VII');
																																																																																																																																																																																																																																																																																								// };
																																																																																																																																																																																																																																																																																								// //localize
																																																																																																																																																																																																																																																																																								// map
																																																																																																																																																																																																																																																																																								// tilejson
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// TJ =
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// bounds:
																																																																																																																																																																																																																																																																																								// [
																																																																																																																																																																																																																																																																																								// -180,
																																																																																																																																																																																																																																																																																								// -85,
																																																																																																																																																																																																																																																																																								// 180,
																																																																																																																																																																																																																																																																																								// 85
																																																																																																																																																																																																																																																																																								// ],
																																																																																																																																																																																																																																																																																								// center:
																																																																																																																																																																																																																																																																																								// [ 0,
																																																																																																																																																																																																																																																																																								// 0, 2
																																																																																																																																																																																																																																																																																								// ],
																																																																																																																																																																																																																																																																																								// id:
																																																																																																																																																																																																																																																																																								// "undp.map-6grwd0n3",
																																																																																																																																																																																																																																																																																								// maxzoom:
																																																																																																																																																																																																																																																																																								// 7,
																																																																																																																																																																																																																																																																																								// //set
																																																																																																																																																																																																																																																																																								// to 7
																																																																																																																																																																																																																																																																																								// to
																																																																																																																																																																																																																																																																																								// avoid
																																																																																																																																																																																																																																																																																								// zooming
																																																																																																																																																																																																																																																																																								// too
																																																																																																																																																																																																																																																																																								// much
																																																																																																																																																																																																																																																																																								// in
																																																																																																																																																																																																																																																																																								// order
																																																																																																																																																																																																																																																																																								// to
																																																																																																																																																																																																																																																																																								// get
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// granular
																																																																																																																																																																																																																																																																																								// markers
																																																																																																																																																																																																																																																																																								// on
																																																																																																																																																																																																																																																																																								// cluster
																																																																																																																																																																																																																																																																																								// markers
																																																																																																																																																																																																																																																																																								// minzoom:
																																																																																																																																																																																																																																																																																								// 2,
																																																																																																																																																																																																																																																																																								// name:
																																																																																																																																																																																																																																																																																								// "UNDP
																																																																																																																																																																																																																																																																																								// base
																																																																																																																																																																																																																																																																																								// layer",
																																																																																																																																																																																																																																																																																								// private:
																																																																																																																																																																																																																																																																																								// true,
																																																																																																																																																																																																																																																																																								// scheme:
																																																																																																																																																																																																																																																																																								// "xyz",
																																																																																																																																																																																																																																																																																								// tilejson:
																																																																																																																																																																																																																																																																																								// "2.0.0",
																																																																																																																																																																																																																																																																																								// tiles:
																																																																																																																																																																																																																																																																																								// [
																																																																																																																																																																																																																																																																																								// "http://a.tiles.mapbox.com/v3/undp.map-6grwd0n3/{z}/{x}/{y}.png",
																																																																																																																																																																																																																																																																																								// "http://b.tiles.mapbox.com/v3/undp.map-6grwd0n3/{z}/{x}/{y}.png",
																																																																																																																																																																																																																																																																																								// "http://c.tiles.mapbox.com/v3/undp.map-6grwd0n3/{z}/{x}/{y}.png",
																																																																																																																																																																																																																																																																																								// "http://d.tiles.mapbox.com/v3/undp.map-6grwd0n3/{z}/{x}/{y}.png"
																																																																																																																																																																																																																																																																																								// ],
																																																																																																																																																																																																																																																																																								// webpage:
																																																																																																																																																																																																																																																																																								// "http://tiles.mapbox.com/undp/map/map-6grwd0n3"
																																																																																																																																																																																																																																																																																								// };
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// About
																																																																																																																																																																																																																																																																																								// nav
																																																																																																																																																																																																																																																																																								// toggle
																																																																																																																																																																																																																																																																																								// $('#mainnav
																																																																																																																																																																																																																																																																																								// a.parent-link').click(function(e)
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// e.preventDefault();
																																																																																																																																																																																																																																																																																								// var
																																																																																																																																																																																																																																																																																								// $target
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// $(e.target);
																																																																																																																																																																																																																																																																																								// if
																																																																																																																																																																																																																																																																																								// ($target.parent().hasClass('parent-active'))
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $target.parent().removeClass('parent-active');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// else
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// $target.parent().addClass('parent-active');
																																																																																																																																																																																																																																																																																								// }
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// //
																																																																																																																																																																																																																																																																																								// Start
																																																																																																																																																																																																																																																																																								// the
																																																																																																																																																																																																																																																																																								// application
																																																																																																																																																																																																																																																																																								// $(function()
																																																																																																																																																																																																																																																																																								// {
																																																																																																																																																																																																																																																																																								// app
																																																																																																																																																																																																																																																																																								// =
																																																																																																																																																																																																																																																																																								// new
																																																																																																																																																																																																																																																																																								// routers.App();
																																																																																																																																																																																																																																																																																								// Backbone.history.start();
																																																																																																																																																																																																																																																																																								// });
																																																																																																																																																																																																																																																																																								// });
